<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>DedekindReals.Multiplication</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Background">Andrew Sneap

</a><a id="15" class="Markup">\begin{code}</a>
<a id="28" class="Symbol">{-#</a> <a id="32" class="Keyword">OPTIONS</a> <a id="40" class="Pragma">--safe</a> <a id="47" class="Pragma">--without-K</a> <a id="59" class="Symbol">#-}</a>


<a id="65" class="Keyword">open</a> <a id="70" class="Keyword">import</a> <a id="77" href="UF.PropTrunc.html" class="Module">UF.PropTrunc</a>
<a id="90" class="Keyword">open</a> <a id="95" class="Keyword">import</a> <a id="102" href="UF.Subsingletons.html" class="Module">UF.Subsingletons</a>
<a id="119" class="Keyword">open</a> <a id="124" class="Keyword">import</a> <a id="131" href="UF.FunExt.html" class="Module">UF.FunExt</a>


<a id="143" class="Keyword">module</a> <a id="150" href="DedekindReals.Multiplication.html" class="Module">DedekindReals.Multiplication</a>
         <a id="188" class="Symbol">(</a><a id="189" href="DedekindReals.Multiplication.html#189" class="Bound">fe</a> <a id="192" class="Symbol">:</a> <a id="194" href="UF.FunExt.html#1047" class="Function">Fun-Ext</a><a id="201" class="Symbol">)</a>
         <a id="212" class="Symbol">(</a><a id="213" href="DedekindReals.Multiplication.html#213" class="Bound">pe</a> <a id="216" class="Symbol">:</a> <a id="218" href="UF.Subsingletons.html#7814" class="Function">Prop-Ext</a><a id="226" class="Symbol">)</a>
         <a id="237" class="Symbol">(</a><a id="238" href="DedekindReals.Multiplication.html#238" class="Bound">pt</a> <a id="241" class="Symbol">:</a> <a id="243" href="UF.PropTrunc.html#486" class="Record">propositional-truncations-exist</a><a id="274" class="Symbol">)</a>
       <a id="283" class="Keyword">where</a>

<a id="290" class="Keyword">open</a> <a id="295" href="UF.PropTrunc.html#792" class="Module">PropositionalTruncation</a> <a id="319" href="DedekindReals.Multiplication.html#238" class="Bound">pt</a>


<a id="324" class="Markup">\end{code}</a><a id="334" class="Background">

Multiplication is defined as in the HoTT Book. It reminds of interval multiplication of rational numbers.

Inhabitedness: by inhabitedness of x and y, we find values
on both sides of each. Then using the property that rationals have no
least element, then using the relevant min/max calculation we
trivially find a p which inhabits each cut of the product.

Roundedness: roundedness in the left to right direction follows
directly from density of rationals, and transitivity of rationals
order. In the right to left, transivity alone completes the proof.

</a><a id="892" class="Markup">\begin{code}</a>
<a id="905" class="Comment">{-
_*_ : ‚Ñù ‚Üí ‚Ñù ‚Üí ‚Ñù
_*_ ((Lx , Rx) , inhabited-left-x , inhabited-right-x , rounded-left-x , rounded-right-x , disjoint-x , located-x)
    ((Ly , Ry) , inhabited-left-y , inhabited-right-y , rounded-left-y , rounded-right-y , disjoint-y , located-y)
  = (L , R) , inhabited-L , {!!} , rounded-left-L , {!!} , is-disjoint , {!!}
 where
  L : ùìü ‚Ñö
  L p = (‚àÉ (a , b , c , d) Íûâ ‚Ñö √ó ‚Ñö √ó ‚Ñö √ó ‚Ñö , a ‚àà Lx √ó b ‚àà Rx √ó c ‚àà Ly √ó d ‚àà Ry √ó p &lt; min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d)) , ‚àÉ-is-prop
  R : ùìü ‚Ñö
  R q = (‚àÉ (a , b , c , d) Íûâ ‚Ñö √ó ‚Ñö √ó ‚Ñö √ó ‚Ñö , a ‚àà Lx √ó b ‚àà Rx √ó c ‚àà Ly √ó d ‚àà Ry √ó max‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d) &lt; q) , ‚àÉ-is-prop

  x-values : ‚à• (Œ£ a Íûâ ‚Ñö , a ‚àà Lx) √ó (Œ£ b Íûâ ‚Ñö , b ‚àà Rx) ‚à•
  x-values = binary-choice inhabited-left-x inhabited-right-x

  y-values : ‚à• (Œ£ c Íûâ ‚Ñö , c ‚àà Ly) √ó (Œ£ d Íûâ ‚Ñö , d ‚àà Ry) ‚à•
  y-values = binary-choice inhabited-left-y inhabited-right-y

  xy-values : ‚à• ((Œ£ a Íûâ ‚Ñö , a ‚àà Lx) √ó (Œ£ b Íûâ ‚Ñö , b ‚àà Rx)) √ó ((Œ£ c Íûâ ‚Ñö , c ‚àà Ly) √ó (Œ£ d Íûâ ‚Ñö , d ‚àà Ry)) ‚à•
  xy-values = binary-choice x-values y-values

  inhabited-L : inhabited-left L
  inhabited-L = ‚à•‚à•-rec ‚àÉ-is-prop I xy-values
   where
    I : ((Œ£ a Íûâ ‚Ñö , a ‚àà Lx) √ó (Œ£ b Íûâ ‚Ñö , b ‚àà Rx)) √ó ((Œ£ c Íûâ ‚Ñö , c ‚àà Ly) √ó (Œ£ d Íûâ ‚Ñö , d ‚àà Ry))
      ‚Üí ‚àÉ p Íûâ ‚Ñö , ‚àÉ (a , b , c , d) Íûâ ‚Ñö √ó ‚Ñö √ó ‚Ñö √ó ‚Ñö , a ‚àà Lx √ó b ‚àà Rx √ó c ‚àà Ly √ó d ‚àà Ry √ó p &lt; min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d)
    I (((a , a&lt;x) , (b , x&lt;b)) , ((c , c&lt;y) , (d , y&lt;d))) = II (‚Ñö-no-least-element (min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d)))
     where
      II : Œ£ p Íûâ ‚Ñö , p &lt; min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d)
         ‚Üí _
      II (p , p&lt;MIN) = ‚à£ p , ‚à£ (a , b , c , d) , a&lt;x , x&lt;b , c&lt;y , y&lt;d , p&lt;MIN ‚à£ ‚à£

  rounded-left-L : rounded-left L
  rounded-left-L p = ltr , rtl
   where
    ltr : p ‚àà L ‚Üí ‚àÉ p&#39; Íûâ ‚Ñö , (p &lt; p&#39;) √ó p&#39; ‚àà L
    ltr p&lt;xy = ‚à•‚à•-functor I p&lt;xy
     where
      I : (Œ£ (a , b , c , d) Íûâ ‚Ñö √ó ‚Ñö √ó ‚Ñö √ó ‚Ñö , a ‚àà Lx √ó b ‚àà Rx √ó c ‚àà Ly √ó d ‚àà Ry √ó p &lt; min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d))
        ‚Üí Œ£ p&#39; Íûâ ‚Ñö , p &lt; p&#39; √ó p&#39; ‚àà L
      I ((a , b , c , d) , a&lt;x , x&lt;b , c&lt;y , y&lt;d , p&lt;MIN) = II (‚Ñö-dense fe p (min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d)) p&lt;MIN)
       where
        II : (Œ£ p&#39; Íûâ ‚Ñö , p &lt; p&#39; √ó p&#39; &lt; min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d))
           ‚Üí Œ£ p&#39; Íûâ ‚Ñö , p &lt; p&#39; √ó p&#39; ‚àà L
        II (p&#39; , p&lt;p&#39; , p&#39;&lt;MIN) = p&#39; , (p&lt;p&#39; , ‚à£ (a , b , c , d) , (a&lt;x , x&lt;b , c&lt;y , y&lt;d , p&#39;&lt;MIN) ‚à£)
    rtl : ‚àÉ p&#39; Íûâ ‚Ñö , (p &lt; p&#39;) √ó p&#39; ‚àà L ‚Üí p ‚àà L
    rtl p&#39;-info = ‚à•‚à•-rec ‚àÉ-is-prop I p&#39;-info
     where
      I : Œ£ p&#39; Íûâ ‚Ñö , (p &lt; p&#39;) √ó p&#39; ‚àà L ‚Üí p ‚àà L
      I (p&#39; , p&lt;p&#39; , p&#39;&lt;xy) = ‚à•‚à•-functor II p&#39;&lt;xy
       where
        II : Œ£ (a , b , c , d) Íûâ ‚Ñö √ó ‚Ñö √ó ‚Ñö √ó ‚Ñö , a ‚àà Lx √ó b ‚àà Rx √ó c ‚àà Ly √ó d ‚àà Ry √ó p&#39; &lt; min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d)
           ‚Üí Œ£ (a , b , c , d) Íûâ ‚Ñö √ó ‚Ñö √ó ‚Ñö √ó ‚Ñö , a ‚àà Lx √ó b ‚àà Rx √ó c ‚àà Ly √ó d ‚àà Ry √ó p  &lt; min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d)
        II ((a , b , c , d) , a&lt;x , x&lt;b , c&lt;x , x&lt;d , p&#39;&lt;MIN) = (a , b , c , d) , a&lt;x , x&lt;b , c&lt;x , x&lt;d , ‚Ñö&lt;-trans p p&#39; (min‚ÇÑ (a ‚Ñö* c) (a ‚Ñö* d) (b ‚Ñö* c) (b ‚Ñö* d)) p&lt;p&#39; p&#39;&lt;MIN

  is-disjoint : disjoint L R
  is-disjoint p q (p&lt;xy , xy&lt;q) = ‚à•‚à•-rec (‚Ñö&lt;-is-prop p q) I (binary-choice p&lt;xy xy&lt;q)
   where
    I : (Œ£ (a‚ÇÅ , b‚ÇÅ , c‚ÇÅ , d‚ÇÅ) Íûâ ‚Ñö √ó ‚Ñö √ó ‚Ñö √ó ‚Ñö , a‚ÇÅ ‚àà Lx √ó b‚ÇÅ ‚àà Rx √ó c‚ÇÅ ‚àà Ly √ó d‚ÇÅ ‚àà Ry √ó p &lt; min‚ÇÑ (a‚ÇÅ ‚Ñö* c‚ÇÅ) (a‚ÇÅ ‚Ñö* d‚ÇÅ) (b‚ÇÅ ‚Ñö* c‚ÇÅ) (b‚ÇÅ ‚Ñö* d‚ÇÅ))
      √ó (Œ£ (a‚ÇÇ , b‚ÇÇ , c‚ÇÇ , d‚ÇÇ) Íûâ ‚Ñö √ó ‚Ñö √ó ‚Ñö √ó ‚Ñö , a‚ÇÇ ‚àà Lx √ó b‚ÇÇ ‚àà Rx √ó c‚ÇÇ ‚àà Ly √ó d‚ÇÇ ‚àà Ry √ó max‚ÇÑ (a‚ÇÇ ‚Ñö* c‚ÇÇ) (a‚ÇÇ ‚Ñö* d‚ÇÇ) (b‚ÇÇ ‚Ñö* c‚ÇÇ) (b‚ÇÇ ‚Ñö* d‚ÇÇ) &lt; q)
      ‚Üí p &lt; q
    I ( ((a‚ÇÅ , b‚ÇÅ , c‚ÇÅ , d‚ÇÅ) , a‚ÇÅ&lt;x , x&lt;b‚ÇÅ , c‚ÇÅ&lt;x , x&lt;d‚ÇÅ , p&lt;MIN‚ÇÅ) ,
        ((a‚ÇÇ , b‚ÇÇ , c‚ÇÇ , d‚ÇÇ) , a‚ÇÇ&lt;x , x&lt;b‚ÇÇ , c‚ÇÇ&lt;x , x&lt;d‚ÇÇ , MAX‚ÇÅ&lt;q) )
     = ‚Ñö&lt;-‚â§-trans fe p MIN‚ÇÇ q p&lt;MIN‚ÇÇ (‚Ñö‚â§-trans fe MIN‚ÇÇ MAX‚ÇÇ q MIN‚ÇÇ‚â§MAX‚ÇÇ MAX‚ÇÇ‚â§q)
     where
      a‚ÇÉ b‚ÇÉ c‚ÇÉ d‚ÇÉ : ‚Ñö
      a‚ÇÉ = max a‚ÇÅ a‚ÇÇ
      b‚ÇÉ = min b‚ÇÅ b‚ÇÇ
      c‚ÇÉ = max c‚ÇÅ c‚ÇÇ
      d‚ÇÉ = min d‚ÇÅ d‚ÇÇ

      MIN‚ÇÅ MAX‚ÇÅ MIN‚ÇÇ MAX‚ÇÇ : ‚Ñö
      MIN‚ÇÅ = min‚ÇÑ (a‚ÇÅ ‚Ñö* c‚ÇÅ) (a‚ÇÅ ‚Ñö* d‚ÇÅ) (b‚ÇÅ ‚Ñö* c‚ÇÅ) (b‚ÇÅ ‚Ñö* d‚ÇÅ)
      MAX‚ÇÅ = max‚ÇÑ (a‚ÇÇ ‚Ñö* c‚ÇÇ) (a‚ÇÇ ‚Ñö* d‚ÇÇ) (b‚ÇÇ ‚Ñö* c‚ÇÇ) (b‚ÇÇ ‚Ñö* d‚ÇÇ)
      MIN‚ÇÇ = min‚ÇÑ (a‚ÇÉ ‚Ñö* c‚ÇÉ) (a‚ÇÉ ‚Ñö* d‚ÇÉ) (b‚ÇÉ ‚Ñö* c‚ÇÉ) (b‚ÇÉ ‚Ñö* d‚ÇÉ)
      MAX‚ÇÇ = max‚ÇÑ (a‚ÇÉ ‚Ñö* c‚ÇÉ) (a‚ÇÉ ‚Ñö* d‚ÇÉ) (b‚ÇÉ ‚Ñö* c‚ÇÉ) (b‚ÇÉ ‚Ñö* d‚ÇÉ)

      MIN‚ÇÅ‚â§MIN‚ÇÇ : MIN‚ÇÅ ‚â§ MIN‚ÇÇ
      MIN‚ÇÅ‚â§MIN‚ÇÇ = {!!}

      MAX‚ÇÇ‚â§MAX‚ÇÅ : MAX‚ÇÇ ‚â§ MAX‚ÇÅ
      MAX‚ÇÇ‚â§MAX‚ÇÅ = {!!}

      p&lt;MIN‚ÇÇ : p &lt; MIN‚ÇÇ
      p&lt;MIN‚ÇÇ = ‚Ñö&lt;-‚â§-trans fe p MIN‚ÇÅ MIN‚ÇÇ p&lt;MIN‚ÇÅ MIN‚ÇÅ‚â§MIN‚ÇÇ

      MIN‚ÇÇ‚â§MAX‚ÇÇ : MIN‚ÇÇ ‚â§ MAX‚ÇÇ
      MIN‚ÇÇ‚â§MAX‚ÇÇ = min‚ÇÑ‚â§max‚ÇÑ (a‚ÇÉ ‚Ñö* c‚ÇÉ) (a‚ÇÉ ‚Ñö* d‚ÇÉ) (b‚ÇÉ ‚Ñö* c‚ÇÉ) (b‚ÇÉ ‚Ñö* d‚ÇÉ)

      MAX‚ÇÇ&lt;q : MAX‚ÇÇ &lt; q
      MAX‚ÇÇ&lt;q = ‚Ñö‚â§-&lt;-trans fe MAX‚ÇÇ MAX‚ÇÅ q MAX‚ÇÇ‚â§MAX‚ÇÅ MAX‚ÇÅ&lt;q

      MAX‚ÇÇ‚â§q : MAX‚ÇÇ ‚â§ q
      MAX‚ÇÇ‚â§q = ‚Ñö&lt;-coarser-than-‚â§ MAX‚ÇÇ q MAX‚ÇÇ&lt;q
-}</a>
<a id="5382" class="Markup">\end{code}</a><a id="5392" class="Background">
</a></pre></body></html>