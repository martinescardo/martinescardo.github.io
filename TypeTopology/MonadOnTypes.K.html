<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>MonadOnTypes.K</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Background">Martin Escardo, Paulo Oliva, 2023

</a><a id="36" class="Markup">\begin{code}</a>

<a id="50" class="Symbol">{-#</a> <a id="54" class="Keyword">OPTIONS</a> <a id="62" class="Pragma">--safe</a> <a id="69" class="Pragma">--without-K</a> <a id="81" class="Symbol">#-}</a>

<a id="86" class="Keyword">open</a> <a id="91" class="Keyword">import</a> <a id="98" href="MLTT.Spartan.html" class="Module">MLTT.Spartan</a> <a id="111" class="Keyword">hiding</a> <a id="118" class="Symbol">(</a><a id="119" href="MLTT.Id.html#438" class="Function">J</a><a id="120" class="Symbol">)</a>

<a id="123" class="Keyword">module</a> <a id="130" href="MonadOnTypes.K.html" class="Module">MonadOnTypes.K</a> <a id="145" class="Keyword">where</a>

<a id="152" class="Keyword">open</a> <a id="157" class="Keyword">import</a> <a id="164" href="MonadOnTypes.Monad.html" class="Module">MonadOnTypes.Monad</a>

<a id="𝕂"></a><a id="184" href="MonadOnTypes.K.html#184" class="Function">𝕂</a> <a id="186" class="Symbol">:</a> <a id="188" href="Notation.General.html#372" class="Function">Type</a> <a id="193" class="Symbol">→</a> <a id="195" href="MonadOnTypes.Monad.html#263" class="Record">Monad</a>
<a id="201" href="MonadOnTypes.K.html#184" class="Function">𝕂</a> <a id="203" href="MonadOnTypes.K.html#203" class="Bound">R</a> <a id="205" class="Symbol">=</a> <a id="207" class="Keyword">record</a> <a id="214" class="Symbol">{</a>
       <a id="223" href="MonadOnTypes.Monad.html#315" class="Field">functor</a> <a id="231" class="Symbol">=</a> <a id="233" class="Symbol">λ</a> <a id="235" href="MonadOnTypes.K.html#235" class="Bound">X</a> <a id="237" class="Symbol">→</a> <a id="239" class="Symbol">(</a><a id="240" href="MonadOnTypes.K.html#235" class="Bound">X</a> <a id="242" class="Symbol">→</a> <a id="244" href="MonadOnTypes.K.html#203" class="Bound">R</a><a id="245" class="Symbol">)</a> <a id="247" class="Symbol">→</a> <a id="249" href="MonadOnTypes.K.html#203" class="Bound">R</a> <a id="251" class="Symbol">;</a>
       <a id="260" href="MonadOnTypes.Monad.html#371" class="Field">η</a>       <a id="268" class="Symbol">=</a> <a id="270" class="Symbol">λ</a> <a id="272" href="MonadOnTypes.K.html#272" class="Bound">x</a> <a id="274" href="MonadOnTypes.K.html#274" class="Bound">p</a> <a id="276" class="Symbol">→</a> <a id="278" href="MonadOnTypes.K.html#274" class="Bound">p</a> <a id="280" href="MonadOnTypes.K.html#272" class="Bound">x</a> <a id="282" class="Symbol">;</a>
       <a id="291" href="MonadOnTypes.Monad.html#404" class="Field">ext</a>     <a id="299" class="Symbol">=</a> <a id="301" class="Symbol">λ</a> <a id="303" href="MonadOnTypes.K.html#303" class="Bound">f</a> <a id="305" href="MonadOnTypes.K.html#305" class="Bound">ϕ</a> <a id="307" href="MonadOnTypes.K.html#307" class="Bound">p</a> <a id="309" class="Symbol">→</a> <a id="311" href="MonadOnTypes.K.html#305" class="Bound">ϕ</a> <a id="313" class="Symbol">(λ</a> <a id="316" href="MonadOnTypes.K.html#316" class="Bound">x</a> <a id="318" class="Symbol">→</a> <a id="320" href="MonadOnTypes.K.html#303" class="Bound">f</a> <a id="322" href="MonadOnTypes.K.html#316" class="Bound">x</a> <a id="324" href="MonadOnTypes.K.html#307" class="Bound">p</a><a id="325" class="Symbol">)</a> <a id="327" class="Symbol">;</a>
       <a id="336" href="MonadOnTypes.Monad.html#453" class="Field">ext-η</a>   <a id="344" class="Symbol">=</a> <a id="346" class="Symbol">λ</a> <a id="348" href="MonadOnTypes.K.html#348" class="Bound">x</a> <a id="350" class="Symbol">→</a> <a id="352" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="357" class="Symbol">;</a>
       <a id="366" href="MonadOnTypes.Monad.html#501" class="Field">unit</a>    <a id="374" class="Symbol">=</a> <a id="376" class="Symbol">λ</a> <a id="378" href="MonadOnTypes.K.html#378" class="Bound">f</a> <a id="380" href="MonadOnTypes.K.html#380" class="Bound">x</a> <a id="382" class="Symbol">→</a> <a id="384" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="389" class="Symbol">;</a>
       <a id="398" href="MonadOnTypes.Monad.html#556" class="Field">assoc</a>   <a id="406" class="Symbol">=</a> <a id="408" class="Symbol">λ</a> <a id="410" href="MonadOnTypes.K.html#410" class="Bound">g</a> <a id="412" href="MonadOnTypes.K.html#412" class="Bound">f</a> <a id="414" href="MonadOnTypes.K.html#414" class="Bound">x</a> <a id="416" class="Symbol">→</a> <a id="418" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>
     <a id="428" class="Symbol">}</a>

<a id="431" class="Keyword">module</a> <a id="K-definitions"></a><a id="438" href="MonadOnTypes.K.html#438" class="Module">K-definitions</a> <a id="452" class="Symbol">(</a><a id="453" href="MonadOnTypes.K.html#453" class="Bound">R</a> <a id="455" class="Symbol">:</a> <a id="457" href="Notation.General.html#372" class="Function">Type</a><a id="461" class="Symbol">)</a> <a id="463" class="Keyword">where</a>

 <a id="K-definitions.K"></a><a id="471" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="473" class="Symbol">:</a> <a id="475" href="Notation.General.html#372" class="Function">Type</a> <a id="480" class="Symbol">→</a> <a id="482" href="Notation.General.html#372" class="Function">Type</a>
 <a id="488" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="490" class="Symbol">=</a> <a id="492" href="MonadOnTypes.Monad.html#315" class="Field">functor</a> <a id="500" class="Symbol">(</a><a id="501" href="MonadOnTypes.K.html#184" class="Function">𝕂</a> <a id="503" href="MonadOnTypes.K.html#453" class="Bound">R</a><a id="504" class="Symbol">)</a>

 <a id="K-definitions._⊗ᴷ_"></a><a id="508" href="MonadOnTypes.K.html#508" class="Function Operator">_⊗ᴷ_</a> <a id="513" class="Symbol">:</a> <a id="515" class="Symbol">{</a><a id="516" href="MonadOnTypes.K.html#516" class="Bound">X</a> <a id="518" class="Symbol">:</a> <a id="520" href="Notation.General.html#372" class="Function">Type</a><a id="524" class="Symbol">}</a> <a id="526" class="Symbol">{</a><a id="527" href="MonadOnTypes.K.html#527" class="Bound">Y</a> <a id="529" class="Symbol">:</a> <a id="531" href="MonadOnTypes.K.html#516" class="Bound">X</a> <a id="533" class="Symbol">→</a> <a id="535" href="Notation.General.html#372" class="Function">Type</a><a id="539" class="Symbol">}</a>
      <a id="547" class="Symbol">→</a> <a id="549" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="551" href="MonadOnTypes.K.html#516" class="Bound">X</a>
      <a id="559" class="Symbol">→</a> <a id="561" class="Symbol">((</a><a id="563" href="MonadOnTypes.K.html#563" class="Bound">x</a> <a id="565" class="Symbol">:</a> <a id="567" href="MonadOnTypes.K.html#516" class="Bound">X</a><a id="568" class="Symbol">)</a> <a id="570" class="Symbol">→</a> <a id="572" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="574" class="Symbol">(</a><a id="575" href="MonadOnTypes.K.html#527" class="Bound">Y</a> <a id="577" href="MonadOnTypes.K.html#563" class="Bound">x</a><a id="578" class="Symbol">))</a>
      <a id="587" class="Symbol">→</a> <a id="589" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="591" class="Symbol">(</a><a id="592" href="MLTT.Sigma.html#423" class="Function">Σ</a> <a id="594" href="MonadOnTypes.K.html#594" class="Bound">x</a> <a id="596" href="MLTT.Sigma.html#423" class="Function">꞉</a> <a id="598" href="MonadOnTypes.K.html#516" class="Bound">X</a> <a id="600" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="602" href="MonadOnTypes.K.html#527" class="Bound">Y</a> <a id="604" href="MonadOnTypes.K.html#594" class="Bound">x</a><a id="605" class="Symbol">)</a>
 <a id="608" href="MonadOnTypes.K.html#508" class="Function Operator">_⊗ᴷ_</a> <a id="613" class="Symbol">=</a> <a id="615" href="MonadOnTypes.Monad.html#4039" class="Function Operator">_⊗_</a> <a id="619" class="Symbol">(</a><a id="620" href="MonadOnTypes.K.html#184" class="Function">𝕂</a> <a id="622" href="MonadOnTypes.K.html#453" class="Bound">R</a><a id="623" class="Symbol">)</a>

 <a id="K-definitions.⊗ᴷ-direct-definition"></a><a id="627" href="MonadOnTypes.K.html#627" class="Function">⊗ᴷ-direct-definition</a> <a id="648" class="Symbol">:</a> <a id="650" class="Symbol">{</a><a id="651" href="MonadOnTypes.K.html#651" class="Bound">X</a> <a id="653" class="Symbol">:</a> <a id="655" href="Notation.General.html#372" class="Function">Type</a><a id="659" class="Symbol">}</a> <a id="661" class="Symbol">{</a><a id="662" href="MonadOnTypes.K.html#662" class="Bound">Y</a> <a id="664" class="Symbol">:</a> <a id="666" href="MonadOnTypes.K.html#651" class="Bound">X</a> <a id="668" class="Symbol">→</a> <a id="670" href="Notation.General.html#372" class="Function">Type</a><a id="674" class="Symbol">}</a>
                        <a id="700" class="Symbol">(</a><a id="701" href="MonadOnTypes.K.html#701" class="Bound">ϕ</a> <a id="703" class="Symbol">:</a> <a id="705" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="707" href="MonadOnTypes.K.html#651" class="Bound">X</a><a id="708" class="Symbol">)</a>
                        <a id="734" class="Symbol">(</a><a id="735" href="MonadOnTypes.K.html#735" class="Bound">γ</a> <a id="737" class="Symbol">:</a> <a id="739" class="Symbol">(</a><a id="740" href="MonadOnTypes.K.html#740" class="Bound">x</a> <a id="742" class="Symbol">:</a> <a id="744" href="MonadOnTypes.K.html#651" class="Bound">X</a><a id="745" class="Symbol">)</a> <a id="747" class="Symbol">→</a> <a id="749" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="751" class="Symbol">(</a><a id="752" href="MonadOnTypes.K.html#662" class="Bound">Y</a> <a id="754" href="MonadOnTypes.K.html#740" class="Bound">x</a><a id="755" class="Symbol">))</a>
                      <a id="780" class="Symbol">→</a> <a id="782" href="MonadOnTypes.K.html#701" class="Bound">ϕ</a> <a id="784" href="MonadOnTypes.K.html#508" class="Function Operator">⊗ᴷ</a> <a id="787" href="MonadOnTypes.K.html#735" class="Bound">γ</a> <a id="789" href="MLTT.Id.html#1889" class="Function Operator">∼</a> <a id="791" class="Symbol">(λ</a> <a id="794" href="MonadOnTypes.K.html#794" class="Bound">q</a> <a id="796" class="Symbol">→</a> <a id="798" href="MonadOnTypes.K.html#701" class="Bound">ϕ</a> <a id="800" class="Symbol">(λ</a> <a id="803" href="MonadOnTypes.K.html#803" class="Bound">x</a> <a id="805" class="Symbol">→</a> <a id="807" href="MonadOnTypes.K.html#735" class="Bound">γ</a> <a id="809" href="MonadOnTypes.K.html#803" class="Bound">x</a> <a id="811" class="Symbol">(</a><a id="812" href="MLTT.Sigma.html#719" class="Function">curry</a> <a id="818" href="MonadOnTypes.K.html#794" class="Bound">q</a> <a id="820" href="MonadOnTypes.K.html#803" class="Bound">x</a><a id="821" class="Symbol">)))</a>
 <a id="826" href="MonadOnTypes.K.html#627" class="Function">⊗ᴷ-direct-definition</a> <a id="847" href="MonadOnTypes.K.html#847" class="Bound">ϕ</a> <a id="849" href="MonadOnTypes.K.html#849" class="Bound">γ</a> <a id="851" href="MonadOnTypes.K.html#851" class="Bound">q</a> <a id="853" class="Symbol">=</a> <a id="855" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>

 <a id="K-definitions.ηᴷ"></a><a id="862" href="MonadOnTypes.K.html#862" class="Function">ηᴷ</a> <a id="865" class="Symbol">:</a> <a id="867" class="Symbol">{</a><a id="868" href="MonadOnTypes.K.html#868" class="Bound">X</a> <a id="870" class="Symbol">:</a> <a id="872" href="Notation.General.html#372" class="Function">Type</a><a id="876" class="Symbol">}</a> <a id="878" class="Symbol">→</a> <a id="880" href="MonadOnTypes.K.html#868" class="Bound">X</a> <a id="882" class="Symbol">→</a> <a id="884" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="886" href="MonadOnTypes.K.html#868" class="Bound">X</a>
 <a id="889" href="MonadOnTypes.K.html#862" class="Function">ηᴷ</a> <a id="892" class="Symbol">=</a> <a id="894" href="MonadOnTypes.Monad.html#371" class="Field">η</a> <a id="896" class="Symbol">(</a><a id="897" href="MonadOnTypes.K.html#184" class="Function">𝕂</a> <a id="899" href="MonadOnTypes.K.html#453" class="Bound">R</a><a id="900" class="Symbol">)</a>

 <a id="K-definitions.extᴷ"></a><a id="904" href="MonadOnTypes.K.html#904" class="Function">extᴷ</a> <a id="909" class="Symbol">:</a> <a id="911" class="Symbol">{</a><a id="912" href="MonadOnTypes.K.html#912" class="Bound">X</a> <a id="914" href="MonadOnTypes.K.html#914" class="Bound">Y</a> <a id="916" class="Symbol">:</a> <a id="918" href="Notation.General.html#372" class="Function">Type</a><a id="922" class="Symbol">}</a> <a id="924" class="Symbol">→</a> <a id="926" class="Symbol">(</a><a id="927" href="MonadOnTypes.K.html#912" class="Bound">X</a> <a id="929" class="Symbol">→</a> <a id="931" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="933" href="MonadOnTypes.K.html#914" class="Bound">Y</a><a id="934" class="Symbol">)</a> <a id="936" class="Symbol">→</a> <a id="938" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="940" href="MonadOnTypes.K.html#912" class="Bound">X</a> <a id="942" class="Symbol">→</a> <a id="944" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="946" href="MonadOnTypes.K.html#914" class="Bound">Y</a>
 <a id="949" href="MonadOnTypes.K.html#904" class="Function">extᴷ</a> <a id="954" class="Symbol">=</a> <a id="956" href="MonadOnTypes.Monad.html#404" class="Field">ext</a> <a id="960" class="Symbol">(</a><a id="961" href="MonadOnTypes.K.html#184" class="Function">𝕂</a> <a id="963" href="MonadOnTypes.K.html#453" class="Bound">R</a><a id="964" class="Symbol">)</a>

 <a id="K-definitions.mapᴷ"></a><a id="968" href="MonadOnTypes.K.html#968" class="Function">mapᴷ</a> <a id="973" class="Symbol">:</a> <a id="975" class="Symbol">{</a><a id="976" href="MonadOnTypes.K.html#976" class="Bound">X</a> <a id="978" href="MonadOnTypes.K.html#978" class="Bound">Y</a> <a id="980" class="Symbol">:</a> <a id="982" href="Notation.General.html#372" class="Function">Type</a><a id="986" class="Symbol">}</a> <a id="988" class="Symbol">→</a> <a id="990" class="Symbol">(</a><a id="991" href="MonadOnTypes.K.html#976" class="Bound">X</a> <a id="993" class="Symbol">→</a> <a id="995" href="MonadOnTypes.K.html#978" class="Bound">Y</a><a id="996" class="Symbol">)</a> <a id="998" class="Symbol">→</a> <a id="1000" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="1002" href="MonadOnTypes.K.html#976" class="Bound">X</a> <a id="1004" class="Symbol">→</a> <a id="1006" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="1008" href="MonadOnTypes.K.html#978" class="Bound">Y</a>
 <a id="1011" href="MonadOnTypes.K.html#968" class="Function">mapᴷ</a> <a id="1016" class="Symbol">=</a> <a id="1018" href="MonadOnTypes.Monad.html#655" class="Function">map</a> <a id="1022" class="Symbol">(</a><a id="1023" href="MonadOnTypes.K.html#184" class="Function">𝕂</a> <a id="1025" href="MonadOnTypes.K.html#453" class="Bound">R</a><a id="1026" class="Symbol">)</a>

<a id="1029" class="Markup">\end{code}</a><a id="1039" class="Background">
</a></pre></body></html>