<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>GamesExperimental.TicTacToe0</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Background">Martin Escardo, Paulo Oliva, 27th October 2022

Implementation of tic-tac-toe using a general definition of finite
history dependent game.

</a><a id="141" class="Markup">\begin{code}</a>

<a id="155" class="Symbol">{-#</a> <a id="159" class="Keyword">OPTIONS</a> <a id="167" class="Pragma">--safe</a> <a id="174" class="Pragma">--without-K</a> <a id="186" class="Pragma">--no-level-universe</a> <a id="206" class="Symbol">#-}</a>

<a id="211" class="Keyword">module</a> <a id="218" href="GamesExperimental.TicTacToe0.html" class="Module">GamesExperimental.TicTacToe0</a> <a id="247" class="Keyword">where</a>

<a id="254" class="Keyword">open</a> <a id="259" class="Keyword">import</a> <a id="266" href="Fin.ArgMinMax.html" class="Module">Fin.ArgMinMax</a>
<a id="280" class="Keyword">open</a> <a id="285" class="Keyword">import</a> <a id="292" href="Fin.Topology.html" class="Module">Fin.Topology</a>
<a id="305" class="Keyword">open</a> <a id="310" class="Keyword">import</a> <a id="317" href="Fin.Type.html" class="Module">Fin.Type</a>
<a id="326" class="Keyword">open</a> <a id="331" class="Keyword">import</a> <a id="338" href="GamesExperimental.J.html" class="Module">GamesExperimental.J</a>
<a id="358" class="Keyword">open</a> <a id="363" class="Keyword">import</a> <a id="370" href="GamesExperimental.K.html" class="Module">GamesExperimental.K</a>
<a id="390" class="Keyword">open</a> <a id="395" class="Keyword">import</a> <a id="402" href="GamesExperimental.TypeTrees.html" class="Module">GamesExperimental.TypeTrees</a>
<a id="430" class="Keyword">open</a> <a id="435" class="Keyword">import</a> <a id="442" href="MLTT.Athenian.html" class="Module">MLTT.Athenian</a>
<a id="456" class="Keyword">open</a> <a id="461" class="Keyword">import</a> <a id="468" href="MLTT.Spartan.html" class="Module">MLTT.Spartan</a> <a id="481" class="Keyword">hiding</a> <a id="488" class="Symbol">(</a><a id="489" href="MLTT.Id.html#438" class="Function">J</a><a id="490" class="Symbol">)</a>
<a id="492" class="Keyword">open</a> <a id="497" class="Keyword">import</a> <a id="504" href="TypeTopology.CompactTypes.html" class="Module">TypeTopology.CompactTypes</a>
<a id="530" class="Keyword">open</a> <a id="535" class="Keyword">import</a> <a id="542" href="TypeTopology.SigmaDiscreteAndTotallySeparated.html" class="Module">TypeTopology.SigmaDiscreteAndTotallySeparated</a>
<a id="588" class="Keyword">open</a> <a id="593" class="Keyword">import</a> <a id="600" href="UF.DiscreteAndSeparated.html" class="Module">UF.DiscreteAndSeparated</a>

<a id="625" class="Markup">\end{code}</a><a id="635" class="Background">

The type of outcomes:

</a><a id="660" class="Markup">\begin{code}</a>

<a id="R"></a><a id="674" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a> <a id="676" class="Symbol">:</a> <a id="678" href="Agda.Primitive.html#915" class="Primitive">𝓤₀</a> <a id="681" href="MLTT.Universes.html#3976" class="Function Operator">̇</a>
<a id="683" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a> <a id="685" class="Symbol">=</a> <a id="687" href="Fin.Type.html#157" class="Function">Fin</a> <a id="691" class="Number">3</a>

<a id="694" class="Keyword">open</a> <a id="699" class="Keyword">import</a> <a id="706" href="GamesExperimental.FiniteHistoryDependent.html" class="Module">GamesExperimental.FiniteHistoryDependent</a> <a id="747" class="Symbol">{</a><a id="748" href="Agda.Primitive.html#915" class="Primitive">𝓤₀</a><a id="750" class="Symbol">}</a> <a id="752" class="Symbol">{</a><a id="753" href="Agda.Primitive.html#915" class="Primitive">𝓤₀</a><a id="755" class="Symbol">}</a> <a id="757" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a>
<a id="759" class="Keyword">open</a> <a id="764" class="Keyword">import</a> <a id="771" href="GamesExperimental.JK.html" class="Module">GamesExperimental.JK</a>

<a id="793" class="Markup">\end{code}</a><a id="803" class="Background">

The meaning of the outcomes:

</a><a id="835" class="Markup">\begin{code}</a>

<a id="X-wins"></a><a id="849" href="GamesExperimental.TicTacToe0.html#849" class="Function">X-wins</a> <a id="draw"></a><a id="856" href="GamesExperimental.TicTacToe0.html#856" class="Function">draw</a> <a id="O-wins"></a><a id="861" href="GamesExperimental.TicTacToe0.html#861" class="Function">O-wins</a> <a id="868" class="Symbol">:</a> <a id="870" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a>
<a id="872" href="GamesExperimental.TicTacToe0.html#849" class="Function">X-wins</a> <a id="879" class="Symbol">=</a> <a id="881" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a>
<a id="883" href="GamesExperimental.TicTacToe0.html#856" class="Function">draw</a>   <a id="890" class="Symbol">=</a> <a id="892" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a>
<a id="894" href="GamesExperimental.TicTacToe0.html#861" class="Function">O-wins</a> <a id="901" class="Symbol">=</a> <a id="903" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a>

<a id="906" class="Markup">\end{code}</a><a id="916" class="Background">

In our conception of game, it is not necessary to specify the players,
but in this case it is convenient to do so:

</a><a id="1034" class="Markup">\begin{code}</a>

<a id="1048" class="Keyword">data</a> <a id="Player"></a><a id="1053" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a> <a id="1060" class="Symbol">:</a> <a id="1062" href="Agda.Primitive.html#915" class="Primitive">𝓤₀</a> <a id="1065" href="MLTT.Universes.html#3976" class="Function Operator">̇</a> <a id="1067" class="Keyword">where</a>
 <a id="Player.X"></a><a id="1074" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a> <a id="Player.O"></a><a id="1076" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a> <a id="1078" class="Symbol">:</a> <a id="1080" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a>

<a id="opponent"></a><a id="1088" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="1097" class="Symbol">:</a> <a id="1099" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a> <a id="1106" class="Symbol">→</a> <a id="1108" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a>
<a id="1115" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="1124" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a> <a id="1126" class="Symbol">=</a> <a id="1128" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a>
<a id="1130" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="1139" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a> <a id="1141" class="Symbol">=</a> <a id="1143" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a>

<a id="value"></a><a id="1146" href="GamesExperimental.TicTacToe0.html#1146" class="Function">value</a> <a id="1152" class="Symbol">:</a> <a id="1154" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a> <a id="1161" class="Symbol">→</a> <a id="1163" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a>
<a id="1165" href="GamesExperimental.TicTacToe0.html#1146" class="Function">value</a> <a id="1171" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a> <a id="1173" class="Symbol">=</a> <a id="1175" href="GamesExperimental.TicTacToe0.html#849" class="Function">X-wins</a>
<a id="1182" href="GamesExperimental.TicTacToe0.html#1146" class="Function">value</a> <a id="1188" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a> <a id="1190" class="Symbol">=</a> <a id="1192" href="GamesExperimental.TicTacToe0.html#861" class="Function">O-wins</a>

<a id="1200" class="Markup">\end{code}</a><a id="1210" class="Background">

It is also convenient to have a type of boards:

</a><a id="1261" class="Markup">\begin{code}</a>

<a id="Grid"></a><a id="1275" href="GamesExperimental.TicTacToe0.html#1275" class="Function">Grid</a>   <a id="1282" class="Symbol">=</a> <a id="1284" href="Fin.Type.html#157" class="Function">Fin</a> <a id="1288" class="Number">3</a> <a id="1290" href="MLTT.Sigma.html#558" class="Function Operator">×</a> <a id="1292" href="Fin.Type.html#157" class="Function">Fin</a> <a id="1296" class="Number">3</a>
<a id="Matrix"></a><a id="1298" href="GamesExperimental.TicTacToe0.html#1298" class="Function">Matrix</a> <a id="1305" class="Symbol">=</a> <a id="1307" href="GamesExperimental.TicTacToe0.html#1275" class="Function">Grid</a> <a id="1312" class="Symbol">→</a> <a id="1314" href="MLTT.Maybe.html#110" class="Datatype">Maybe</a> <a id="1320" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a>
<a id="Board"></a><a id="1327" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a>  <a id="1334" class="Symbol">=</a> <a id="1336" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a> <a id="1343" href="MLTT.Sigma.html#558" class="Function Operator">×</a> <a id="1345" href="GamesExperimental.TicTacToe0.html#1298" class="Function">Matrix</a>

<a id="board₀"></a><a id="1353" href="GamesExperimental.TicTacToe0.html#1353" class="Function">board₀</a> <a id="1360" class="Symbol">:</a> <a id="1362" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a>
<a id="1368" href="GamesExperimental.TicTacToe0.html#1353" class="Function">board₀</a> <a id="1375" class="Symbol">=</a> <a id="1377" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a> <a id="1379" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1381" class="Symbol">(λ</a> <a id="1384" href="GamesExperimental.TicTacToe0.html#1384" class="Bound">_</a> <a id="1386" class="Symbol">→</a> <a id="1388" href="MLTT.Maybe.html#155" class="InductiveConstructor">Nothing</a><a id="1395" class="Symbol">)</a>

<a id="1398" class="Markup">\end{code}</a><a id="1408" class="Background">

Convention: in a board (p , A), the player p plays next.

</a><a id="1468" class="Markup">\begin{code}</a>

<a id="wins"></a><a id="1482" href="GamesExperimental.TicTacToe0.html#1482" class="Function">wins</a> <a id="1487" class="Symbol">:</a> <a id="1489" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a> <a id="1496" class="Symbol">→</a> <a id="1498" href="GamesExperimental.TicTacToe0.html#1298" class="Function">Matrix</a> <a id="1505" class="Symbol">→</a> <a id="1507" href="MLTT.Bool.html#109" class="Datatype">Bool</a>
<a id="1512" href="GamesExperimental.TicTacToe0.html#1482" class="Function">wins</a> <a id="1517" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1519" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1521" class="Symbol">=</a> <a id="1523" href="GamesExperimental.TicTacToe0.html#2188" class="Function">line</a> <a id="1528" href="MLTT.Bool.html#740" class="Function Operator">||</a> <a id="1531" href="GamesExperimental.TicTacToe0.html#2212" class="Function">col</a> <a id="1535" href="MLTT.Bool.html#740" class="Function Operator">||</a> <a id="1538" href="GamesExperimental.TicTacToe0.html#2236" class="Function">diag</a>
 <a id="1544" class="Keyword">where</a>
  <a id="1552" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">_is_</a> <a id="1557" class="Symbol">:</a> <a id="1559" href="MLTT.Maybe.html#110" class="Datatype">Maybe</a> <a id="1565" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a> <a id="1572" class="Symbol">→</a> <a id="1574" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a> <a id="1581" class="Symbol">→</a> <a id="1583" href="MLTT.Bool.html#109" class="Datatype">Bool</a>
  <a id="1590" href="MLTT.Maybe.html#155" class="InductiveConstructor">Nothing</a> <a id="1598" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1601" class="Symbol">_</a> <a id="1603" class="Symbol">=</a> <a id="1605" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a>
  <a id="1613" href="MLTT.Maybe.html#174" class="InductiveConstructor">Just</a> <a id="1618" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a>  <a id="1621" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1624" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a> <a id="1626" class="Symbol">=</a> <a id="1628" href="MLTT.Bool.html#128" class="InductiveConstructor">true</a>
  <a id="1635" href="MLTT.Maybe.html#174" class="InductiveConstructor">Just</a> <a id="1640" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a>  <a id="1643" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1646" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a> <a id="1648" class="Symbol">=</a> <a id="1650" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a>
  <a id="1658" href="MLTT.Maybe.html#174" class="InductiveConstructor">Just</a> <a id="1663" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a>  <a id="1666" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1669" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a> <a id="1671" class="Symbol">=</a> <a id="1673" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a>
  <a id="1681" href="MLTT.Maybe.html#174" class="InductiveConstructor">Just</a> <a id="1686" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a>  <a id="1689" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1692" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a> <a id="1694" class="Symbol">=</a> <a id="1696" href="MLTT.Bool.html#128" class="InductiveConstructor">true</a>

  <a id="1704" class="Keyword">infix</a> <a id="1710" class="Number">30</a> <a id="1713" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">_is_</a>

  <a id="1721" href="GamesExperimental.TicTacToe0.html#1721" class="Function">l₀</a> <a id="1724" class="Symbol">=</a> <a id="1726" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1728" class="Symbol">(</a><a id="1729" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a> <a id="1731" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1733" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a><a id="1734" class="Symbol">)</a> <a id="1736" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1739" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1741" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1744" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1746" class="Symbol">(</a><a id="1747" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a> <a id="1749" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1751" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a><a id="1752" class="Symbol">)</a> <a id="1754" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1757" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1759" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1762" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1764" class="Symbol">(</a><a id="1765" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a> <a id="1767" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1769" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a><a id="1770" class="Symbol">)</a> <a id="1772" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1775" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a>
  <a id="1779" href="GamesExperimental.TicTacToe0.html#1779" class="Function">l₁</a> <a id="1782" class="Symbol">=</a> <a id="1784" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1786" class="Symbol">(</a><a id="1787" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a> <a id="1789" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1791" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a><a id="1792" class="Symbol">)</a> <a id="1794" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1797" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1799" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1802" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1804" class="Symbol">(</a><a id="1805" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a> <a id="1807" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1809" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a><a id="1810" class="Symbol">)</a> <a id="1812" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1815" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1817" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1820" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1822" class="Symbol">(</a><a id="1823" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a> <a id="1825" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1827" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a><a id="1828" class="Symbol">)</a> <a id="1830" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1833" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a>
  <a id="1837" href="GamesExperimental.TicTacToe0.html#1837" class="Function">l₂</a> <a id="1840" class="Symbol">=</a> <a id="1842" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1844" class="Symbol">(</a><a id="1845" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a> <a id="1847" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1849" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a><a id="1850" class="Symbol">)</a> <a id="1852" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1855" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1857" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1860" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1862" class="Symbol">(</a><a id="1863" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a> <a id="1865" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1867" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a><a id="1868" class="Symbol">)</a> <a id="1870" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1873" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1875" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1878" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1880" class="Symbol">(</a><a id="1881" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a> <a id="1883" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1885" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a><a id="1886" class="Symbol">)</a> <a id="1888" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1891" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a>

  <a id="1896" href="GamesExperimental.TicTacToe0.html#1896" class="Function">c₀</a> <a id="1899" class="Symbol">=</a> <a id="1901" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1903" class="Symbol">(</a><a id="1904" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a> <a id="1906" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1908" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a><a id="1909" class="Symbol">)</a> <a id="1911" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1914" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1916" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1919" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1921" class="Symbol">(</a><a id="1922" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a> <a id="1924" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1926" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a><a id="1927" class="Symbol">)</a> <a id="1929" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1932" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1934" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1937" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1939" class="Symbol">(</a><a id="1940" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a> <a id="1942" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1944" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a><a id="1945" class="Symbol">)</a> <a id="1947" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1950" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a>
  <a id="1954" href="GamesExperimental.TicTacToe0.html#1954" class="Function">c₁</a> <a id="1957" class="Symbol">=</a> <a id="1959" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1961" class="Symbol">(</a><a id="1962" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a> <a id="1964" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1966" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a><a id="1967" class="Symbol">)</a> <a id="1969" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1972" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1974" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1977" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1979" class="Symbol">(</a><a id="1980" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a> <a id="1982" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="1984" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a><a id="1985" class="Symbol">)</a> <a id="1987" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="1990" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="1992" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="1995" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="1997" class="Symbol">(</a><a id="1998" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a> <a id="2000" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2002" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a><a id="2003" class="Symbol">)</a> <a id="2005" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2008" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a>
  <a id="2012" href="GamesExperimental.TicTacToe0.html#2012" class="Function">c₂</a> <a id="2015" class="Symbol">=</a> <a id="2017" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2019" class="Symbol">(</a><a id="2020" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a> <a id="2022" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2024" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a><a id="2025" class="Symbol">)</a> <a id="2027" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2030" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="2032" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="2035" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2037" class="Symbol">(</a><a id="2038" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a> <a id="2040" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2042" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a><a id="2043" class="Symbol">)</a> <a id="2045" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2048" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="2050" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="2053" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2055" class="Symbol">(</a><a id="2056" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a> <a id="2058" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2060" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a><a id="2061" class="Symbol">)</a> <a id="2063" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2066" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a>

  <a id="2071" href="GamesExperimental.TicTacToe0.html#2071" class="Function">d₀</a> <a id="2074" class="Symbol">=</a> <a id="2076" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2078" class="Symbol">(</a><a id="2079" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a> <a id="2081" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2083" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a><a id="2084" class="Symbol">)</a> <a id="2086" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2089" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="2091" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="2094" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2096" class="Symbol">(</a><a id="2097" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a> <a id="2099" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2101" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a><a id="2102" class="Symbol">)</a> <a id="2104" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2107" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="2109" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="2112" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2114" class="Symbol">(</a><a id="2115" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a> <a id="2117" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2119" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a><a id="2120" class="Symbol">)</a> <a id="2122" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2125" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a>
  <a id="2129" href="GamesExperimental.TicTacToe0.html#2129" class="Function">d₁</a> <a id="2132" class="Symbol">=</a> <a id="2134" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2136" class="Symbol">(</a><a id="2137" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a> <a id="2139" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2141" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a><a id="2142" class="Symbol">)</a> <a id="2144" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2147" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="2149" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="2152" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2154" class="Symbol">(</a><a id="2155" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a> <a id="2157" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2159" href="Fin.Type.html#679" class="InductiveConstructor">𝟏</a><a id="2160" class="Symbol">)</a> <a id="2162" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2165" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a> <a id="2167" href="MLTT.Bool.html#745" class="Function Operator">&amp;&amp;</a> <a id="2170" href="GamesExperimental.TicTacToe0.html#1519" class="Bound">A</a> <a id="2172" class="Symbol">(</a><a id="2173" href="Fin.Type.html#701" class="InductiveConstructor">𝟐</a> <a id="2175" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2177" href="Fin.Type.html#635" class="InductiveConstructor">𝟎</a><a id="2178" class="Symbol">)</a> <a id="2180" href="GamesExperimental.TicTacToe0.html#1552" class="Function Operator">is</a> <a id="2183" href="GamesExperimental.TicTacToe0.html#1517" class="Bound">p</a>

  <a id="2188" href="GamesExperimental.TicTacToe0.html#2188" class="Function">line</a> <a id="2193" class="Symbol">=</a> <a id="2195" href="GamesExperimental.TicTacToe0.html#1721" class="Function">l₀</a> <a id="2198" href="MLTT.Bool.html#740" class="Function Operator">||</a> <a id="2201" href="GamesExperimental.TicTacToe0.html#1779" class="Function">l₁</a> <a id="2204" href="MLTT.Bool.html#740" class="Function Operator">||</a> <a id="2207" href="GamesExperimental.TicTacToe0.html#1837" class="Function">l₂</a>
  <a id="2212" href="GamesExperimental.TicTacToe0.html#2212" class="Function">col</a>  <a id="2217" class="Symbol">=</a> <a id="2219" href="GamesExperimental.TicTacToe0.html#1896" class="Function">c₀</a> <a id="2222" href="MLTT.Bool.html#740" class="Function Operator">||</a> <a id="2225" href="GamesExperimental.TicTacToe0.html#1954" class="Function">c₁</a> <a id="2228" href="MLTT.Bool.html#740" class="Function Operator">||</a> <a id="2231" href="GamesExperimental.TicTacToe0.html#2012" class="Function">c₂</a>
  <a id="2236" href="GamesExperimental.TicTacToe0.html#2236" class="Function">diag</a> <a id="2241" class="Symbol">=</a> <a id="2243" href="GamesExperimental.TicTacToe0.html#2071" class="Function">d₀</a> <a id="2246" href="MLTT.Bool.html#740" class="Function Operator">||</a> <a id="2249" href="GamesExperimental.TicTacToe0.html#2129" class="Function">d₁</a>

<a id="2253" class="Markup">\end{code}</a><a id="2263" class="Background">

The type of moves in a board:

</a><a id="2296" class="Markup">\begin{code}</a>

<a id="Move"></a><a id="2310" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="2315" class="Symbol">:</a> <a id="2317" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a> <a id="2323" class="Symbol">→</a> <a id="2325" href="Agda.Primitive.html#915" class="Primitive">𝓤₀</a> <a id="2328" href="MLTT.Universes.html#3976" class="Function Operator">̇</a>
<a id="2330" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="2335" class="Symbol">(_</a> <a id="2338" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2340" href="GamesExperimental.TicTacToe0.html#2340" class="Bound">A</a><a id="2341" class="Symbol">)</a> <a id="2343" class="Symbol">=</a> <a id="2345" href="MLTT.Sigma.html#423" class="Function">Σ</a> <a id="2347" href="GamesExperimental.TicTacToe0.html#2347" class="Bound">g</a> <a id="2349" href="MLTT.Sigma.html#423" class="Function">꞉</a> <a id="2351" href="GamesExperimental.TicTacToe0.html#1275" class="Function">Grid</a> <a id="2356" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="2358" href="GamesExperimental.TicTacToe0.html#2340" class="Bound">A</a> <a id="2360" href="GamesExperimental.TicTacToe0.html#2347" class="Bound">g</a> <a id="2362" href="MLTT.Id.html#193" class="Datatype Operator">＝</a> <a id="2364" href="MLTT.Maybe.html#155" class="InductiveConstructor">Nothing</a>

<a id="2373" class="Markup">\end{code}</a><a id="2383" class="Background">

The type of grids has decidable equality (it is discrete) and
decidable quantification (it is compact).  The type of moves in a
board is decidable (either empty or pointed) and also has decidable
quantification.

</a><a id="2598" class="Markup">\begin{code}</a>

<a id="Grid-is-discrete"></a><a id="2612" href="GamesExperimental.TicTacToe0.html#2612" class="Function">Grid-is-discrete</a> <a id="2629" class="Symbol">:</a> <a id="2631" href="UF.DiscreteAndSeparated.html#1853" class="Function">is-discrete</a> <a id="2643" href="GamesExperimental.TicTacToe0.html#1275" class="Function">Grid</a>
<a id="2648" href="GamesExperimental.TicTacToe0.html#2612" class="Function">Grid-is-discrete</a> <a id="2665" class="Symbol">=</a> <a id="2667" href="TypeTopology.SigmaDiscreteAndTotallySeparated.html#2007" class="Function">×-is-discrete</a> <a id="2681" href="Fin.Topology.html#904" class="Function">Fin-is-discrete</a> <a id="2697" href="Fin.Topology.html#904" class="Function">Fin-is-discrete</a>

<a id="Grid-compact"></a><a id="2714" href="GamesExperimental.TicTacToe0.html#2714" class="Function">Grid-compact</a> <a id="2727" class="Symbol">:</a> <a id="2729" href="TypeTopology.CompactTypes.html#20967" class="Function">is-Compact</a> <a id="2740" href="GamesExperimental.TicTacToe0.html#1275" class="Function">Grid</a> <a id="2745" class="Symbol">{</a><a id="2746" href="Agda.Primitive.html#915" class="Primitive">𝓤₀</a><a id="2748" class="Symbol">}</a>
<a id="2750" href="GamesExperimental.TicTacToe0.html#2714" class="Function">Grid-compact</a> <a id="2763" class="Symbol">=</a> <a id="2765" href="TypeTopology.CompactTypes.html#24775" class="Function">×-is-Compact</a> <a id="2778" href="Fin.Topology.html#1245" class="Function">Fin-Compact</a> <a id="2790" href="Fin.Topology.html#1245" class="Function">Fin-Compact</a>

<a id="Move-decidable"></a><a id="2803" href="GamesExperimental.TicTacToe0.html#2803" class="Function">Move-decidable</a> <a id="2818" class="Symbol">:</a> <a id="2820" class="Symbol">(</a><a id="2821" href="GamesExperimental.TicTacToe0.html#2821" class="Bound">b</a> <a id="2823" class="Symbol">:</a> <a id="2825" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a><a id="2830" class="Symbol">)</a> <a id="2832" class="Symbol">→</a> <a id="2834" href="MLTT.Negation.html#584" class="Function">is-decidable</a> <a id="2847" class="Symbol">(</a><a id="2848" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="2853" href="GamesExperimental.TicTacToe0.html#2821" class="Bound">b</a><a id="2854" class="Symbol">)</a>
<a id="2856" href="GamesExperimental.TicTacToe0.html#2803" class="Function">Move-decidable</a> <a id="2871" class="Symbol">(_</a> <a id="2874" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="2876" href="GamesExperimental.TicTacToe0.html#2876" class="Bound">A</a><a id="2877" class="Symbol">)</a> <a id="2879" class="Symbol">=</a> <a id="2881" href="GamesExperimental.TicTacToe0.html#2714" class="Function">Grid-compact</a>
                          <a id="2920" class="Symbol">(λ</a> <a id="2923" href="GamesExperimental.TicTacToe0.html#2923" class="Bound">g</a> <a id="2925" class="Symbol">→</a> <a id="2927" href="GamesExperimental.TicTacToe0.html#2876" class="Bound">A</a> <a id="2929" href="GamesExperimental.TicTacToe0.html#2923" class="Bound">g</a> <a id="2931" href="MLTT.Id.html#193" class="Datatype Operator">＝</a> <a id="2933" href="MLTT.Maybe.html#155" class="InductiveConstructor">Nothing</a><a id="2940" class="Symbol">)</a>
                          <a id="2968" class="Symbol">(λ</a> <a id="2971" href="GamesExperimental.TicTacToe0.html#2971" class="Bound">g</a> <a id="2973" class="Symbol">→</a> <a id="2975" href="MLTT.Maybe.html#518" class="Function">Nothing-is-isolated&#39;</a> <a id="2996" class="Symbol">(</a><a id="2997" href="GamesExperimental.TicTacToe0.html#2876" class="Bound">A</a> <a id="2999" href="GamesExperimental.TicTacToe0.html#2971" class="Bound">g</a><a id="3000" class="Symbol">))</a>

<a id="Move-compact"></a><a id="3004" href="GamesExperimental.TicTacToe0.html#3004" class="Function">Move-compact</a> <a id="3017" class="Symbol">:</a> <a id="3019" class="Symbol">(</a><a id="3020" href="GamesExperimental.TicTacToe0.html#3020" class="Bound">b</a> <a id="3022" class="Symbol">:</a> <a id="3024" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a><a id="3029" class="Symbol">)</a> <a id="3031" class="Symbol">→</a> <a id="3033" href="TypeTopology.CompactTypes.html#20967" class="Function">is-Compact</a> <a id="3044" class="Symbol">(</a><a id="3045" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="3050" href="GamesExperimental.TicTacToe0.html#3020" class="Bound">b</a><a id="3051" class="Symbol">)</a>
<a id="3053" href="GamesExperimental.TicTacToe0.html#3004" class="Function">Move-compact</a> <a id="3066" class="Symbol">(</a><a id="3067" href="GamesExperimental.TicTacToe0.html#3067" class="Bound">x</a> <a id="3069" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="3071" href="GamesExperimental.TicTacToe0.html#3071" class="Bound">A</a><a id="3072" class="Symbol">)</a> <a id="3074" class="Symbol">=</a> <a id="3076" href="TypeTopology.CompactTypes.html#32737" class="Function">complemented-subset-of-compact-type</a>
                        <a id="3136" href="GamesExperimental.TicTacToe0.html#2714" class="Function">Grid-compact</a>
                        <a id="3173" class="Symbol">(λ</a> <a id="3176" href="GamesExperimental.TicTacToe0.html#3176" class="Bound">g</a> <a id="3178" class="Symbol">→</a> <a id="3180" href="MLTT.Maybe.html#518" class="Function">Nothing-is-isolated&#39;</a> <a id="3201" class="Symbol">(</a><a id="3202" href="GamesExperimental.TicTacToe0.html#3071" class="Bound">A</a> <a id="3204" href="GamesExperimental.TicTacToe0.html#3176" class="Bound">g</a><a id="3205" class="Symbol">))</a>
                        <a id="3232" class="Symbol">(λ</a> <a id="3235" href="GamesExperimental.TicTacToe0.html#3235" class="Bound">g</a> <a id="3237" class="Symbol">→</a> <a id="3239" href="MLTT.Maybe.html#974" class="Function">Nothing-is-h-isolated&#39;</a> <a id="3262" class="Symbol">(</a><a id="3263" href="GamesExperimental.TicTacToe0.html#3071" class="Bound">A</a> <a id="3265" href="GamesExperimental.TicTacToe0.html#3235" class="Bound">g</a><a id="3266" class="Symbol">))</a>
<a id="3269" class="Markup">\end{code}</a><a id="3279" class="Background">

Update a matrix by playing a move:

</a><a id="3317" class="Markup">\begin{code}</a>

<a id="update"></a><a id="3331" href="GamesExperimental.TicTacToe0.html#3331" class="Function">update</a> <a id="3338" class="Symbol">:</a> <a id="3340" class="Symbol">(</a><a id="3341" href="GamesExperimental.TicTacToe0.html#3341" class="Bound">p</a> <a id="3343" class="Symbol">:</a> <a id="3345" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a><a id="3351" class="Symbol">)</a> <a id="3353" class="Symbol">(</a><a id="3354" href="GamesExperimental.TicTacToe0.html#3354" class="Bound">A</a> <a id="3356" class="Symbol">:</a> <a id="3358" href="GamesExperimental.TicTacToe0.html#1298" class="Function">Matrix</a><a id="3364" class="Symbol">)</a> <a id="3366" class="Symbol">→</a> <a id="3368" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="3373" class="Symbol">(</a><a id="3374" href="GamesExperimental.TicTacToe0.html#3341" class="Bound">p</a> <a id="3376" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="3378" href="GamesExperimental.TicTacToe0.html#3354" class="Bound">A</a><a id="3379" class="Symbol">)</a> <a id="3381" class="Symbol">→</a> <a id="3383" href="GamesExperimental.TicTacToe0.html#1298" class="Function">Matrix</a>
<a id="3390" href="GamesExperimental.TicTacToe0.html#3331" class="Function">update</a> <a id="3397" href="GamesExperimental.TicTacToe0.html#3397" class="Bound">p</a> <a id="3399" href="GamesExperimental.TicTacToe0.html#3399" class="Bound">A</a> <a id="3401" class="Symbol">(</a><a id="3402" href="GamesExperimental.TicTacToe0.html#3402" class="Bound">g</a> <a id="3404" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="3406" class="Symbol">_)</a> <a id="3409" href="GamesExperimental.TicTacToe0.html#3409" class="Bound">g&#39;</a> <a id="3412" class="Keyword">with</a> <a id="3417" class="Symbol">(</a><a id="3418" href="GamesExperimental.TicTacToe0.html#2612" class="Function">Grid-is-discrete</a> <a id="3435" href="GamesExperimental.TicTacToe0.html#3402" class="Bound">g</a> <a id="3437" href="GamesExperimental.TicTacToe0.html#3409" class="Bound">g&#39;</a><a id="3439" class="Symbol">)</a>
<a id="3441" class="Symbol">...</a>                        <a id="3468" class="Symbol">|</a> <a id="3470" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="3474" class="Symbol">_</a> <a id="3476" class="Symbol">=</a> <a id="3478" href="MLTT.Maybe.html#174" class="InductiveConstructor">Just</a> <a id="3483" class="Bound">p</a>
<a id="3485" class="Symbol">...</a>                        <a id="3512" class="Symbol">|</a> <a id="3514" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="3518" class="Symbol">_</a> <a id="3520" class="Symbol">=</a> <a id="3522" class="Bound">A</a> <a id="3524" class="Bound">g&#39;</a>

<a id="3528" class="Markup">\end{code}</a><a id="3538" class="Background">

Update a board by playing a move:

</a><a id="3575" class="Markup">\begin{code}</a>

<a id="play"></a><a id="3589" href="GamesExperimental.TicTacToe0.html#3589" class="Function">play</a> <a id="3594" class="Symbol">:</a> <a id="3596" class="Symbol">(</a><a id="3597" href="GamesExperimental.TicTacToe0.html#3597" class="Bound">b</a> <a id="3599" class="Symbol">:</a> <a id="3601" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a><a id="3606" class="Symbol">)</a> <a id="3608" class="Symbol">→</a> <a id="3610" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="3615" href="GamesExperimental.TicTacToe0.html#3597" class="Bound">b</a> <a id="3617" class="Symbol">→</a> <a id="3619" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a>
<a id="3625" href="GamesExperimental.TicTacToe0.html#3589" class="Function">play</a> <a id="3630" class="Symbol">(</a><a id="3631" href="GamesExperimental.TicTacToe0.html#3631" class="Bound">p</a> <a id="3633" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="3635" href="GamesExperimental.TicTacToe0.html#3635" class="Bound">A</a><a id="3636" class="Symbol">)</a> <a id="3638" href="GamesExperimental.TicTacToe0.html#3638" class="Bound">m</a> <a id="3640" class="Symbol">=</a> <a id="3642" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="3651" href="GamesExperimental.TicTacToe0.html#3631" class="Bound">p</a> <a id="3653" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="3655" href="GamesExperimental.TicTacToe0.html#3331" class="Function">update</a> <a id="3662" href="GamesExperimental.TicTacToe0.html#3631" class="Bound">p</a> <a id="3664" href="GamesExperimental.TicTacToe0.html#3635" class="Bound">A</a> <a id="3666" href="GamesExperimental.TicTacToe0.html#3638" class="Bound">m</a>

<a id="3669" class="Markup">\end{code}</a><a id="3679" class="Background">

The game tree, with a bound on which we perform induction:

</a><a id="3741" class="Markup">\begin{code}</a>

<a id="tree"></a><a id="3755" href="GamesExperimental.TicTacToe0.html#3755" class="Function">tree</a> <a id="3760" class="Symbol">:</a> <a id="3762" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a> <a id="3768" class="Symbol">→</a> <a id="3770" href="MLTT.Natural-Numbers-Type.html#96" class="Datatype">ℕ</a> <a id="3772" class="Symbol">→</a> <a id="3774" href="GamesExperimental.TypeTrees.html#787" class="Datatype">𝑻</a>
<a id="3776" href="GamesExperimental.TicTacToe0.html#3755" class="Function">tree</a> <a id="3781" href="GamesExperimental.TicTacToe0.html#3781" class="Bound">b</a>         <a id="3791" class="Number">0</a>        <a id="3800" class="Symbol">=</a> <a id="3802" href="GamesExperimental.TypeTrees.html#805" class="InductiveConstructor">[]</a>
<a id="3805" href="GamesExperimental.TicTacToe0.html#3755" class="Function">tree</a> <a id="3810" href="GamesExperimental.TicTacToe0.html#3810" class="Bound">b</a><a id="3811" class="Symbol">@(</a><a id="3813" href="GamesExperimental.TicTacToe0.html#3813" class="Bound">p</a> <a id="3815" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="3817" href="GamesExperimental.TicTacToe0.html#3817" class="Bound">A</a><a id="3818" class="Symbol">)</a> <a id="3820" class="Symbol">(</a><a id="3821" href="MLTT.Natural-Numbers-Type.html#123" class="InductiveConstructor">succ</a> <a id="3826" href="GamesExperimental.TicTacToe0.html#3826" class="Bound">k</a><a id="3827" class="Symbol">)</a> <a id="3829" class="Keyword">with</a> <a id="3834" href="GamesExperimental.TicTacToe0.html#1482" class="Function">wins</a> <a id="3839" class="Symbol">(</a><a id="3840" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="3849" href="GamesExperimental.TicTacToe0.html#3813" class="Bound">p</a><a id="3850" class="Symbol">)</a> <a id="3852" href="GamesExperimental.TicTacToe0.html#3817" class="Bound">A</a> <a id="3854" class="Symbol">|</a> <a id="3856" href="GamesExperimental.TicTacToe0.html#2803" class="Function">Move-decidable</a> <a id="3871" href="GamesExperimental.TicTacToe0.html#3810" class="Bound">b</a>
<a id="3873" class="Symbol">...</a>                        <a id="3900" class="Symbol">|</a> <a id="3902" href="MLTT.Bool.html#128" class="InductiveConstructor">true</a>  <a id="3908" class="Symbol">|</a> <a id="3910" class="Symbol">_</a>     <a id="3916" class="Symbol">=</a> <a id="3918" href="GamesExperimental.TypeTrees.html#805" class="InductiveConstructor">[]</a>
<a id="3921" class="Symbol">...</a>                        <a id="3948" class="Symbol">|</a> <a id="3950" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a> <a id="3956" class="Symbol">|</a> <a id="3958" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="3962" class="Symbol">_</a> <a id="3964" class="Symbol">=</a> <a id="3966" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="3971" class="Bound">b</a> <a id="3973" href="GamesExperimental.TypeTrees.html#815" class="InductiveConstructor Operator">∷</a> <a id="3975" class="Symbol">(λ</a> <a id="3978" class="Symbol">(</a><a id="3979" href="GamesExperimental.TicTacToe0.html#3979" class="Bound">m</a> <a id="3981" class="Symbol">:</a> <a id="3983" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="3988" class="Bound">b</a><a id="3989" class="Symbol">)</a> <a id="3991" class="Symbol">→</a> <a id="3993" href="GamesExperimental.TicTacToe0.html#3755" class="Function">tree</a> <a id="3998" class="Symbol">(</a><a id="3999" href="GamesExperimental.TicTacToe0.html#3589" class="Function">play</a> <a id="4004" class="Bound">b</a> <a id="4006" href="GamesExperimental.TicTacToe0.html#3979" class="Bound">m</a><a id="4007" class="Symbol">)</a> <a id="4009" class="Bound">k</a><a id="4010" class="Symbol">)</a>
<a id="4012" class="Symbol">...</a>                        <a id="4039" class="Symbol">|</a> <a id="4041" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a> <a id="4047" class="Symbol">|</a> <a id="4049" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="4053" class="Symbol">_</a> <a id="4055" class="Symbol">=</a> <a id="4057" href="GamesExperimental.TypeTrees.html#805" class="InductiveConstructor">[]</a>

<a id="4061" class="Markup">\end{code}</a><a id="4071" class="Background">

The outcome function:

</a><a id="4096" class="Markup">\begin{code}</a>

<a id="outcome"></a><a id="4110" href="GamesExperimental.TicTacToe0.html#4110" class="Function">outcome</a> <a id="4118" class="Symbol">:</a> <a id="4120" class="Symbol">(</a><a id="4121" href="GamesExperimental.TicTacToe0.html#4121" class="Bound">b</a> <a id="4123" class="Symbol">:</a> <a id="4125" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a><a id="4130" class="Symbol">)</a> <a id="4132" class="Symbol">(</a><a id="4133" href="GamesExperimental.TicTacToe0.html#4133" class="Bound">k</a> <a id="4135" class="Symbol">:</a> <a id="4137" href="MLTT.Natural-Numbers-Type.html#96" class="Datatype">ℕ</a><a id="4138" class="Symbol">)</a> <a id="4140" class="Symbol">→</a> <a id="4142" href="GamesExperimental.TypeTrees.html#975" class="Function">Path</a> <a id="4147" class="Symbol">(</a><a id="4148" href="GamesExperimental.TicTacToe0.html#3755" class="Function">tree</a> <a id="4153" href="GamesExperimental.TicTacToe0.html#4121" class="Bound">b</a> <a id="4155" href="GamesExperimental.TicTacToe0.html#4133" class="Bound">k</a><a id="4156" class="Symbol">)</a> <a id="4158" class="Symbol">→</a> <a id="4160" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a>
<a id="4162" href="GamesExperimental.TicTacToe0.html#4110" class="Function">outcome</a> <a id="4170" href="GamesExperimental.TicTacToe0.html#4170" class="Bound">b</a> <a id="4172" class="Number">0</a> <a id="4174" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a> <a id="4177" class="Symbol">=</a> <a id="4179" href="GamesExperimental.TicTacToe0.html#856" class="Function">draw</a>
<a id="4184" href="GamesExperimental.TicTacToe0.html#4110" class="Function">outcome</a> <a id="4192" href="GamesExperimental.TicTacToe0.html#4192" class="Bound">b</a><a id="4193" class="Symbol">@(</a><a id="4195" href="GamesExperimental.TicTacToe0.html#4195" class="Bound">p</a> <a id="4197" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="4199" href="GamesExperimental.TicTacToe0.html#4199" class="Bound">A</a><a id="4200" class="Symbol">)</a> <a id="4202" class="Symbol">(</a><a id="4203" href="MLTT.Natural-Numbers-Type.html#123" class="InductiveConstructor">succ</a> <a id="4208" href="GamesExperimental.TicTacToe0.html#4208" class="Bound">k</a><a id="4209" class="Symbol">)</a> <a id="4211" href="GamesExperimental.TicTacToe0.html#4211" class="Bound">ms</a> <a id="4214" class="Keyword">with</a> <a id="4219" href="GamesExperimental.TicTacToe0.html#1482" class="Function">wins</a> <a id="4224" class="Symbol">(</a><a id="4225" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="4234" href="GamesExperimental.TicTacToe0.html#4195" class="Bound">p</a><a id="4235" class="Symbol">)</a> <a id="4237" href="GamesExperimental.TicTacToe0.html#4199" class="Bound">A</a> <a id="4239" class="Symbol">|</a> <a id="4241" href="GamesExperimental.TicTacToe0.html#2803" class="Function">Move-decidable</a> <a id="4256" href="GamesExperimental.TicTacToe0.html#4192" class="Bound">b</a>
<a id="4258" href="GamesExperimental.TicTacToe0.html#4110" class="Function">outcome</a> <a id="4266" href="GamesExperimental.TicTacToe0.html#4266" class="Bound">b</a><a id="4267" class="Symbol">@(</a><a id="4269" href="GamesExperimental.TicTacToe0.html#4269" class="Bound">p</a> <a id="4271" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="4273" href="GamesExperimental.TicTacToe0.html#4273" class="Bound">A</a><a id="4274" class="Symbol">)</a> <a id="4276" class="Symbol">(</a><a id="4277" href="MLTT.Natural-Numbers-Type.html#123" class="InductiveConstructor">succ</a> <a id="4282" href="GamesExperimental.TicTacToe0.html#4282" class="Bound">k</a><a id="4283" class="Symbol">)</a> <a id="4285" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a>        <a id="4295" class="Symbol">|</a> <a id="4297" href="MLTT.Bool.html#128" class="InductiveConstructor">true</a>  <a id="4303" class="Symbol">|</a> <a id="4305" class="Symbol">_</a>     <a id="4311" class="Symbol">=</a> <a id="4313" href="GamesExperimental.TicTacToe0.html#1146" class="Function">value</a> <a id="4319" class="Symbol">(</a><a id="4320" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="4329" href="GamesExperimental.TicTacToe0.html#4269" class="Bound">p</a><a id="4330" class="Symbol">)</a>
<a id="4332" href="GamesExperimental.TicTacToe0.html#4110" class="Function">outcome</a> <a id="4340" href="GamesExperimental.TicTacToe0.html#4340" class="Bound">b</a><a id="4341" class="Symbol">@(</a><a id="4343" href="GamesExperimental.TicTacToe0.html#4343" class="Bound">p</a> <a id="4345" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="4347" href="GamesExperimental.TicTacToe0.html#4347" class="Bound">A</a><a id="4348" class="Symbol">)</a> <a id="4350" class="Symbol">(</a><a id="4351" href="MLTT.Natural-Numbers-Type.html#123" class="InductiveConstructor">succ</a> <a id="4356" href="GamesExperimental.TicTacToe0.html#4356" class="Bound">k</a><a id="4357" class="Symbol">)</a> <a id="4359" class="Symbol">(</a><a id="4360" href="GamesExperimental.TicTacToe0.html#4360" class="Bound">m</a> <a id="4362" href="GamesExperimental.TypeTrees.html#1364" class="InductiveConstructor Operator">::</a> <a id="4365" href="GamesExperimental.TicTacToe0.html#4365" class="Bound">ms</a><a id="4367" class="Symbol">)</a> <a id="4369" class="Symbol">|</a> <a id="4371" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a> <a id="4377" class="Symbol">|</a> <a id="4379" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="4383" class="Symbol">_</a> <a id="4385" class="Symbol">=</a> <a id="4387" href="GamesExperimental.TicTacToe0.html#4110" class="Function">outcome</a> <a id="4395" class="Symbol">(</a><a id="4396" href="GamesExperimental.TicTacToe0.html#3589" class="Function">play</a> <a id="4401" href="GamesExperimental.TicTacToe0.html#4340" class="Bound">b</a> <a id="4403" href="GamesExperimental.TicTacToe0.html#4360" class="Bound">m</a><a id="4404" class="Symbol">)</a> <a id="4406" href="GamesExperimental.TicTacToe0.html#4356" class="Bound">k</a> <a id="4408" href="GamesExperimental.TicTacToe0.html#4365" class="Bound">ms</a>
<a id="4411" href="GamesExperimental.TicTacToe0.html#4110" class="Function">outcome</a> <a id="4419" href="GamesExperimental.TicTacToe0.html#4419" class="Bound">b</a><a id="4420" class="Symbol">@(</a><a id="4422" href="GamesExperimental.TicTacToe0.html#4422" class="Bound">p</a> <a id="4424" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="4426" href="GamesExperimental.TicTacToe0.html#4426" class="Bound">A</a><a id="4427" class="Symbol">)</a> <a id="4429" class="Symbol">(</a><a id="4430" href="MLTT.Natural-Numbers-Type.html#123" class="InductiveConstructor">succ</a> <a id="4435" href="GamesExperimental.TicTacToe0.html#4435" class="Bound">k</a><a id="4436" class="Symbol">)</a> <a id="4438" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a>        <a id="4448" class="Symbol">|</a> <a id="4450" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a> <a id="4456" class="Symbol">|</a> <a id="4458" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="4462" class="Symbol">_</a> <a id="4464" class="Symbol">=</a> <a id="4466" href="GamesExperimental.TicTacToe0.html#856" class="Function">draw</a>

<a id="4472" class="Markup">\end{code}</a><a id="4482" class="Background">

Selection functions for players, namely argmin for X and argmax for O:

</a><a id="4556" class="Markup">\begin{code}</a>

<a id="4570" class="Keyword">open</a> <a id="4575" href="GamesExperimental.J.html#2214" class="Module">J-definitions</a> <a id="4589" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a>

<a id="selection"></a><a id="4592" href="GamesExperimental.TicTacToe0.html#4592" class="Function">selection</a> <a id="4602" class="Symbol">:</a> <a id="4604" class="Symbol">(</a><a id="4605" href="GamesExperimental.TicTacToe0.html#4605" class="Bound">p</a> <a id="4607" class="Symbol">:</a> <a id="4609" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a><a id="4615" class="Symbol">)</a> <a id="4617" class="Symbol">{</a><a id="4618" href="GamesExperimental.TicTacToe0.html#4618" class="Bound">M</a> <a id="4620" class="Symbol">:</a> <a id="4622" href="MLTT.Universes.html#3833" class="Generalizable">𝓤</a> <a id="4624" href="MLTT.Universes.html#3976" class="Function Operator">̇</a> <a id="4626" class="Symbol">}</a> <a id="4628" class="Symbol">→</a> <a id="4630" href="GamesExperimental.TicTacToe0.html#4618" class="Bound">M</a> <a id="4632" class="Symbol">→</a> <a id="4634" href="TypeTopology.CompactTypes.html#20967" class="Function">is-Compact</a> <a id="4645" href="GamesExperimental.TicTacToe0.html#4618" class="Bound">M</a> <a id="4647" class="Symbol">{</a><a id="4648" href="Agda.Primitive.html#915" class="Primitive">𝓤₀</a><a id="4650" class="Symbol">}</a> <a id="4652" class="Symbol">→</a> <a id="4654" href="GamesExperimental.J.html#2248" class="Function">J</a> <a id="4656" href="GamesExperimental.TicTacToe0.html#4618" class="Bound">M</a>
<a id="4658" href="GamesExperimental.TicTacToe0.html#4592" class="Function">selection</a> <a id="4668" href="GamesExperimental.TicTacToe0.html#1074" class="InductiveConstructor">X</a> <a id="4670" href="GamesExperimental.TicTacToe0.html#4670" class="Bound">m</a> <a id="4672" href="GamesExperimental.TicTacToe0.html#4672" class="Bound">κ</a> <a id="4674" href="GamesExperimental.TicTacToe0.html#4674" class="Bound">p</a> <a id="4676" class="Symbol">=</a> <a id="4678" href="MLTT.Sigma-Type.html#198" class="Field">pr₁</a> <a id="4682" class="Symbol">(</a><a id="4683" href="Fin.ArgMinMax.html#3194" class="Function">compact-argmin</a> <a id="4698" href="GamesExperimental.TicTacToe0.html#4674" class="Bound">p</a> <a id="4700" href="GamesExperimental.TicTacToe0.html#4672" class="Bound">κ</a> <a id="4702" href="GamesExperimental.TicTacToe0.html#4670" class="Bound">m</a><a id="4703" class="Symbol">)</a>
<a id="4705" href="GamesExperimental.TicTacToe0.html#4592" class="Function">selection</a> <a id="4715" href="GamesExperimental.TicTacToe0.html#1076" class="InductiveConstructor">O</a> <a id="4717" href="GamesExperimental.TicTacToe0.html#4717" class="Bound">m</a> <a id="4719" href="GamesExperimental.TicTacToe0.html#4719" class="Bound">κ</a> <a id="4721" href="GamesExperimental.TicTacToe0.html#4721" class="Bound">p</a> <a id="4723" class="Symbol">=</a> <a id="4725" href="MLTT.Sigma-Type.html#198" class="Field">pr₁</a> <a id="4729" class="Symbol">(</a><a id="4730" href="Fin.ArgMinMax.html#2628" class="Function">compact-argmax</a> <a id="4745" href="GamesExperimental.TicTacToe0.html#4721" class="Bound">p</a> <a id="4747" href="GamesExperimental.TicTacToe0.html#4719" class="Bound">κ</a> <a id="4749" href="GamesExperimental.TicTacToe0.html#4717" class="Bound">m</a><a id="4750" class="Symbol">)</a>

<a id="4753" class="Markup">\end{code}</a><a id="4763" class="Background">

And their derived quantifiers:

</a><a id="4797" class="Markup">\begin{code}</a>

<a id="4811" class="Keyword">open</a> <a id="4816" href="GamesExperimental.K.html#541" class="Module">K-definitions</a> <a id="4830" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a>
<a id="4832" class="Keyword">open</a> <a id="4837" href="GamesExperimental.JK.html#285" class="Module">JK</a> <a id="4840" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a>

<a id="quantifier"></a><a id="4843" href="GamesExperimental.TicTacToe0.html#4843" class="Function">quantifier</a> <a id="4854" class="Symbol">:</a> <a id="4856" href="GamesExperimental.TicTacToe0.html#1053" class="Datatype">Player</a> <a id="4863" class="Symbol">→</a> <a id="4865" class="Symbol">{</a><a id="4866" href="GamesExperimental.TicTacToe0.html#4866" class="Bound">M</a> <a id="4868" class="Symbol">:</a> <a id="4870" href="MLTT.Universes.html#3833" class="Generalizable">𝓤</a> <a id="4872" href="MLTT.Universes.html#3976" class="Function Operator">̇</a> <a id="4874" class="Symbol">}</a> <a id="4876" class="Symbol">→</a> <a id="4878" href="TypeTopology.CompactTypes.html#20967" class="Function">is-Compact</a> <a id="4889" href="GamesExperimental.TicTacToe0.html#4866" class="Bound">M</a> <a id="4891" class="Symbol">→</a> <a id="4893" href="MLTT.Negation.html#584" class="Function">is-decidable</a> <a id="4906" href="GamesExperimental.TicTacToe0.html#4866" class="Bound">M</a> <a id="4908" class="Symbol">→</a> <a id="4910" href="GamesExperimental.K.html#575" class="Function">K</a> <a id="4912" href="GamesExperimental.TicTacToe0.html#4866" class="Bound">M</a>
<a id="4914" href="GamesExperimental.TicTacToe0.html#4843" class="Function">quantifier</a> <a id="4925" href="GamesExperimental.TicTacToe0.html#4925" class="Bound">p</a> <a id="4927" href="GamesExperimental.TicTacToe0.html#4927" class="Bound">κ</a> <a id="4929" class="Symbol">(</a><a id="4930" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="4934" href="GamesExperimental.TicTacToe0.html#4934" class="Bound">m</a><a id="4935" class="Symbol">)</a> <a id="4937" class="Symbol">=</a> <a id="4939" href="GamesExperimental.JK.html#353" class="Function">overline</a> <a id="4948" class="Symbol">(</a><a id="4949" href="GamesExperimental.TicTacToe0.html#4592" class="Function">selection</a> <a id="4959" href="GamesExperimental.TicTacToe0.html#4925" class="Bound">p</a> <a id="4961" href="GamesExperimental.TicTacToe0.html#4934" class="Bound">m</a> <a id="4963" href="GamesExperimental.TicTacToe0.html#4927" class="Bound">κ</a><a id="4964" class="Symbol">)</a>
<a id="4966" href="GamesExperimental.TicTacToe0.html#4843" class="Function">quantifier</a> <a id="4977" href="GamesExperimental.TicTacToe0.html#4977" class="Bound">p</a> <a id="4979" href="GamesExperimental.TicTacToe0.html#4979" class="Bound">κ</a> <a id="4981" class="Symbol">(</a><a id="4982" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="4986" class="Symbol">_)</a> <a id="4989" class="Symbol">=</a> <a id="4991" class="Symbol">λ</a> <a id="4993" href="GamesExperimental.TicTacToe0.html#4993" class="Bound">_</a> <a id="4995" class="Symbol">→</a> <a id="4997" href="GamesExperimental.TicTacToe0.html#856" class="Function">draw</a>

<a id="5003" class="Markup">\end{code}</a><a id="5013" class="Background">

The quantifier tree for the game:

</a><a id="5050" class="Markup">\begin{code}</a>

<a id="quantifiers"></a><a id="5064" href="GamesExperimental.TicTacToe0.html#5064" class="Function">quantifiers</a> <a id="5076" class="Symbol">:</a> <a id="5078" class="Symbol">(</a><a id="5079" href="GamesExperimental.TicTacToe0.html#5079" class="Bound">b</a> <a id="5081" class="Symbol">:</a> <a id="5083" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a><a id="5088" class="Symbol">)</a> <a id="5090" class="Symbol">(</a><a id="5091" href="GamesExperimental.TicTacToe0.html#5091" class="Bound">k</a> <a id="5093" class="Symbol">:</a> <a id="5095" href="MLTT.Natural-Numbers-Type.html#96" class="Datatype">ℕ</a><a id="5096" class="Symbol">)</a> <a id="5098" class="Symbol">→</a> <a id="5100" href="GamesExperimental.FiniteHistoryDependent.html#2471" class="Function">𝓚</a> <a id="5102" class="Symbol">(</a><a id="5103" href="GamesExperimental.TicTacToe0.html#3755" class="Function">tree</a> <a id="5108" href="GamesExperimental.TicTacToe0.html#5079" class="Bound">b</a> <a id="5110" href="GamesExperimental.TicTacToe0.html#5091" class="Bound">k</a><a id="5111" class="Symbol">)</a>
<a id="5113" href="GamesExperimental.TicTacToe0.html#5064" class="Function">quantifiers</a> <a id="5125" href="GamesExperimental.TicTacToe0.html#5125" class="Bound">b</a> <a id="5127" class="Number">0</a> <a id="5129" class="Symbol">=</a> <a id="5131" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a>
<a id="5134" href="GamesExperimental.TicTacToe0.html#5064" class="Function">quantifiers</a> <a id="5146" href="GamesExperimental.TicTacToe0.html#5146" class="Bound">b</a><a id="5147" class="Symbol">@(</a><a id="5149" href="GamesExperimental.TicTacToe0.html#5149" class="Bound">p</a> <a id="5151" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="5153" href="GamesExperimental.TicTacToe0.html#5153" class="Bound">A</a><a id="5154" class="Symbol">)</a> <a id="5156" class="Symbol">(</a><a id="5157" href="MLTT.Natural-Numbers-Type.html#123" class="InductiveConstructor">succ</a> <a id="5162" href="GamesExperimental.TicTacToe0.html#5162" class="Bound">k</a><a id="5163" class="Symbol">)</a> <a id="5165" class="Keyword">with</a> <a id="5170" href="GamesExperimental.TicTacToe0.html#1482" class="Function">wins</a> <a id="5175" class="Symbol">(</a><a id="5176" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="5185" href="GamesExperimental.TicTacToe0.html#5149" class="Bound">p</a><a id="5186" class="Symbol">)</a> <a id="5188" href="GamesExperimental.TicTacToe0.html#5153" class="Bound">A</a> <a id="5190" class="Symbol">|</a> <a id="5192" href="GamesExperimental.TicTacToe0.html#2803" class="Function">Move-decidable</a> <a id="5207" href="GamesExperimental.TicTacToe0.html#5146" class="Bound">b</a>
<a id="5209" class="Symbol">...</a> <a id="5213" class="Symbol">|</a> <a id="5215" href="MLTT.Bool.html#128" class="InductiveConstructor">true</a>  <a id="5221" class="Symbol">|</a> <a id="5223" class="Symbol">_</a>     <a id="5229" class="Symbol">=</a> <a id="5231" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a>
<a id="5234" class="Symbol">...</a> <a id="5238" class="Symbol">|</a> <a id="5240" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a> <a id="5246" class="Symbol">|</a> <a id="5248" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="5252" class="Symbol">_</a> <a id="5254" class="Symbol">=</a> <a id="5256" href="GamesExperimental.TicTacToe0.html#4843" class="Function">quantifier</a> <a id="5267" class="Bound">p</a> <a id="5269" class="Symbol">(</a><a id="5270" href="GamesExperimental.TicTacToe0.html#3004" class="Function">Move-compact</a> <a id="5283" class="Bound">b</a><a id="5284" class="Symbol">)</a> <a id="5286" class="Symbol">(</a><a id="5287" href="GamesExperimental.TicTacToe0.html#2803" class="Function">Move-decidable</a> <a id="5302" class="Bound">b</a><a id="5303" class="Symbol">)</a>
                      <a id="5327" href="GamesExperimental.TypeTrees.html#1364" class="InductiveConstructor Operator">::</a> <a id="5330" class="Symbol">(λ</a> <a id="5333" class="Symbol">(</a><a id="5334" href="GamesExperimental.TicTacToe0.html#5334" class="Bound">m</a> <a id="5336" class="Symbol">:</a> <a id="5338" href="GamesExperimental.TicTacToe0.html#2310" class="Function">Move</a> <a id="5343" class="Bound">b</a><a id="5344" class="Symbol">)</a> <a id="5346" class="Symbol">→</a> <a id="5348" href="GamesExperimental.TicTacToe0.html#5064" class="Function">quantifiers</a> <a id="5360" class="Symbol">(</a><a id="5361" href="GamesExperimental.TicTacToe0.html#3589" class="Function">play</a> <a id="5366" class="Bound">b</a> <a id="5368" href="GamesExperimental.TicTacToe0.html#5334" class="Bound">m</a><a id="5369" class="Symbol">)</a> <a id="5371" class="Bound">k</a><a id="5372" class="Symbol">)</a>
<a id="5374" class="Symbol">...</a> <a id="5378" class="Symbol">|</a> <a id="5380" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a> <a id="5386" class="Symbol">|</a> <a id="5388" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="5392" class="Symbol">_</a> <a id="5394" class="Symbol">=</a> <a id="5396" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a>
<a id="5399" class="Markup">\end{code}</a><a id="5409" class="Background">

And finally the game by putting the above together:

</a><a id="5464" class="Markup">\begin{code}</a>

<a id="tic-tac-toe"></a><a id="5478" href="GamesExperimental.TicTacToe0.html#5478" class="Function">tic-tac-toe</a> <a id="5490" class="Symbol">:</a> <a id="5492" href="GamesExperimental.FiniteHistoryDependent.html#3243" class="Record">Game</a>
<a id="5497" href="GamesExperimental.TicTacToe0.html#5478" class="Function">tic-tac-toe</a> <a id="5509" class="Symbol">=</a> <a id="5511" href="GamesExperimental.FiniteHistoryDependent.html#3280" class="InductiveConstructor">game</a> <a id="5516" class="Symbol">(</a><a id="5517" href="GamesExperimental.TicTacToe0.html#3755" class="Function">tree</a> <a id="5522" href="GamesExperimental.TicTacToe0.html#1353" class="Function">board₀</a> <a id="5529" class="Number">9</a><a id="5530" class="Symbol">)</a> <a id="5532" class="Symbol">(</a><a id="5533" href="GamesExperimental.TicTacToe0.html#4110" class="Function">outcome</a> <a id="5541" href="GamesExperimental.TicTacToe0.html#1353" class="Function">board₀</a> <a id="5548" class="Number">9</a><a id="5549" class="Symbol">)</a> <a id="5551" class="Symbol">(</a><a id="5552" href="GamesExperimental.TicTacToe0.html#5064" class="Function">quantifiers</a> <a id="5564" href="GamesExperimental.TicTacToe0.html#1353" class="Function">board₀</a> <a id="5571" class="Number">9</a><a id="5572" class="Symbol">)</a>

<a id="r"></a><a id="5575" href="GamesExperimental.TicTacToe0.html#5575" class="Function">r</a> <a id="5577" class="Symbol">:</a> <a id="5579" href="GamesExperimental.TicTacToe0.html#674" class="Function">R</a>
<a id="5581" href="GamesExperimental.TicTacToe0.html#5575" class="Function">r</a> <a id="5583" class="Symbol">=</a> <a id="5585" href="GamesExperimental.FiniteHistoryDependent.html#3604" class="Function">optimal-outcome</a> <a id="5601" href="GamesExperimental.TicTacToe0.html#5478" class="Function">tic-tac-toe</a>

<a id="5614" class="Markup">\end{code}</a><a id="5624" class="Background">

The above computation takes too long, due to the use of brute-force
search in the definition of the game (the compactness conditions). A
more efficient one is in another file.

</a><a id="5803" class="Markup">\begin{code}</a>

<a id="selections"></a><a id="5817" href="GamesExperimental.TicTacToe0.html#5817" class="Function">selections</a> <a id="5828" class="Symbol">:</a> <a id="5830" class="Symbol">(</a><a id="5831" href="GamesExperimental.TicTacToe0.html#5831" class="Bound">b</a> <a id="5833" class="Symbol">:</a> <a id="5835" href="GamesExperimental.TicTacToe0.html#1327" class="Function">Board</a><a id="5840" class="Symbol">)</a> <a id="5842" class="Symbol">(</a><a id="5843" href="GamesExperimental.TicTacToe0.html#5843" class="Bound">k</a> <a id="5845" class="Symbol">:</a> <a id="5847" href="MLTT.Natural-Numbers-Type.html#96" class="Datatype">ℕ</a><a id="5848" class="Symbol">)</a> <a id="5850" class="Symbol">→</a> <a id="5852" href="GamesExperimental.FiniteHistoryDependent.html#8857" class="Function">𝓙</a> <a id="5854" class="Symbol">(</a><a id="5855" href="GamesExperimental.TicTacToe0.html#3755" class="Function">tree</a> <a id="5860" href="GamesExperimental.TicTacToe0.html#5831" class="Bound">b</a> <a id="5862" href="GamesExperimental.TicTacToe0.html#5843" class="Bound">k</a><a id="5863" class="Symbol">)</a>
<a id="5865" href="GamesExperimental.TicTacToe0.html#5817" class="Function">selections</a> <a id="5876" href="GamesExperimental.TicTacToe0.html#5876" class="Bound">b</a> <a id="5878" class="Number">0</a> <a id="5880" class="Symbol">=</a> <a id="5882" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a>
<a id="5885" href="GamesExperimental.TicTacToe0.html#5817" class="Function">selections</a> <a id="5896" href="GamesExperimental.TicTacToe0.html#5896" class="Bound">b</a><a id="5897" class="Symbol">@(</a><a id="5899" href="GamesExperimental.TicTacToe0.html#5899" class="Bound">p</a> <a id="5901" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="5903" href="GamesExperimental.TicTacToe0.html#5903" class="Bound">A</a><a id="5904" class="Symbol">)</a> <a id="5906" class="Symbol">(</a><a id="5907" href="MLTT.Natural-Numbers-Type.html#123" class="InductiveConstructor">succ</a> <a id="5912" href="GamesExperimental.TicTacToe0.html#5912" class="Bound">k</a><a id="5913" class="Symbol">)</a> <a id="5915" class="Keyword">with</a> <a id="5920" href="GamesExperimental.TicTacToe0.html#1482" class="Function">wins</a> <a id="5925" class="Symbol">(</a><a id="5926" href="GamesExperimental.TicTacToe0.html#1088" class="Function">opponent</a> <a id="5935" href="GamesExperimental.TicTacToe0.html#5899" class="Bound">p</a><a id="5936" class="Symbol">)</a> <a id="5938" href="GamesExperimental.TicTacToe0.html#5903" class="Bound">A</a> <a id="5940" class="Symbol">|</a> <a id="5942" href="GamesExperimental.TicTacToe0.html#2803" class="Function">Move-decidable</a> <a id="5957" href="GamesExperimental.TicTacToe0.html#5896" class="Bound">b</a>
<a id="5959" class="Symbol">...</a> <a id="5963" class="Symbol">|</a> <a id="5965" href="MLTT.Bool.html#128" class="InductiveConstructor">true</a>  <a id="5971" class="Symbol">|</a> <a id="5973" class="Symbol">_</a>      <a id="5980" class="Symbol">=</a> <a id="5982" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a>
<a id="5985" class="Symbol">...</a> <a id="5989" class="Symbol">|</a> <a id="5991" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a> <a id="5997" class="Symbol">|</a> <a id="5999" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="6003" href="GamesExperimental.TicTacToe0.html#6003" class="Bound">m₀</a> <a id="6006" class="Symbol">=</a> <a id="6008" href="GamesExperimental.TicTacToe0.html#4592" class="Function">selection</a> <a id="6018" class="Bound">p</a> <a id="6020" href="GamesExperimental.TicTacToe0.html#6003" class="Bound">m₀</a> <a id="6023" class="Symbol">(</a><a id="6024" href="GamesExperimental.TicTacToe0.html#3004" class="Function">Move-compact</a> <a id="6037" class="Bound">b</a><a id="6038" class="Symbol">)</a>
                      <a id="6062" href="GamesExperimental.TypeTrees.html#1364" class="InductiveConstructor Operator">::</a> <a id="6065" class="Symbol">(λ</a> <a id="6068" href="GamesExperimental.TicTacToe0.html#6068" class="Bound">m</a> <a id="6070" class="Symbol">→</a> <a id="6072" href="GamesExperimental.TicTacToe0.html#5817" class="Function">selections</a> <a id="6083" class="Symbol">(</a><a id="6084" href="GamesExperimental.TicTacToe0.html#3589" class="Function">play</a> <a id="6089" class="Bound">b</a> <a id="6091" href="GamesExperimental.TicTacToe0.html#6068" class="Bound">m</a><a id="6092" class="Symbol">)</a> <a id="6094" class="Bound">k</a><a id="6095" class="Symbol">)</a>
<a id="6097" class="Symbol">...</a> <a id="6101" class="Symbol">|</a> <a id="6103" href="MLTT.Bool.html#133" class="InductiveConstructor">false</a> <a id="6109" class="Symbol">|</a> <a id="6111" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="6115" class="Symbol">_</a>  <a id="6118" class="Symbol">=</a> <a id="6120" href="GamesExperimental.TypeTrees.html#1342" class="InductiveConstructor">⟨⟩</a>


<a id="p"></a><a id="6125" href="GamesExperimental.TicTacToe0.html#6125" class="Function">p</a> <a id="6127" class="Symbol">:</a> <a id="6129" href="GamesExperimental.TypeTrees.html#975" class="Function">Path</a> <a id="6134" class="Symbol">(</a><a id="6135" href="GamesExperimental.FiniteHistoryDependent.html#3294" class="Field">Xt</a> <a id="6138" href="GamesExperimental.TicTacToe0.html#5478" class="Function">tic-tac-toe</a><a id="6149" class="Symbol">)</a>
<a id="6151" href="GamesExperimental.TicTacToe0.html#6125" class="Function">p</a> <a id="6153" class="Symbol">=</a> <a id="6155" href="GamesExperimental.FiniteHistoryDependent.html#9380" class="Function">sequenceᴶ</a> <a id="6165" class="Symbol">(</a><a id="6166" href="GamesExperimental.TicTacToe0.html#5817" class="Function">selections</a> <a id="6177" href="GamesExperimental.TicTacToe0.html#1353" class="Function">board₀</a> <a id="6184" class="Number">9</a><a id="6185" class="Symbol">)</a> <a id="6187" class="Symbol">(</a><a id="6188" href="GamesExperimental.FiniteHistoryDependent.html#3303" class="Field">q</a> <a id="6190" href="GamesExperimental.TicTacToe0.html#5478" class="Function">tic-tac-toe</a><a id="6201" class="Symbol">)</a>

<a id="6204" class="Markup">\end{code}</a><a id="6214" class="Background">
</a></pre></body></html>