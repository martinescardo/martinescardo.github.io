<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>Games.OptimalPlays</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Background">Martin Escardo, Paulo Oliva, 27th November 2024 - 14th May 2025

We define optimal moves and optimal plays for sequential games. Then
using the JT monad, with T the monad Listâº of non-empty lists, we
compute all optimal plays of a game, provided it has ordinary
selection functions.

</a><a id="285" class="Markup">\begin{code}</a>

<a id="299" class="Symbol">{-#</a> <a id="303" class="Keyword">OPTIONS</a> <a id="311" class="Pragma">--safe</a> <a id="318" class="Pragma">--without-K</a> <a id="330" class="Symbol">#-}</a>

<a id="335" class="Keyword">open</a> <a id="340" class="Keyword">import</a> <a id="347" href="MLTT.Spartan.html" class="Module">MLTT.Spartan</a> <a id="360" class="Keyword">hiding</a> <a id="367" class="Symbol">(</a><a id="368" href="MLTT.Id.html#438" class="Function">J</a><a id="369" class="Symbol">)</a>
<a id="371" class="Keyword">open</a> <a id="376" class="Keyword">import</a> <a id="383" href="UF.FunExt.html" class="Module">UF.FunExt</a>
<a id="393" class="Keyword">open</a> <a id="398" class="Keyword">import</a> <a id="405" href="UF.DiscreteAndSeparated.html" class="Module">UF.DiscreteAndSeparated</a>

<a id="430" class="Markup">\end{code}</a><a id="440" class="Background">

We work with a type of outcomes R with decidable equality (called
discreteness).

</a><a id="524" class="Markup">\begin{code}</a>

<a id="538" class="Keyword">module</a> <a id="545" href="Games.OptimalPlays.html" class="Module">Games.OptimalPlays</a>
        <a id="572" class="Symbol">(</a><a id="573" href="Games.OptimalPlays.html#573" class="Bound">fe</a> <a id="576" class="Symbol">:</a> <a id="578" href="UF.FunExt.html#1047" class="Function">Fun-Ext</a><a id="585" class="Symbol">)</a>
        <a id="595" class="Symbol">(</a><a id="596" href="Games.OptimalPlays.html#596" class="Bound">R</a>  <a id="599" class="Symbol">:</a> <a id="601" href="Notation.General.html#372" class="Function">Type</a><a id="605" class="Symbol">)</a>
        <a id="615" class="Symbol">(</a><a id="616" href="Games.OptimalPlays.html#616" class="Bound">R-is-discrete</a> <a id="630" class="Symbol">:</a> <a id="632" href="UF.DiscreteAndSeparated.html#1853" class="Function">is-discrete</a> <a id="644" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="645" class="Symbol">)</a>
       <a id="654" class="Keyword">where</a>

<a id="661" class="Keyword">open</a> <a id="666" class="Keyword">import</a> <a id="673" href="Games.FiniteHistoryDependent.html" class="Module">Games.FiniteHistoryDependent</a> <a id="702" href="Games.OptimalPlays.html#596" class="Bound">R</a>
<a id="704" class="Keyword">open</a> <a id="709" class="Keyword">import</a> <a id="716" href="Games.TypeTrees.html" class="Module">Games.TypeTrees</a>
<a id="732" class="Keyword">open</a> <a id="737" class="Keyword">import</a> <a id="744" href="MLTT.List.html" class="Module">MLTT.List</a> <a id="754" class="Keyword">hiding</a> <a id="761" class="Symbol">(</a><a id="762" href="MLTT.List.html#1586" class="Function Operator">[_]</a><a id="765" class="Symbol">)</a> <a id="767" class="Keyword">renaming</a> <a id="776" class="Symbol">(</a><a id="777" href="MLTT.List.html#2285" class="Function">map</a> <a id="781" class="Symbol">to</a> <a id="784" class="Function">lmap</a><a id="788" class="Symbol">)</a>
<a id="790" class="Keyword">open</a> <a id="795" class="Keyword">import</a> <a id="802" href="MonadOnTypes.J-transf-variation.html" class="Module">MonadOnTypes.J-transf-variation</a>
<a id="834" class="Keyword">open</a> <a id="839" class="Keyword">import</a> <a id="846" href="MonadOnTypes.JK.html" class="Module">MonadOnTypes.JK</a>
<a id="862" class="Keyword">open</a> <a id="867" class="Keyword">import</a> <a id="874" href="MonadOnTypes.K.html" class="Module">MonadOnTypes.K</a>
<a id="889" class="Keyword">open</a> <a id="894" class="Keyword">import</a> <a id="901" href="MonadOnTypes.List.html" class="Module">MonadOnTypes.List</a>
<a id="919" class="Keyword">open</a> <a id="924" class="Keyword">import</a> <a id="931" href="MonadOnTypes.Monad.html" class="Module">MonadOnTypes.Monad</a>
<a id="950" class="Keyword">open</a> <a id="955" class="Keyword">import</a> <a id="962" href="MonadOnTypes.NonEmptyList.html" class="Module">MonadOnTypes.NonEmptyList</a>
<a id="988" class="Keyword">open</a> <a id="993" class="Keyword">import</a> <a id="1000" href="Notation.CanonicalMap.html" class="Module">Notation.CanonicalMap</a>
<a id="1022" class="Keyword">open</a> <a id="1027" class="Keyword">import</a> <a id="1034" href="UF.Base.html" class="Module">UF.Base</a>
<a id="1042" class="Keyword">open</a> <a id="1047" class="Keyword">import</a> <a id="1054" href="UF.Subsingletons.html" class="Module">UF.Subsingletons</a>

<a id="1072" class="Keyword">open</a> <a id="1077" href="MonadOnTypes.K.html#438" class="Module">K-definitions</a> <a id="1091" href="Games.OptimalPlays.html#596" class="Bound">R</a>

<a id="1094" class="Markup">\end{code}</a><a id="1104" class="Background">

The following are the main two notions considered in this file.

</a><a id="1171" class="Markup">\begin{code}</a>

<a id="is-optimal-move"></a><a id="1185" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="1201" class="Symbol">:</a> <a id="1203" class="Symbol">{</a><a id="1204" href="Games.OptimalPlays.html#1204" class="Bound">X</a> <a id="1206" class="Symbol">:</a> <a id="1208" href="Notation.General.html#372" class="Function">Type</a><a id="1212" class="Symbol">}</a>
                  <a id="1232" class="Symbol">{</a><a id="1233" href="Games.OptimalPlays.html#1233" class="Bound">Xf</a> <a id="1236" class="Symbol">:</a> <a id="1238" href="Games.OptimalPlays.html#1204" class="Bound">X</a> <a id="1240" class="Symbol">â†’</a> <a id="1242" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="1243" class="Symbol">}</a>
                  <a id="1263" class="Symbol">(</a><a id="1264" href="Games.OptimalPlays.html#1264" class="Bound">q</a> <a id="1266" class="Symbol">:</a> <a id="1268" class="Symbol">(</a><a id="1269" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="1271" href="Games.OptimalPlays.html#1271" class="Bound">x</a> <a id="1273" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="1275" href="Games.OptimalPlays.html#1204" class="Bound">X</a> <a id="1277" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="1279" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="1284" class="Symbol">(</a><a id="1285" href="Games.OptimalPlays.html#1233" class="Bound">Xf</a> <a id="1288" href="Games.OptimalPlays.html#1271" class="Bound">x</a><a id="1289" class="Symbol">))</a> <a id="1292" class="Symbol">â†’</a> <a id="1294" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="1295" class="Symbol">)</a>
                  <a id="1315" class="Symbol">(</a><a id="1316" href="Games.OptimalPlays.html#1316" class="Bound">Ï•</a> <a id="1318" class="Symbol">:</a> <a id="1320" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="1322" href="Games.OptimalPlays.html#1204" class="Bound">X</a><a id="1323" class="Symbol">)</a>
                  <a id="1343" class="Symbol">(</a><a id="1344" href="Games.OptimalPlays.html#1344" class="Bound">Ï•f</a> <a id="1347" class="Symbol">:</a> <a id="1349" class="Symbol">(</a><a id="1350" href="Games.OptimalPlays.html#1350" class="Bound">x</a> <a id="1352" class="Symbol">:</a> <a id="1354" href="Games.OptimalPlays.html#1204" class="Bound">X</a><a id="1355" class="Symbol">)</a> <a id="1357" class="Symbol">â†’</a> <a id="1359" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="1361" class="Symbol">(</a><a id="1362" href="Games.OptimalPlays.html#1233" class="Bound">Xf</a> <a id="1365" href="Games.OptimalPlays.html#1350" class="Bound">x</a><a id="1366" class="Symbol">))</a>
                <a id="1385" class="Symbol">â†’</a> <a id="1387" href="Games.OptimalPlays.html#1204" class="Bound">X</a>
                <a id="1405" class="Symbol">â†’</a> <a id="1407" href="Notation.General.html#372" class="Function">Type</a>
<a id="1412" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="1428" class="Symbol">{</a><a id="1429" href="Games.OptimalPlays.html#1429" class="Bound">X</a><a id="1430" class="Symbol">}</a> <a id="1432" class="Symbol">{</a><a id="1433" href="Games.OptimalPlays.html#1433" class="Bound">Xf</a><a id="1435" class="Symbol">}</a> <a id="1437" href="Games.OptimalPlays.html#1437" class="Bound">q</a> <a id="1439" href="Games.OptimalPlays.html#1439" class="Bound">Ï•</a> <a id="1441" href="Games.OptimalPlays.html#1441" class="Bound">Ï•f</a> <a id="1444" href="Games.OptimalPlays.html#1444" class="Bound">x</a> <a id="1446" class="Symbol">=</a>
 <a id="1449" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="1465" class="Symbol">(</a><a id="1466" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="1471" class="Symbol">(</a><a id="1472" href="Games.OptimalPlays.html#1429" class="Bound">X</a> <a id="1474" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="1476" href="Games.OptimalPlays.html#1433" class="Bound">Xf</a><a id="1478" class="Symbol">)</a> <a id="1480" href="Games.OptimalPlays.html#1437" class="Bound">q</a> <a id="1482" class="Symbol">(</a><a id="1483" href="Games.OptimalPlays.html#1439" class="Bound">Ï•</a> <a id="1485" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="1488" href="Games.OptimalPlays.html#1441" class="Bound">Ï•f</a><a id="1490" class="Symbol">))</a>
 <a id="1494" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="1496" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="1512" class="Symbol">(</a><a id="1513" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="1518" class="Symbol">(</a><a id="1519" href="Games.OptimalPlays.html#1433" class="Bound">Xf</a> <a id="1522" href="Games.OptimalPlays.html#1444" class="Bound">x</a><a id="1523" class="Symbol">)</a> <a id="1525" class="Symbol">(</a><a id="1526" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="1534" href="Games.OptimalPlays.html#1437" class="Bound">q</a> <a id="1536" href="Games.OptimalPlays.html#1444" class="Bound">x</a><a id="1537" class="Symbol">)</a> <a id="1539" class="Symbol">(</a><a id="1540" href="Games.OptimalPlays.html#1441" class="Bound">Ï•f</a> <a id="1543" href="Games.OptimalPlays.html#1444" class="Bound">x</a><a id="1544" class="Symbol">))</a>

<a id="is-optimal-play"></a><a id="1548" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="1564" class="Symbol">:</a> <a id="1566" class="Symbol">{</a><a id="1567" href="Games.OptimalPlays.html#1567" class="Bound">Xt</a> <a id="1570" class="Symbol">:</a> <a id="1572" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="1573" class="Symbol">}</a> <a id="1575" class="Symbol">â†’</a> <a id="1577" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="1579" href="Games.OptimalPlays.html#1567" class="Bound">Xt</a> <a id="1582" class="Symbol">â†’</a> <a id="1584" class="Symbol">(</a><a id="1585" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="1590" href="Games.OptimalPlays.html#1567" class="Bound">Xt</a> <a id="1593" class="Symbol">â†’</a> <a id="1595" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="1596" class="Symbol">)</a> <a id="1598" class="Symbol">â†’</a> <a id="1600" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="1605" href="Games.OptimalPlays.html#1567" class="Bound">Xt</a> <a id="1608" class="Symbol">â†’</a> <a id="1610" href="Notation.General.html#372" class="Function">Type</a>
<a id="1615" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="1631" class="Symbol">{</a><a id="1632" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a><a id="1634" class="Symbol">}</a>     <a id="1640" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>        <a id="1650" href="Games.OptimalPlays.html#1650" class="Bound">q</a> <a id="1652" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>        <a id="1662" class="Symbol">=</a> <a id="1664" href="MLTT.Unit.html#129" class="Record">ğŸ™</a>
<a id="1666" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="1682" class="Symbol">{</a><a id="1683" href="Games.OptimalPlays.html#1683" class="Bound">X</a> <a id="1685" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="1687" href="Games.OptimalPlays.html#1687" class="Bound">Xf</a><a id="1689" class="Symbol">}</a> <a id="1691" class="Symbol">(</a><a id="1692" href="Games.OptimalPlays.html#1692" class="Bound">Ï•</a> <a id="1694" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="1697" href="Games.OptimalPlays.html#1697" class="Bound">Ï•f</a><a id="1699" class="Symbol">)</a> <a id="1701" href="Games.OptimalPlays.html#1701" class="Bound">q</a> <a id="1703" class="Symbol">(</a><a id="1704" href="Games.OptimalPlays.html#1704" class="Bound">x</a> <a id="1706" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="1709" href="Games.OptimalPlays.html#1709" class="Bound">xs</a><a id="1711" class="Symbol">)</a> <a id="1713" class="Symbol">=</a>
   <a id="1718" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="1734" class="Symbol">{</a><a id="1735" href="Games.OptimalPlays.html#1683" class="Bound">X</a><a id="1736" class="Symbol">}</a> <a id="1738" class="Symbol">{</a><a id="1739" href="Games.OptimalPlays.html#1687" class="Bound">Xf</a><a id="1741" class="Symbol">}</a> <a id="1743" href="Games.OptimalPlays.html#1701" class="Bound">q</a> <a id="1745" href="Games.OptimalPlays.html#1692" class="Bound">Ï•</a> <a id="1747" href="Games.OptimalPlays.html#1697" class="Bound">Ï•f</a> <a id="1750" href="Games.OptimalPlays.html#1704" class="Bound">x</a>
 <a id="1753" href="MLTT.Sigma.html#558" class="Function Operator">Ã—</a> <a id="1755" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="1771" class="Symbol">{</a><a id="1772" href="Games.OptimalPlays.html#1687" class="Bound">Xf</a> <a id="1775" href="Games.OptimalPlays.html#1704" class="Bound">x</a><a id="1776" class="Symbol">}</a> <a id="1778" class="Symbol">(</a><a id="1779" href="Games.OptimalPlays.html#1697" class="Bound">Ï•f</a> <a id="1782" href="Games.OptimalPlays.html#1704" class="Bound">x</a><a id="1783" class="Symbol">)</a> <a id="1785" class="Symbol">(</a><a id="1786" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="1794" href="Games.OptimalPlays.html#1701" class="Bound">q</a> <a id="1796" href="Games.OptimalPlays.html#1704" class="Bound">x</a><a id="1797" class="Symbol">)</a> <a id="1799" href="Games.OptimalPlays.html#1709" class="Bound">xs</a>

<a id="1803" class="Markup">\end{code}</a><a id="1813" class="Background">

Being an optimal move is a decidable proposition.

</a><a id="1866" class="Markup">\begin{code}</a>

<a id="being-optimal-move-is-prop"></a><a id="1880" href="Games.OptimalPlays.html#1880" class="Function">being-optimal-move-is-prop</a> <a id="1907" class="Symbol">:</a> <a id="1909" class="Symbol">{</a><a id="1910" href="Games.OptimalPlays.html#1910" class="Bound">X</a> <a id="1912" class="Symbol">:</a> <a id="1914" href="Notation.General.html#372" class="Function">Type</a><a id="1918" class="Symbol">}</a>
                             <a id="1949" class="Symbol">{</a><a id="1950" href="Games.OptimalPlays.html#1950" class="Bound">Xf</a> <a id="1953" class="Symbol">:</a> <a id="1955" href="Games.OptimalPlays.html#1910" class="Bound">X</a> <a id="1957" class="Symbol">â†’</a> <a id="1959" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="1960" class="Symbol">}</a>
                             <a id="1991" class="Symbol">(</a><a id="1992" href="Games.OptimalPlays.html#1992" class="Bound">q</a> <a id="1994" class="Symbol">:</a> <a id="1996" class="Symbol">(</a><a id="1997" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="1999" href="Games.OptimalPlays.html#1999" class="Bound">x</a> <a id="2001" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="2003" href="Games.OptimalPlays.html#1910" class="Bound">X</a> <a id="2005" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="2007" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="2012" class="Symbol">(</a><a id="2013" href="Games.OptimalPlays.html#1950" class="Bound">Xf</a> <a id="2016" href="Games.OptimalPlays.html#1999" class="Bound">x</a><a id="2017" class="Symbol">))</a> <a id="2020" class="Symbol">â†’</a> <a id="2022" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="2023" class="Symbol">)</a>
                             <a id="2054" class="Symbol">(</a><a id="2055" href="Games.OptimalPlays.html#2055" class="Bound">Ï•</a> <a id="2057" class="Symbol">:</a> <a id="2059" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="2061" href="Games.OptimalPlays.html#1910" class="Bound">X</a><a id="2062" class="Symbol">)</a>
                             <a id="2093" class="Symbol">(</a><a id="2094" href="Games.OptimalPlays.html#2094" class="Bound">Ï•f</a> <a id="2097" class="Symbol">:</a> <a id="2099" class="Symbol">(</a><a id="2100" href="Games.OptimalPlays.html#2100" class="Bound">x</a> <a id="2102" class="Symbol">:</a> <a id="2104" href="Games.OptimalPlays.html#1910" class="Bound">X</a><a id="2105" class="Symbol">)</a> <a id="2107" class="Symbol">â†’</a> <a id="2109" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="2111" class="Symbol">(</a><a id="2112" href="Games.OptimalPlays.html#1950" class="Bound">Xf</a> <a id="2115" href="Games.OptimalPlays.html#2100" class="Bound">x</a><a id="2116" class="Symbol">))</a>
                             <a id="2148" class="Symbol">(</a><a id="2149" href="Games.OptimalPlays.html#2149" class="Bound">x</a> <a id="2151" class="Symbol">:</a> <a id="2153" href="Games.OptimalPlays.html#1910" class="Bound">X</a><a id="2154" class="Symbol">)</a>
                           <a id="2183" class="Symbol">â†’</a> <a id="2185" href="UF.Subsingletons.html#469" class="Function">is-prop</a> <a id="2193" class="Symbol">(</a><a id="2194" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="2210" href="Games.OptimalPlays.html#1992" class="Bound">q</a> <a id="2212" href="Games.OptimalPlays.html#2055" class="Bound">Ï•</a> <a id="2214" href="Games.OptimalPlays.html#2094" class="Bound">Ï•f</a> <a id="2217" href="Games.OptimalPlays.html#2149" class="Bound">x</a><a id="2218" class="Symbol">)</a>
<a id="2220" href="Games.OptimalPlays.html#1880" class="Function">being-optimal-move-is-prop</a> <a id="2247" href="Games.OptimalPlays.html#2247" class="Bound">q</a> <a id="2249" href="Games.OptimalPlays.html#2249" class="Bound">Ï•</a> <a id="2251" href="Games.OptimalPlays.html#2251" class="Bound">Ï•f</a> <a id="2254" href="Games.OptimalPlays.html#2254" class="Bound">x</a> <a id="2256" class="Symbol">=</a> <a id="2258" href="UF.DiscreteAndSeparated.html#16929" class="Function">discrete-types-are-sets</a> <a id="2282" href="Games.OptimalPlays.html#616" class="Bound">R-is-discrete</a>

<a id="being-optimal-move-is-decidable"></a><a id="2297" href="Games.OptimalPlays.html#2297" class="Function">being-optimal-move-is-decidable</a> <a id="2329" class="Symbol">:</a> <a id="2331" class="Symbol">{</a><a id="2332" href="Games.OptimalPlays.html#2332" class="Bound">X</a> <a id="2334" class="Symbol">:</a> <a id="2336" href="Notation.General.html#372" class="Function">Type</a><a id="2340" class="Symbol">}</a>
                                  <a id="2376" class="Symbol">{</a><a id="2377" href="Games.OptimalPlays.html#2377" class="Bound">Xf</a> <a id="2380" class="Symbol">:</a> <a id="2382" href="Games.OptimalPlays.html#2332" class="Bound">X</a> <a id="2384" class="Symbol">â†’</a> <a id="2386" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="2387" class="Symbol">}</a>
                                  <a id="2423" class="Symbol">(</a><a id="2424" href="Games.OptimalPlays.html#2424" class="Bound">q</a> <a id="2426" class="Symbol">:</a> <a id="2428" class="Symbol">(</a><a id="2429" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="2431" href="Games.OptimalPlays.html#2431" class="Bound">x</a> <a id="2433" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="2435" href="Games.OptimalPlays.html#2332" class="Bound">X</a> <a id="2437" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="2439" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="2444" class="Symbol">(</a><a id="2445" href="Games.OptimalPlays.html#2377" class="Bound">Xf</a> <a id="2448" href="Games.OptimalPlays.html#2431" class="Bound">x</a><a id="2449" class="Symbol">))</a> <a id="2452" class="Symbol">â†’</a> <a id="2454" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="2455" class="Symbol">)</a>
                                  <a id="2491" class="Symbol">(</a><a id="2492" href="Games.OptimalPlays.html#2492" class="Bound">Ï•</a> <a id="2494" class="Symbol">:</a> <a id="2496" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="2498" href="Games.OptimalPlays.html#2332" class="Bound">X</a><a id="2499" class="Symbol">)</a>
                                  <a id="2535" class="Symbol">(</a><a id="2536" href="Games.OptimalPlays.html#2536" class="Bound">Ï•f</a> <a id="2539" class="Symbol">:</a> <a id="2541" class="Symbol">(</a><a id="2542" href="Games.OptimalPlays.html#2542" class="Bound">x</a> <a id="2544" class="Symbol">:</a> <a id="2546" href="Games.OptimalPlays.html#2332" class="Bound">X</a><a id="2547" class="Symbol">)</a> <a id="2549" class="Symbol">â†’</a> <a id="2551" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="2553" class="Symbol">(</a><a id="2554" href="Games.OptimalPlays.html#2377" class="Bound">Xf</a> <a id="2557" href="Games.OptimalPlays.html#2542" class="Bound">x</a><a id="2558" class="Symbol">))</a>
                                  <a id="2595" class="Symbol">(</a><a id="2596" href="Games.OptimalPlays.html#2596" class="Bound">x</a> <a id="2598" class="Symbol">:</a> <a id="2600" href="Games.OptimalPlays.html#2332" class="Bound">X</a><a id="2601" class="Symbol">)</a>
                                <a id="2635" class="Symbol">â†’</a> <a id="2637" href="MLTT.Negation.html#584" class="Function">is-decidable</a> <a id="2650" class="Symbol">(</a><a id="2651" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="2667" href="Games.OptimalPlays.html#2424" class="Bound">q</a> <a id="2669" href="Games.OptimalPlays.html#2492" class="Bound">Ï•</a> <a id="2671" href="Games.OptimalPlays.html#2536" class="Bound">Ï•f</a> <a id="2674" href="Games.OptimalPlays.html#2596" class="Bound">x</a><a id="2675" class="Symbol">)</a>
<a id="2677" href="Games.OptimalPlays.html#2297" class="Function">being-optimal-move-is-decidable</a> <a id="2709" href="Games.OptimalPlays.html#2709" class="Bound">q</a> <a id="2711" href="Games.OptimalPlays.html#2711" class="Bound">Ï•</a> <a id="2713" href="Games.OptimalPlays.html#2713" class="Bound">Ï•f</a> <a id="2716" href="Games.OptimalPlays.html#2716" class="Bound">x</a> <a id="2718" class="Symbol">=</a> <a id="2720" href="Games.OptimalPlays.html#616" class="Bound">R-is-discrete</a> <a id="2734" class="Symbol">_</a> <a id="2736" class="Symbol">_</a>

<a id="2739" class="Markup">\end{code}</a><a id="2749" class="Background">



We now show that the strategic path of a strategy in subgame perfect
equilibrium is an optimal play. We start with a lemma that is
interesting on its own right.

</a><a id="2915" class="Markup">\begin{code}</a>

<a id="optimal-play-gives-optimal-outcome"></a><a id="2929" href="Games.OptimalPlays.html#2929" class="Function">optimal-play-gives-optimal-outcome</a>
 <a id="2965" class="Symbol">:</a> <a id="2967" class="Symbol">{</a><a id="2968" href="Games.OptimalPlays.html#2968" class="Bound">Xt</a> <a id="2971" class="Symbol">:</a> <a id="2973" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="2974" class="Symbol">}</a>
   <a id="2979" class="Symbol">(</a><a id="2980" href="Games.OptimalPlays.html#2980" class="Bound">Ï•t</a> <a id="2983" class="Symbol">:</a> <a id="2985" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="2987" href="Games.OptimalPlays.html#2968" class="Bound">Xt</a><a id="2989" class="Symbol">)</a>
   <a id="2994" class="Symbol">(</a><a id="2995" href="Games.OptimalPlays.html#2995" class="Bound">q</a> <a id="2997" class="Symbol">:</a> <a id="2999" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="3004" href="Games.OptimalPlays.html#2968" class="Bound">Xt</a> <a id="3007" class="Symbol">â†’</a> <a id="3009" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="3010" class="Symbol">)</a>
   <a id="3015" class="Symbol">(</a><a id="3016" href="Games.OptimalPlays.html#3016" class="Bound">xs</a> <a id="3019" class="Symbol">:</a> <a id="3021" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="3026" href="Games.OptimalPlays.html#2968" class="Bound">Xt</a><a id="3028" class="Symbol">)</a>
 <a id="3031" class="Symbol">â†’</a> <a id="3033" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="3049" class="Symbol">{</a><a id="3050" href="Games.OptimalPlays.html#2968" class="Bound">Xt</a><a id="3052" class="Symbol">}</a> <a id="3054" href="Games.OptimalPlays.html#2980" class="Bound">Ï•t</a> <a id="3057" href="Games.OptimalPlays.html#2995" class="Bound">q</a> <a id="3059" href="Games.OptimalPlays.html#3016" class="Bound">xs</a>
 <a id="3063" class="Symbol">â†’</a> <a id="3065" href="Games.OptimalPlays.html#2995" class="Bound">q</a> <a id="3067" href="Games.OptimalPlays.html#3016" class="Bound">xs</a> <a id="3070" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="3072" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="3088" class="Symbol">(</a><a id="3089" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="3094" href="Games.OptimalPlays.html#2968" class="Bound">Xt</a> <a id="3097" href="Games.OptimalPlays.html#2995" class="Bound">q</a> <a id="3099" href="Games.OptimalPlays.html#2980" class="Bound">Ï•t</a><a id="3101" class="Symbol">)</a>
<a id="3103" href="Games.OptimalPlays.html#2929" class="Function">optimal-play-gives-optimal-outcome</a> <a id="3138" class="Symbol">{</a><a id="3139" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a><a id="3141" class="Symbol">}</a>     <a id="3147" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>        <a id="3157" href="Games.OptimalPlays.html#3157" class="Bound">q</a> <a id="3159" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>        <a id="3169" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="3172" class="Symbol">=</a> <a id="3174" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>
<a id="3179" href="Games.OptimalPlays.html#2929" class="Function">optimal-play-gives-optimal-outcome</a> <a id="3214" class="Symbol">{</a><a id="3215" href="Games.OptimalPlays.html#3215" class="Bound">X</a> <a id="3217" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="3219" href="Games.OptimalPlays.html#3219" class="Bound">Xf</a><a id="3221" class="Symbol">}</a> <a id="3223" class="Symbol">(</a><a id="3224" href="Games.OptimalPlays.html#3224" class="Bound">Ï•</a> <a id="3226" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="3229" href="Games.OptimalPlays.html#3229" class="Bound">Ï•f</a><a id="3231" class="Symbol">)</a> <a id="3233" href="Games.OptimalPlays.html#3233" class="Bound">q</a> <a id="3235" class="Symbol">(</a><a id="3236" href="Games.OptimalPlays.html#3236" class="Bound">x</a> <a id="3238" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="3241" href="Games.OptimalPlays.html#3241" class="Bound">xs</a><a id="3243" class="Symbol">)</a> <a id="3245" class="Symbol">(</a><a id="3246" href="Games.OptimalPlays.html#3246" class="Bound">o</a> <a id="3248" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="3251" href="Games.OptimalPlays.html#3251" class="Bound">os</a><a id="3253" class="Symbol">)</a>
 <a id="3256" class="Symbol">=</a> <a id="3258" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="3266" href="Games.OptimalPlays.html#3233" class="Bound">q</a> <a id="3268" href="Games.OptimalPlays.html#3236" class="Bound">x</a> <a id="3270" href="Games.OptimalPlays.html#3241" class="Bound">xs</a>                                     <a id="3309" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="3312" href="Games.OptimalPlays.html#3446" class="Function">IH</a> <a id="3315" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
   <a id="3320" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="3336" class="Symbol">(</a><a id="3337" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="3342" class="Symbol">(</a><a id="3343" href="Games.OptimalPlays.html#3219" class="Bound">Xf</a> <a id="3346" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3347" class="Symbol">)</a> <a id="3349" class="Symbol">(</a><a id="3350" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="3358" href="Games.OptimalPlays.html#3233" class="Bound">q</a> <a id="3360" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3361" class="Symbol">)</a> <a id="3363" class="Symbol">(</a><a id="3364" href="Games.OptimalPlays.html#3229" class="Bound">Ï•f</a> <a id="3367" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3368" class="Symbol">))</a> <a id="3371" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="3374" href="Games.OptimalPlays.html#3246" class="Bound">o</a> <a id="3376" href="MLTT.Id.html#1055" class="Function Operator">â»Â¹</a> <a id="3379" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
   <a id="3384" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="3400" class="Symbol">(</a><a id="3401" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="3406" class="Symbol">(</a><a id="3407" href="Games.OptimalPlays.html#3215" class="Bound">X</a> <a id="3409" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="3411" href="Games.OptimalPlays.html#3219" class="Bound">Xf</a><a id="3413" class="Symbol">)</a> <a id="3415" href="Games.OptimalPlays.html#3233" class="Bound">q</a> <a id="3417" class="Symbol">(</a><a id="3418" href="Games.OptimalPlays.html#3224" class="Bound">Ï•</a> <a id="3420" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="3423" href="Games.OptimalPlays.html#3229" class="Bound">Ï•f</a><a id="3425" class="Symbol">))</a>        <a id="3435" href="MLTT.Id.html#2785" class="Function Operator">âˆ</a>
 <a id="3438" class="Keyword">where</a>
  <a id="3446" href="Games.OptimalPlays.html#3446" class="Function">IH</a> <a id="3449" class="Symbol">:</a> <a id="3451" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="3459" href="Games.OptimalPlays.html#3233" class="Bound">q</a> <a id="3461" href="Games.OptimalPlays.html#3236" class="Bound">x</a> <a id="3463" href="Games.OptimalPlays.html#3241" class="Bound">xs</a> <a id="3466" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="3468" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="3484" class="Symbol">(</a><a id="3485" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="3490" class="Symbol">(</a><a id="3491" href="Games.OptimalPlays.html#3219" class="Bound">Xf</a> <a id="3494" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3495" class="Symbol">)</a> <a id="3497" class="Symbol">(</a><a id="3498" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="3506" href="Games.OptimalPlays.html#3233" class="Bound">q</a> <a id="3508" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3509" class="Symbol">)</a> <a id="3511" class="Symbol">(</a><a id="3512" href="Games.OptimalPlays.html#3229" class="Bound">Ï•f</a> <a id="3515" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3516" class="Symbol">))</a>
  <a id="3521" href="Games.OptimalPlays.html#3446" class="Function">IH</a> <a id="3524" class="Symbol">=</a> <a id="3526" href="Games.OptimalPlays.html#2929" class="Function">optimal-play-gives-optimal-outcome</a> <a id="3561" class="Symbol">{</a><a id="3562" href="Games.OptimalPlays.html#3219" class="Bound">Xf</a> <a id="3565" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3566" class="Symbol">}</a> <a id="3568" class="Symbol">(</a><a id="3569" href="Games.OptimalPlays.html#3229" class="Bound">Ï•f</a> <a id="3572" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3573" class="Symbol">)</a> <a id="3575" class="Symbol">(</a><a id="3576" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="3584" href="Games.OptimalPlays.html#3233" class="Bound">q</a> <a id="3586" href="Games.OptimalPlays.html#3236" class="Bound">x</a><a id="3587" class="Symbol">)</a> <a id="3589" href="Games.OptimalPlays.html#3241" class="Bound">xs</a> <a id="3592" href="Games.OptimalPlays.html#3251" class="Bound">os</a>

<a id="strategic-path-is-optimal-play"></a><a id="3596" href="Games.OptimalPlays.html#3596" class="Function">strategic-path-is-optimal-play</a>
 <a id="3628" class="Symbol">:</a> <a id="3630" class="Symbol">{</a><a id="3631" href="Games.OptimalPlays.html#3631" class="Bound">Xt</a> <a id="3634" class="Symbol">:</a> <a id="3636" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="3637" class="Symbol">}</a>
   <a id="3642" class="Symbol">(</a><a id="3643" href="Games.OptimalPlays.html#3643" class="Bound">Ï•t</a> <a id="3646" class="Symbol">:</a> <a id="3648" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="3650" href="Games.OptimalPlays.html#3631" class="Bound">Xt</a><a id="3652" class="Symbol">)</a>
   <a id="3657" class="Symbol">(</a><a id="3658" href="Games.OptimalPlays.html#3658" class="Bound">q</a> <a id="3660" class="Symbol">:</a> <a id="3662" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="3667" href="Games.OptimalPlays.html#3631" class="Bound">Xt</a> <a id="3670" class="Symbol">â†’</a> <a id="3672" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="3673" class="Symbol">)</a>
   <a id="3678" class="Symbol">(</a><a id="3679" href="Games.OptimalPlays.html#3679" class="Bound">Ïƒ</a> <a id="3681" class="Symbol">:</a> <a id="3683" href="Games.FiniteHistoryDependent.html#3735" class="Function">Strategy</a> <a id="3692" href="Games.OptimalPlays.html#3631" class="Bound">Xt</a><a id="3694" class="Symbol">)</a>
 <a id="3697" class="Symbol">â†’</a> <a id="3699" href="Games.FiniteHistoryDependent.html#5881" class="Function">is-in-sgpe</a> <a id="3710" href="Games.OptimalPlays.html#3643" class="Bound">Ï•t</a> <a id="3713" href="Games.OptimalPlays.html#3658" class="Bound">q</a> <a id="3715" href="Games.OptimalPlays.html#3679" class="Bound">Ïƒ</a>
 <a id="3718" class="Symbol">â†’</a> <a id="3720" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="3736" href="Games.OptimalPlays.html#3643" class="Bound">Ï•t</a> <a id="3739" href="Games.OptimalPlays.html#3658" class="Bound">q</a> <a id="3741" class="Symbol">(</a><a id="3742" href="Games.FiniteHistoryDependent.html#4248" class="Function">strategic-path</a> <a id="3757" href="Games.OptimalPlays.html#3679" class="Bound">Ïƒ</a><a id="3758" class="Symbol">)</a>
<a id="3760" href="Games.OptimalPlays.html#3596" class="Function">strategic-path-is-optimal-play</a> <a id="3791" class="Symbol">{</a><a id="3792" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a><a id="3794" class="Symbol">}</a> <a id="3796" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="3799" href="Games.OptimalPlays.html#3799" class="Bound">q</a> <a id="3801" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="3804" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="3807" class="Symbol">=</a> <a id="3809" href="MLTT.Unit.html#162" class="InductiveConstructor">â‹†</a>
<a id="3811" href="Games.OptimalPlays.html#3596" class="Function">strategic-path-is-optimal-play</a> <a id="3842" class="Symbol">{</a><a id="3843" href="Games.OptimalPlays.html#3843" class="Bound">X</a> <a id="3845" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="3847" href="Games.OptimalPlays.html#3847" class="Bound">Xf</a><a id="3849" class="Symbol">}</a> <a id="3851" href="Games.OptimalPlays.html#3851" class="Bound">Ï•t</a><a id="3853" class="Symbol">@(</a><a id="3855" href="Games.OptimalPlays.html#3855" class="Bound">Ï•</a> <a id="3857" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="3860" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a><a id="3862" class="Symbol">)</a> <a id="3864" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="3866" href="Games.OptimalPlays.html#3866" class="Bound">Ïƒ</a><a id="3867" class="Symbol">@(</a><a id="3869" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a> <a id="3872" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="3875" href="Games.OptimalPlays.html#3875" class="Bound">Ïƒf</a><a id="3877" class="Symbol">)</a> <a id="3879" href="Games.OptimalPlays.html#3879" class="Bound">ot</a><a id="3881" class="Symbol">@(</a><a id="3883" href="Games.OptimalPlays.html#3883" class="Bound">o</a> <a id="3885" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="3888" href="Games.OptimalPlays.html#3888" class="Bound">os</a><a id="3890" class="Symbol">)</a>
 <a id="3893" class="Symbol">=</a> <a id="3895" href="Games.OptimalPlays.html#4075" class="Function">I</a> <a id="3897" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="3899" href="Games.OptimalPlays.html#3914" class="Function">IH</a> <a id="3902" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a>
 <a id="3906" class="Keyword">where</a>
  <a id="3914" href="Games.OptimalPlays.html#3914" class="Function">IH</a> <a id="3917" class="Symbol">:</a> <a id="3919" class="Symbol">(</a><a id="3920" href="Games.OptimalPlays.html#3920" class="Bound">x</a> <a id="3922" class="Symbol">:</a> <a id="3924" href="Games.OptimalPlays.html#3843" class="Bound">X</a><a id="3925" class="Symbol">)</a> <a id="3927" class="Symbol">â†’</a> <a id="3929" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="3945" class="Symbol">(</a><a id="3946" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="3949" href="Games.OptimalPlays.html#3920" class="Bound">x</a><a id="3950" class="Symbol">)</a> <a id="3952" class="Symbol">(</a><a id="3953" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="3961" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="3963" href="Games.OptimalPlays.html#3920" class="Bound">x</a><a id="3964" class="Symbol">)</a> <a id="3966" class="Symbol">(</a><a id="3967" href="Games.FiniteHistoryDependent.html#4248" class="Function">strategic-path</a> <a id="3982" class="Symbol">(</a><a id="3983" href="Games.OptimalPlays.html#3875" class="Bound">Ïƒf</a> <a id="3986" href="Games.OptimalPlays.html#3920" class="Bound">x</a><a id="3987" class="Symbol">))</a>
  <a id="3992" href="Games.OptimalPlays.html#3914" class="Function">IH</a> <a id="3995" href="Games.OptimalPlays.html#3995" class="Bound">x</a> <a id="3997" class="Symbol">=</a> <a id="3999" href="Games.OptimalPlays.html#3596" class="Function">strategic-path-is-optimal-play</a> <a id="4030" class="Symbol">{</a><a id="4031" href="Games.OptimalPlays.html#3847" class="Bound">Xf</a> <a id="4034" href="Games.OptimalPlays.html#3995" class="Bound">x</a><a id="4035" class="Symbol">}</a> <a id="4037" class="Symbol">(</a><a id="4038" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="4041" href="Games.OptimalPlays.html#3995" class="Bound">x</a><a id="4042" class="Symbol">)</a> <a id="4044" class="Symbol">(</a><a id="4045" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4053" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4055" href="Games.OptimalPlays.html#3995" class="Bound">x</a><a id="4056" class="Symbol">)</a> <a id="4058" class="Symbol">(</a><a id="4059" href="Games.OptimalPlays.html#3875" class="Bound">Ïƒf</a> <a id="4062" href="Games.OptimalPlays.html#3995" class="Bound">x</a><a id="4063" class="Symbol">)</a> <a id="4065" class="Symbol">(</a><a id="4066" href="Games.OptimalPlays.html#3888" class="Bound">os</a> <a id="4069" href="Games.OptimalPlays.html#3995" class="Bound">x</a><a id="4070" class="Symbol">)</a>

  <a id="4075" href="Games.OptimalPlays.html#4075" class="Function">I</a> <a id="4077" class="Symbol">:</a> <a id="4079" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="4095" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4097" href="Games.OptimalPlays.html#3855" class="Bound">Ï•</a> <a id="4099" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="4102" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a>
  <a id="4107" href="Games.OptimalPlays.html#4075" class="Function">I</a> <a id="4109" class="Symbol">=</a> <a id="4111" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="4127" class="Symbol">(</a><a id="4128" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="4133" class="Symbol">(</a><a id="4134" href="Games.OptimalPlays.html#3843" class="Bound">X</a> <a id="4136" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="4138" href="Games.OptimalPlays.html#3847" class="Bound">Xf</a><a id="4140" class="Symbol">)</a> <a id="4142" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4144" class="Symbol">(</a><a id="4145" href="Games.OptimalPlays.html#3855" class="Bound">Ï•</a> <a id="4147" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="4150" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a><a id="4152" class="Symbol">))</a>                  <a id="4172" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="4175" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="4180" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
      <a id="4188" href="Games.FiniteHistoryDependent.html#2857" class="Function">sequenceá´·</a> <a id="4198" class="Symbol">{</a><a id="4199" href="Games.OptimalPlays.html#3843" class="Bound">X</a> <a id="4201" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="4203" href="Games.OptimalPlays.html#3847" class="Bound">Xf</a><a id="4205" class="Symbol">}</a> <a id="4207" class="Symbol">(</a><a id="4208" href="Games.OptimalPlays.html#3855" class="Bound">Ï•</a> <a id="4210" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="4213" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a><a id="4215" class="Symbol">)</a> <a id="4217" href="Games.OptimalPlays.html#3864" class="Bound">q</a>                               <a id="4249" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="4252" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="4257" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
      <a id="4265" href="Games.OptimalPlays.html#3855" class="Bound">Ï•</a> <a id="4267" class="Symbol">(Î»</a> <a id="4270" href="Games.OptimalPlays.html#4270" class="Bound">x</a> <a id="4272" class="Symbol">â†’</a> <a id="4274" href="Games.FiniteHistoryDependent.html#2857" class="Function">sequenceá´·</a> <a id="4284" class="Symbol">(</a><a id="4285" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="4288" href="Games.OptimalPlays.html#4270" class="Bound">x</a><a id="4289" class="Symbol">)</a> <a id="4291" class="Symbol">(</a><a id="4292" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4300" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4302" href="Games.OptimalPlays.html#4270" class="Bound">x</a><a id="4303" class="Symbol">))</a>                     <a id="4326" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="4329" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="4334" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
      <a id="4342" href="Games.OptimalPlays.html#3855" class="Bound">Ï•</a> <a id="4344" class="Symbol">(Î»</a> <a id="4347" href="Games.OptimalPlays.html#4347" class="Bound">x</a> <a id="4349" class="Symbol">â†’</a> <a id="4351" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="4367" class="Symbol">(</a><a id="4368" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="4373" class="Symbol">(</a><a id="4374" href="Games.OptimalPlays.html#3847" class="Bound">Xf</a> <a id="4377" href="Games.OptimalPlays.html#4347" class="Bound">x</a><a id="4378" class="Symbol">)</a> <a id="4380" class="Symbol">(</a><a id="4381" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4389" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4391" href="Games.OptimalPlays.html#4347" class="Bound">x</a><a id="4392" class="Symbol">)</a> <a id="4394" class="Symbol">(</a><a id="4395" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="4398" href="Games.OptimalPlays.html#4347" class="Bound">x</a><a id="4399" class="Symbol">)))</a> <a id="4403" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="4406" href="Games.OptimalPlays.html#4988" class="Function">Iâ‚</a> <a id="4409" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
      <a id="4417" href="Games.OptimalPlays.html#3855" class="Bound">Ï•</a> <a id="4419" class="Symbol">(Î»</a> <a id="4422" href="Games.OptimalPlays.html#4422" class="Bound">x</a> <a id="4424" class="Symbol">â†’</a> <a id="4426" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4434" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4436" href="Games.OptimalPlays.html#4422" class="Bound">x</a> <a id="4438" class="Symbol">(</a><a id="4439" href="Games.FiniteHistoryDependent.html#4248" class="Function">strategic-path</a> <a id="4454" class="Symbol">(</a><a id="4455" href="Games.OptimalPlays.html#3875" class="Bound">Ïƒf</a> <a id="4458" href="Games.OptimalPlays.html#4422" class="Bound">x</a><a id="4459" class="Symbol">)))</a>                <a id="4478" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="4481" href="Games.OptimalPlays.html#3883" class="Bound">o</a> <a id="4483" href="MLTT.Id.html#1055" class="Function Operator">â»Â¹</a> <a id="4486" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
      <a id="4494" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4496" class="Symbol">(</a><a id="4497" href="Games.FiniteHistoryDependent.html#4248" class="Function">strategic-path</a> <a id="4512" href="Games.OptimalPlays.html#3866" class="Bound">Ïƒ</a><a id="4513" class="Symbol">)</a>                                         <a id="4555" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="4558" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="4563" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
      <a id="4571" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4579" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4581" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a> <a id="4584" class="Symbol">(</a><a id="4585" href="Games.FiniteHistoryDependent.html#4248" class="Function">strategic-path</a> <a id="4600" class="Symbol">(</a><a id="4601" href="Games.OptimalPlays.html#3875" class="Bound">Ïƒf</a> <a id="4604" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a><a id="4606" class="Symbol">))</a>                        <a id="4632" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="4635" href="Games.OptimalPlays.html#5022" class="Function">Iâ‚‚</a> <a id="4638" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
      <a id="4646" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="4662" class="Symbol">(</a><a id="4663" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="4668" class="Symbol">(</a><a id="4669" href="Games.OptimalPlays.html#3847" class="Bound">Xf</a> <a id="4672" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a><a id="4674" class="Symbol">)</a> <a id="4676" class="Symbol">(</a><a id="4677" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4685" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4687" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a><a id="4689" class="Symbol">)</a> <a id="4691" class="Symbol">(</a><a id="4692" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="4695" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a><a id="4697" class="Symbol">))</a>        <a id="4707" href="MLTT.Id.html#2785" class="Function Operator">âˆ</a>
       <a id="4716" class="Keyword">where</a>
        <a id="4730" href="Games.OptimalPlays.html#4730" class="Function">Iâ‚€</a> <a id="4733" class="Symbol">:</a> <a id="4735" class="Symbol">(</a><a id="4736" href="Games.OptimalPlays.html#4736" class="Bound">x</a> <a id="4738" class="Symbol">:</a> <a id="4740" href="Games.OptimalPlays.html#3843" class="Bound">X</a><a id="4741" class="Symbol">)</a>
           <a id="4754" class="Symbol">â†’</a> <a id="4756" href="Games.FiniteHistoryDependent.html#3536" class="Function">optimal-outcome</a> <a id="4772" class="Symbol">(</a><a id="4773" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="4778" class="Symbol">(</a><a id="4779" href="Games.OptimalPlays.html#3847" class="Bound">Xf</a> <a id="4782" href="Games.OptimalPlays.html#4736" class="Bound">x</a><a id="4783" class="Symbol">)</a> <a id="4785" class="Symbol">(</a><a id="4786" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4794" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4796" href="Games.OptimalPlays.html#4736" class="Bound">x</a><a id="4797" class="Symbol">)</a> <a id="4799" class="Symbol">(</a><a id="4800" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="4803" href="Games.OptimalPlays.html#4736" class="Bound">x</a><a id="4804" class="Symbol">))</a>
           <a id="4818" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="4820" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4828" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4830" href="Games.OptimalPlays.html#4736" class="Bound">x</a> <a id="4832" class="Symbol">(</a><a id="4833" href="Games.FiniteHistoryDependent.html#4248" class="Function">strategic-path</a> <a id="4848" class="Symbol">(</a><a id="4849" href="Games.OptimalPlays.html#3875" class="Bound">Ïƒf</a> <a id="4852" href="Games.OptimalPlays.html#4736" class="Bound">x</a><a id="4853" class="Symbol">))</a>
        <a id="4864" href="Games.OptimalPlays.html#4730" class="Function">Iâ‚€</a> <a id="4867" href="Games.OptimalPlays.html#4867" class="Bound">x</a> <a id="4869" class="Symbol">=</a> <a id="4871" class="Symbol">(</a><a id="4872" href="Games.OptimalPlays.html#2929" class="Function">optimal-play-gives-optimal-outcome</a>
                 <a id="4924" class="Symbol">(</a><a id="4925" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="4928" href="Games.OptimalPlays.html#4867" class="Bound">x</a><a id="4929" class="Symbol">)</a> <a id="4931" class="Symbol">(</a><a id="4932" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="4940" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="4942" href="Games.OptimalPlays.html#4867" class="Bound">x</a><a id="4943" class="Symbol">)</a> <a id="4945" class="Symbol">(</a><a id="4946" href="Games.FiniteHistoryDependent.html#4248" class="Function">strategic-path</a> <a id="4961" class="Symbol">(</a><a id="4962" href="Games.OptimalPlays.html#3875" class="Bound">Ïƒf</a> <a id="4965" href="Games.OptimalPlays.html#4867" class="Bound">x</a><a id="4966" class="Symbol">))</a> <a id="4969" class="Symbol">(</a><a id="4970" href="Games.OptimalPlays.html#3914" class="Function">IH</a> <a id="4973" href="Games.OptimalPlays.html#4867" class="Bound">x</a><a id="4974" class="Symbol">))</a><a id="4976" href="MLTT.Id.html#1055" class="Function Operator">â»Â¹</a>

        <a id="4988" href="Games.OptimalPlays.html#4988" class="Function">Iâ‚</a> <a id="4991" class="Symbol">=</a> <a id="4993" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="4996" href="Games.OptimalPlays.html#3855" class="Bound">Ï•</a> <a id="4998" class="Symbol">(</a><a id="4999" href="UF.FunExt.html#1242" class="Function">dfunext</a> <a id="5007" href="Games.OptimalPlays.html#573" class="Bound">fe</a> <a id="5010" href="Games.OptimalPlays.html#4730" class="Function">Iâ‚€</a><a id="5012" class="Symbol">)</a>
        <a id="5022" href="Games.OptimalPlays.html#5022" class="Function">Iâ‚‚</a> <a id="5025" class="Symbol">=</a> <a id="5027" href="Games.OptimalPlays.html#2929" class="Function">optimal-play-gives-optimal-outcome</a>
              <a id="5076" class="Symbol">(</a><a id="5077" href="Games.OptimalPlays.html#3860" class="Bound">Ï•f</a> <a id="5080" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a><a id="5082" class="Symbol">)</a> <a id="5084" class="Symbol">(</a><a id="5085" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="5093" href="Games.OptimalPlays.html#3864" class="Bound">q</a> <a id="5095" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a><a id="5097" class="Symbol">)</a> <a id="5099" class="Symbol">(</a><a id="5100" href="Games.FiniteHistoryDependent.html#4248" class="Function">strategic-path</a> <a id="5115" class="Symbol">(</a><a id="5116" href="Games.OptimalPlays.html#3875" class="Bound">Ïƒf</a> <a id="5119" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a><a id="5121" class="Symbol">))</a> <a id="5124" class="Symbol">(</a><a id="5125" href="Games.OptimalPlays.html#3914" class="Function">IH</a> <a id="5128" href="Games.OptimalPlays.html#3869" class="Bound">xâ‚€</a><a id="5130" class="Symbol">)</a>

<a id="5133" class="Markup">\end{code}</a><a id="5143" class="Background">

We now proceed to compute the non-empty list of all optimal plays of a
game, under suitable assumptions on the game.

The algebras of the nonempty list monad ğ•ƒâº are the semigroups
(associative magmas). We work with the magma structure on R defined by
x Â· y = x. Concretely, this amounts to the following construction.

</a><a id="5464" class="Markup">\begin{code}</a>

<a id="ğ“"></a><a id="5478" href="Games.OptimalPlays.html#5478" class="Function">ğ“</a> <a id="5480" class="Symbol">:</a> <a id="5482" href="MonadOnTypes.Monad.html#9102" class="Record">Algebra</a> <a id="5490" href="MonadOnTypes.NonEmptyList.html#1721" class="Function">ğ•ƒâº</a> <a id="5493" href="Games.OptimalPlays.html#596" class="Bound">R</a>
<a id="5495" href="Games.OptimalPlays.html#5478" class="Function">ğ“</a> <a id="5497" class="Symbol">=</a> <a id="5499" class="Keyword">record</a> <a id="5506" class="Symbol">{</a>
     <a id="5513" href="MonadOnTypes.Monad.html#9180" class="Field">structure-map</a> <a id="5527" class="Symbol">=</a> <a id="5529" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="5535" class="Symbol">;</a>
     <a id="5542" href="MonadOnTypes.Monad.html#9244" class="Field">aunit</a> <a id="5548" class="Symbol">=</a> <a id="5550" href="Games.OptimalPlays.html#5585" class="Function">u</a> <a id="5552" class="Symbol">;</a>
     <a id="5559" href="MonadOnTypes.Monad.html#9274" class="Field">aassoc</a> <a id="5566" class="Symbol">=</a> <a id="5568" href="Games.OptimalPlays.html#5623" class="Function">a</a>
    <a id="5574" class="Symbol">}</a>
 <a id="5577" class="Keyword">where</a>
  <a id="5585" href="Games.OptimalPlays.html#5585" class="Function">u</a> <a id="5587" class="Symbol">:</a> <a id="5589" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="5595" href="MLTT.Pi.html#513" class="Function Operator">âˆ˜</a> <a id="5597" href="MonadOnTypes.Monad.html#371" class="Field">Î·</a> <a id="5599" href="MonadOnTypes.NonEmptyList.html#1721" class="Function">ğ•ƒâº</a> <a id="5602" href="MLTT.Id.html#1889" class="Function Operator">âˆ¼</a> <a id="5604" href="MLTT.Pi.html#444" class="Function">id</a>
  <a id="5609" href="Games.OptimalPlays.html#5585" class="Function">u</a> <a id="5611" href="Games.OptimalPlays.html#5611" class="Bound">r</a> <a id="5613" class="Symbol">=</a> <a id="5615" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>

  <a id="5623" href="Games.OptimalPlays.html#5623" class="Function">a</a> <a id="5625" class="Symbol">:</a> <a id="5627" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="5633" href="MLTT.Pi.html#513" class="Function Operator">âˆ˜</a> <a id="5635" href="MonadOnTypes.Monad.html#404" class="Field">ext</a> <a id="5639" href="MonadOnTypes.NonEmptyList.html#1721" class="Function">ğ•ƒâº</a> <a id="5642" class="Symbol">(</a><a id="5643" href="MonadOnTypes.Monad.html#371" class="Field">Î·</a> <a id="5645" href="MonadOnTypes.NonEmptyList.html#1721" class="Function">ğ•ƒâº</a> <a id="5648" href="MLTT.Pi.html#513" class="Function Operator">âˆ˜</a> <a id="5650" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a><a id="5655" class="Symbol">)</a> <a id="5657" href="MLTT.Id.html#1889" class="Function Operator">âˆ¼</a> <a id="5659" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="5665" href="MLTT.Pi.html#513" class="Function Operator">âˆ˜</a> <a id="5667" href="MonadOnTypes.Monad.html#404" class="Field">ext</a> <a id="5671" href="MonadOnTypes.NonEmptyList.html#1721" class="Function">ğ•ƒâº</a> <a id="5674" href="MLTT.Pi.html#444" class="Function">id</a>
  <a id="5679" href="Games.OptimalPlays.html#5623" class="Function">a</a> <a id="5681" class="Symbol">((((</a><a id="5685" href="Games.OptimalPlays.html#5685" class="Bound">r</a> <a id="5687" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="5689" class="Symbol">_)</a> <a id="5692" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="5694" class="Symbol">_)</a> <a id="5697" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="5699" class="Symbol">_)</a> <a id="5702" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="5704" class="Symbol">_)</a> <a id="5707" class="Symbol">=</a> <a id="5709" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>

<a id="5715" class="Keyword">open</a> <a id="5720" href="MonadOnTypes.Monad.html#5034" class="Module">T-definitions</a> <a id="5734" href="MonadOnTypes.NonEmptyList.html#1721" class="Function">ğ•ƒâº</a>
<a id="5737" class="Keyword">open</a> <a id="5742" href="MonadOnTypes.Monad.html#14518" class="Module">Î±-definitions</a> <a id="5756" href="MonadOnTypes.NonEmptyList.html#1721" class="Function">ğ•ƒâº</a> <a id="5759" href="Games.OptimalPlays.html#596" class="Bound">R</a> <a id="5761" href="Games.OptimalPlays.html#5478" class="Function">ğ“</a>
<a id="5763" class="Keyword">open</a> <a id="5768" href="MonadOnTypes.J-transf-variation.html#2217" class="Module">JT-definitions</a> <a id="5783" href="MonadOnTypes.NonEmptyList.html#1721" class="Function">ğ•ƒâº</a> <a id="5786" href="Games.OptimalPlays.html#596" class="Bound">R</a> <a id="5788" href="Games.OptimalPlays.html#5478" class="Function">ğ“</a> <a id="5790" href="Games.OptimalPlays.html#573" class="Bound">fe</a>
<a id="5793" class="Keyword">open</a> <a id="5798" href="MonadOnTypes.JK.html#215" class="Module">JK</a> <a id="5801" href="Games.OptimalPlays.html#596" class="Bound">R</a>

<a id="5804" class="Markup">\end{code}</a><a id="5814" class="Background">

Ordinary selection functions are of type J X := (X â†’ R) â†’ X. Here we
work with JT defined as follows.

</a><a id="5919" class="Markup">\begin{code}</a>

<a id="JT-remark"></a><a id="5933" href="Games.OptimalPlays.html#5933" class="Function">JT-remark</a> <a id="5943" class="Symbol">:</a> <a id="5945" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="5948" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="5950" class="Symbol">Î»</a> <a id="5952" href="Games.OptimalPlays.html#5952" class="Bound">X</a> <a id="5954" class="Symbol">â†’</a> <a id="5956" class="Symbol">(</a><a id="5957" href="Games.OptimalPlays.html#5952" class="Bound">X</a> <a id="5959" class="Symbol">â†’</a> <a id="5961" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="5962" class="Symbol">)</a> <a id="5964" class="Symbol">â†’</a> <a id="5966" href="MonadOnTypes.NonEmptyList.html#514" class="Function">Listâº</a> <a id="5972" href="Games.OptimalPlays.html#5952" class="Bound">X</a>
<a id="5974" href="Games.OptimalPlays.html#5933" class="Function">JT-remark</a> <a id="5984" class="Symbol">=</a> <a id="5986" href="MLTT.Id.html#2431" class="Function">by-definition</a>

<a id="6001" class="Markup">\end{code}</a><a id="6011" class="Background">

Every algebra Î± of any monad T induces an extension operator Î±Â­extáµ€,
which for the case T = Listâº with the algebra defined above is
characterized as follows.

</a><a id="6172" class="Markup">\begin{code}</a>

<a id="Î±-extáµ€-explicitly"></a><a id="6186" href="Games.OptimalPlays.html#6186" class="Function">Î±-extáµ€-explicitly</a> <a id="6204" class="Symbol">:</a> <a id="6206" class="Symbol">{</a><a id="6207" href="Games.OptimalPlays.html#6207" class="Bound">X</a> <a id="6209" class="Symbol">:</a> <a id="6211" href="Notation.General.html#372" class="Function">Type</a><a id="6215" class="Symbol">}</a> <a id="6217" class="Symbol">(</a><a id="6218" href="Games.OptimalPlays.html#6218" class="Bound">p</a> <a id="6220" class="Symbol">:</a> <a id="6222" href="Games.OptimalPlays.html#6207" class="Bound">X</a> <a id="6224" class="Symbol">â†’</a> <a id="6226" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="6227" class="Symbol">)</a> <a id="6229" class="Symbol">(</a><a id="6230" href="Games.OptimalPlays.html#6230" class="Bound">t</a> <a id="6232" class="Symbol">:</a> <a id="6234" href="MonadOnTypes.NonEmptyList.html#514" class="Function">Listâº</a> <a id="6240" href="Games.OptimalPlays.html#6207" class="Bound">X</a><a id="6241" class="Symbol">)</a>
                  <a id="6261" class="Symbol">â†’</a> <a id="6263" href="MonadOnTypes.Monad.html#14835" class="Function">Î±-extáµ€</a> <a id="6270" href="Games.OptimalPlays.html#6218" class="Bound">p</a> <a id="6272" href="Games.OptimalPlays.html#6230" class="Bound">t</a> <a id="6274" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="6276" href="Games.OptimalPlays.html#6218" class="Bound">p</a> <a id="6278" class="Symbol">(</a><a id="6279" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="6285" href="Games.OptimalPlays.html#6230" class="Bound">t</a><a id="6286" class="Symbol">)</a>
<a id="6288" href="Games.OptimalPlays.html#6186" class="Function">Î±-extáµ€-explicitly</a> <a id="6306" href="Games.OptimalPlays.html#6306" class="Bound">p</a> <a id="6308" class="Symbol">((</a><a id="6310" href="Games.OptimalPlays.html#6310" class="Bound">x</a> <a id="6312" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="6314" class="Symbol">_)</a> <a id="6317" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="6320" class="Symbol">_)</a> <a id="6323" class="Symbol">=</a> <a id="6325" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>

<a id="6331" class="Markup">\end{code}</a><a id="6341" class="Background">

We now construct a JT-selection function Îµâº from an ordinary
J-selection function Îµ that attains a quantifier Ï•, for any listed
type X with at least one element.

Recall that we say that a type is listedâº if it has a distinguished
element and a list of all its elements (which will automatically
include the distinguished element).

</a><a id="6676" class="Markup">\begin{code}</a>

<a id="6690" class="Keyword">module</a> <a id="6697" href="Games.OptimalPlays.html#6697" class="Module">_</a> <a id="6699" class="Symbol">(</a><a id="6700" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="6702" class="Symbol">:</a> <a id="6704" href="Notation.General.html#372" class="Function">Type</a><a id="6708" class="Symbol">)</a>
         <a id="6719" class="Symbol">(</a><a id="6720" href="Games.OptimalPlays.html#6720" class="Bound">X-is-listedâº</a><a id="6732" class="Symbol">@(</a><a id="6734" href="Games.OptimalPlays.html#6734" class="Bound">xâ‚€</a> <a id="6737" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="6739" href="Games.OptimalPlays.html#6739" class="Bound">xs</a> <a id="6742" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="6744" href="Games.OptimalPlays.html#6744" class="Bound">Î¼</a><a id="6745" class="Symbol">)</a> <a id="6747" class="Symbol">:</a> <a id="6749" href="MLTT.List.html#6746" class="Function">listedâº</a> <a id="6757" href="Games.OptimalPlays.html#6700" class="Bound">X</a><a id="6758" class="Symbol">)</a>
         <a id="6769" class="Symbol">(</a><a id="6770" href="Games.OptimalPlays.html#6770" class="Bound">Ï•</a> <a id="6772" class="Symbol">:</a> <a id="6774" class="Symbol">(</a><a id="6775" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="6777" class="Symbol">â†’</a> <a id="6779" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="6780" class="Symbol">)</a> <a id="6782" class="Symbol">â†’</a> <a id="6784" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="6785" class="Symbol">)</a>
      <a id="6793" class="Keyword">where</a>

 <a id="6801" class="Keyword">private</a>
  <a id="6811" href="Games.OptimalPlays.html#6811" class="Function">A</a> <a id="6813" class="Symbol">:</a> <a id="6815" class="Symbol">(</a><a id="6816" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="6818" class="Symbol">â†’</a> <a id="6820" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="6821" class="Symbol">)</a> <a id="6823" class="Symbol">â†’</a> <a id="6825" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="6827" class="Symbol">â†’</a> <a id="6829" href="Notation.General.html#372" class="Function">Type</a>
  <a id="6836" href="Games.OptimalPlays.html#6811" class="Function">A</a> <a id="6838" href="Games.OptimalPlays.html#6838" class="Bound">p</a> <a id="6840" href="Games.OptimalPlays.html#6840" class="Bound">x</a> <a id="6842" class="Symbol">=</a> <a id="6844" href="Games.OptimalPlays.html#6838" class="Bound">p</a> <a id="6846" href="Games.OptimalPlays.html#6840" class="Bound">x</a> <a id="6848" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="6850" href="Games.OptimalPlays.html#6770" class="Bound">Ï•</a> <a id="6852" href="Games.OptimalPlays.html#6838" class="Bound">p</a>

  <a id="6857" href="Games.OptimalPlays.html#6857" class="Function">Î´A</a> <a id="6860" class="Symbol">:</a> <a id="6862" class="Symbol">(</a><a id="6863" href="Games.OptimalPlays.html#6863" class="Bound">p</a> <a id="6865" class="Symbol">:</a> <a id="6867" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="6869" class="Symbol">â†’</a> <a id="6871" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="6872" class="Symbol">)</a> <a id="6874" class="Symbol">(</a><a id="6875" href="Games.OptimalPlays.html#6875" class="Bound">x</a> <a id="6877" class="Symbol">:</a> <a id="6879" href="Games.OptimalPlays.html#6700" class="Bound">X</a><a id="6880" class="Symbol">)</a> <a id="6882" class="Symbol">â†’</a> <a id="6884" href="MLTT.Negation.html#584" class="Function">is-decidable</a> <a id="6897" class="Symbol">(</a><a id="6898" href="Games.OptimalPlays.html#6811" class="Function">A</a> <a id="6900" href="Games.OptimalPlays.html#6863" class="Bound">p</a> <a id="6902" href="Games.OptimalPlays.html#6875" class="Bound">x</a><a id="6903" class="Symbol">)</a>
  <a id="6907" href="Games.OptimalPlays.html#6857" class="Function">Î´A</a> <a id="6910" href="Games.OptimalPlays.html#6910" class="Bound">p</a> <a id="6912" href="Games.OptimalPlays.html#6912" class="Bound">x</a> <a id="6914" class="Symbol">=</a> <a id="6916" href="Games.OptimalPlays.html#616" class="Bound">R-is-discrete</a> <a id="6930" class="Symbol">(</a><a id="6931" href="Games.OptimalPlays.html#6910" class="Bound">p</a> <a id="6933" href="Games.OptimalPlays.html#6912" class="Bound">x</a><a id="6934" class="Symbol">)</a> <a id="6936" class="Symbol">(</a><a id="6937" href="Games.OptimalPlays.html#6770" class="Bound">Ï•</a> <a id="6939" href="Games.OptimalPlays.html#6910" class="Bound">p</a><a id="6940" class="Symbol">)</a>

 <a id="6944" href="Games.OptimalPlays.html#6944" class="Function">Îµá´¸</a> <a id="6947" class="Symbol">:</a>  <a id="6950" class="Symbol">(</a><a id="6951" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="6953" class="Symbol">â†’</a> <a id="6955" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="6956" class="Symbol">)</a> <a id="6958" class="Symbol">â†’</a> <a id="6960" href="MLTT.List.html#488" class="Datatype">List</a> <a id="6965" href="Games.OptimalPlays.html#6700" class="Bound">X</a>
 <a id="6968" href="Games.OptimalPlays.html#6944" class="Function">Îµá´¸</a> <a id="6971" href="Games.OptimalPlays.html#6971" class="Bound">p</a> <a id="6973" class="Symbol">=</a> <a id="6975" href="MLTT.List.html#4578" class="Function">filter</a> <a id="6982" class="Symbol">(</a><a id="6983" href="Games.OptimalPlays.html#6811" class="Function">A</a> <a id="6985" href="Games.OptimalPlays.html#6971" class="Bound">p</a><a id="6986" class="Symbol">)</a> <a id="6988" class="Symbol">(</a><a id="6989" href="Games.OptimalPlays.html#6857" class="Function">Î´A</a> <a id="6992" href="Games.OptimalPlays.html#6971" class="Bound">p</a><a id="6993" class="Symbol">)</a> <a id="6995" href="Games.OptimalPlays.html#6739" class="Bound">xs</a>

 <a id="7000" href="Games.OptimalPlays.html#7000" class="Function">Îµá´¸-propertyâ†’</a> <a id="7013" class="Symbol">:</a> <a id="7015" class="Symbol">(</a><a id="7016" href="Games.OptimalPlays.html#7016" class="Bound">p</a> <a id="7018" class="Symbol">:</a> <a id="7020" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="7022" class="Symbol">â†’</a> <a id="7024" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="7025" class="Symbol">)</a> <a id="7027" class="Symbol">(</a><a id="7028" href="Games.OptimalPlays.html#7028" class="Bound">x</a> <a id="7030" class="Symbol">:</a> <a id="7032" href="Games.OptimalPlays.html#6700" class="Bound">X</a><a id="7033" class="Symbol">)</a> <a id="7035" class="Symbol">â†’</a> <a id="7037" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="7044" href="Games.OptimalPlays.html#7028" class="Bound">x</a> <a id="7046" class="Symbol">(</a><a id="7047" href="Games.OptimalPlays.html#6944" class="Function">Îµá´¸</a> <a id="7050" href="Games.OptimalPlays.html#7016" class="Bound">p</a><a id="7051" class="Symbol">)</a> <a id="7053" class="Symbol">â†’</a> <a id="7055" href="Games.OptimalPlays.html#7016" class="Bound">p</a> <a id="7057" href="Games.OptimalPlays.html#7028" class="Bound">x</a> <a id="7059" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="7061" href="Games.OptimalPlays.html#6770" class="Bound">Ï•</a> <a id="7063" href="Games.OptimalPlays.html#7016" class="Bound">p</a>
 <a id="7066" href="Games.OptimalPlays.html#7000" class="Function">Îµá´¸-propertyâ†’</a> <a id="7079" href="Games.OptimalPlays.html#7079" class="Bound">p</a> <a id="7081" href="Games.OptimalPlays.html#7081" class="Bound">x</a> <a id="7083" class="Symbol">=</a> <a id="7085" href="MLTT.List.html#4779" class="Function">filter-memberâ†’</a> <a id="7100" class="Symbol">(</a><a id="7101" href="Games.OptimalPlays.html#6811" class="Function">A</a> <a id="7103" href="Games.OptimalPlays.html#7079" class="Bound">p</a><a id="7104" class="Symbol">)</a> <a id="7106" class="Symbol">(</a><a id="7107" href="Games.OptimalPlays.html#6857" class="Function">Î´A</a> <a id="7110" href="Games.OptimalPlays.html#7079" class="Bound">p</a><a id="7111" class="Symbol">)</a> <a id="7113" href="Games.OptimalPlays.html#7081" class="Bound">x</a> <a id="7115" href="Games.OptimalPlays.html#6739" class="Bound">xs</a>

 <a id="7120" href="Games.OptimalPlays.html#7120" class="Function">Îµá´¸-propertyâ†</a> <a id="7133" class="Symbol">:</a> <a id="7135" class="Symbol">(</a><a id="7136" href="Games.OptimalPlays.html#7136" class="Bound">p</a> <a id="7138" class="Symbol">:</a> <a id="7140" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="7142" class="Symbol">â†’</a> <a id="7144" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="7145" class="Symbol">)</a> <a id="7147" class="Symbol">(</a><a id="7148" href="Games.OptimalPlays.html#7148" class="Bound">x</a> <a id="7150" class="Symbol">:</a> <a id="7152" href="Games.OptimalPlays.html#6700" class="Bound">X</a><a id="7153" class="Symbol">)</a> <a id="7155" class="Symbol">â†’</a> <a id="7157" href="Games.OptimalPlays.html#7136" class="Bound">p</a> <a id="7159" href="Games.OptimalPlays.html#7148" class="Bound">x</a> <a id="7161" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="7163" href="Games.OptimalPlays.html#6770" class="Bound">Ï•</a> <a id="7165" href="Games.OptimalPlays.html#7136" class="Bound">p</a> <a id="7167" class="Symbol">â†’</a> <a id="7169" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="7176" href="Games.OptimalPlays.html#7148" class="Bound">x</a> <a id="7178" class="Symbol">(</a><a id="7179" href="Games.OptimalPlays.html#6944" class="Function">Îµá´¸</a> <a id="7182" href="Games.OptimalPlays.html#7136" class="Bound">p</a><a id="7183" class="Symbol">)</a>
 <a id="7186" href="Games.OptimalPlays.html#7120" class="Function">Îµá´¸-propertyâ†</a> <a id="7199" href="Games.OptimalPlays.html#7199" class="Bound">p</a> <a id="7201" href="Games.OptimalPlays.html#7201" class="Bound">x</a> <a id="7203" href="Games.OptimalPlays.html#7203" class="Bound">e</a> <a id="7205" class="Symbol">=</a> <a id="7207" href="MLTT.List.html#5348" class="Function">filter-memberâ†</a> <a id="7222" class="Symbol">(</a><a id="7223" href="Games.OptimalPlays.html#6811" class="Function">A</a> <a id="7225" href="Games.OptimalPlays.html#7199" class="Bound">p</a><a id="7226" class="Symbol">)</a> <a id="7228" class="Symbol">(</a><a id="7229" href="Games.OptimalPlays.html#6857" class="Function">Î´A</a> <a id="7232" href="Games.OptimalPlays.html#7199" class="Bound">p</a><a id="7233" class="Symbol">)</a> <a id="7235" href="Games.OptimalPlays.html#7201" class="Bound">x</a> <a id="7237" href="Games.OptimalPlays.html#6739" class="Bound">xs</a> <a id="7240" href="Games.OptimalPlays.html#7203" class="Bound">e</a> <a id="7242" class="Symbol">(</a><a id="7243" href="Games.OptimalPlays.html#6744" class="Bound">Î¼</a> <a id="7245" href="Games.OptimalPlays.html#7201" class="Bound">x</a><a id="7246" class="Symbol">)</a>

 <a id="7250" class="Keyword">module</a> <a id="7257" href="Games.OptimalPlays.html#7257" class="Module">_</a> <a id="7259" class="Symbol">(</a><a id="7260" href="Games.OptimalPlays.html#7260" class="Bound">Îµ</a> <a id="7262" class="Symbol">:</a> <a id="7264" class="Symbol">(</a><a id="7265" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="7267" class="Symbol">â†’</a> <a id="7269" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="7270" class="Symbol">)</a> <a id="7272" class="Symbol">â†’</a> <a id="7274" href="Games.OptimalPlays.html#6700" class="Bound">X</a><a id="7275" class="Symbol">)</a>
          <a id="7287" class="Symbol">(</a><a id="7288" href="Games.OptimalPlays.html#7288" class="Bound">Îµ-attains-Ï•</a> <a id="7300" class="Symbol">:</a> <a id="7302" href="Games.OptimalPlays.html#7260" class="Bound">Îµ</a> <a id="7304" href="MonadOnTypes.JK.html#555" class="Function Operator">attains</a> <a id="7312" href="Games.OptimalPlays.html#6770" class="Bound">Ï•</a><a id="7313" class="Symbol">)</a>
        <a id="7323" class="Keyword">where</a>

  <a id="7332" href="Games.OptimalPlays.html#7332" class="Function">Îµ-member-of-Îµá´¸</a> <a id="7347" class="Symbol">:</a> <a id="7349" class="Symbol">(</a><a id="7350" href="Games.OptimalPlays.html#7350" class="Bound">p</a> <a id="7352" class="Symbol">:</a> <a id="7354" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="7356" class="Symbol">â†’</a> <a id="7358" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="7359" class="Symbol">)</a> <a id="7361" class="Symbol">â†’</a> <a id="7363" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="7370" class="Symbol">(</a><a id="7371" href="Games.OptimalPlays.html#7260" class="Bound">Îµ</a> <a id="7373" href="Games.OptimalPlays.html#7350" class="Bound">p</a><a id="7374" class="Symbol">)</a> <a id="7376" class="Symbol">(</a><a id="7377" href="Games.OptimalPlays.html#6944" class="Function">Îµá´¸</a> <a id="7380" href="Games.OptimalPlays.html#7350" class="Bound">p</a><a id="7381" class="Symbol">)</a>
  <a id="7385" href="Games.OptimalPlays.html#7332" class="Function">Îµ-member-of-Îµá´¸</a> <a id="7400" href="Games.OptimalPlays.html#7400" class="Bound">p</a> <a id="7402" class="Symbol">=</a> <a id="7404" href="MLTT.List.html#5348" class="Function">filter-memberâ†</a> <a id="7419" class="Symbol">(</a><a id="7420" href="Games.OptimalPlays.html#6811" class="Function">A</a> <a id="7422" href="Games.OptimalPlays.html#7400" class="Bound">p</a><a id="7423" class="Symbol">)</a> <a id="7425" class="Symbol">(</a><a id="7426" href="Games.OptimalPlays.html#6857" class="Function">Î´A</a> <a id="7429" href="Games.OptimalPlays.html#7400" class="Bound">p</a><a id="7430" class="Symbol">)</a> <a id="7432" class="Symbol">(</a><a id="7433" href="Games.OptimalPlays.html#7260" class="Bound">Îµ</a> <a id="7435" href="Games.OptimalPlays.html#7400" class="Bound">p</a><a id="7436" class="Symbol">)</a> <a id="7438" href="Games.OptimalPlays.html#6739" class="Bound">xs</a> <a id="7441" class="Symbol">(</a><a id="7442" href="Games.OptimalPlays.html#7288" class="Bound">Îµ-attains-Ï•</a> <a id="7454" href="Games.OptimalPlays.html#7400" class="Bound">p</a><a id="7455" class="Symbol">)</a> <a id="7457" class="Symbol">(</a><a id="7458" href="Games.OptimalPlays.html#6744" class="Bound">Î¼</a> <a id="7460" class="Symbol">(</a><a id="7461" href="Games.OptimalPlays.html#7260" class="Bound">Îµ</a> <a id="7463" href="Games.OptimalPlays.html#7400" class="Bound">p</a><a id="7464" class="Symbol">))</a>

  <a id="7470" href="Games.OptimalPlays.html#7470" class="Function">Îµá´¸-is-non-empty</a> <a id="7486" class="Symbol">:</a> <a id="7488" class="Symbol">(</a><a id="7489" href="Games.OptimalPlays.html#7489" class="Bound">p</a> <a id="7491" class="Symbol">:</a> <a id="7493" href="Games.OptimalPlays.html#6700" class="Bound">X</a> <a id="7495" class="Symbol">â†’</a> <a id="7497" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="7498" class="Symbol">)</a> <a id="7500" class="Symbol">â†’</a> <a id="7502" href="MLTT.List.html#2407" class="Function">is-non-empty</a> <a id="7515" class="Symbol">(</a><a id="7516" href="Games.OptimalPlays.html#6944" class="Function">Îµá´¸</a> <a id="7519" href="Games.OptimalPlays.html#7489" class="Bound">p</a><a id="7520" class="Symbol">)</a>
  <a id="7524" href="Games.OptimalPlays.html#7470" class="Function">Îµá´¸-is-non-empty</a> <a id="7540" href="Games.OptimalPlays.html#7540" class="Bound">p</a> <a id="7542" class="Symbol">=</a> <a id="7544" href="MLTT.List.html#3734" class="Function">lists-with-members-are-non-empty</a> <a id="7577" class="Symbol">(</a><a id="7578" href="Games.OptimalPlays.html#7332" class="Function">Îµ-member-of-Îµá´¸</a> <a id="7593" href="Games.OptimalPlays.html#7540" class="Bound">p</a><a id="7594" class="Symbol">)</a>

  <a id="7599" href="Games.OptimalPlays.html#7599" class="Function">Îµâº</a> <a id="7602" class="Symbol">:</a> <a id="7604" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="7607" href="Games.OptimalPlays.html#6700" class="Bound">X</a>
  <a id="7611" href="Games.OptimalPlays.html#7599" class="Function">Îµâº</a> <a id="7614" href="Games.OptimalPlays.html#7614" class="Bound">p</a> <a id="7616" class="Symbol">=</a> <a id="7618" href="Games.OptimalPlays.html#6944" class="Function">Îµá´¸</a> <a id="7621" href="Games.OptimalPlays.html#7614" class="Bound">p</a> <a id="7623" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="7625" href="Games.OptimalPlays.html#7470" class="Function">Îµá´¸-is-non-empty</a> <a id="7641" href="Games.OptimalPlays.html#7614" class="Bound">p</a>

<a id="7644" class="Markup">\end{code}</a><a id="7654" class="Background">

We now extend this to trees of selection functions that attain
quantifiers.

</a><a id="7733" class="Markup">\begin{code}</a>

<a id="ğ“™ğ“£"></a><a id="7747" href="Games.OptimalPlays.html#7747" class="Function">ğ“™ğ“£</a> <a id="7750" class="Symbol">:</a> <a id="7752" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a> <a id="7754" class="Symbol">â†’</a> <a id="7756" href="Notation.General.html#372" class="Function">Type</a>
<a id="7761" href="Games.OptimalPlays.html#7747" class="Function">ğ“™ğ“£</a> <a id="7764" class="Symbol">=</a> <a id="7766" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="7776" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a>

<a id="Îµtâº"></a><a id="7780" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="7784" class="Symbol">:</a> <a id="7786" class="Symbol">(</a><a id="7787" href="Games.OptimalPlays.html#7787" class="Bound">Xt</a> <a id="7790" class="Symbol">:</a> <a id="7792" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="7793" class="Symbol">)</a>
    <a id="7799" class="Symbol">â†’</a> <a id="7801" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="7811" href="MLTT.List.html#6746" class="Function">listedâº</a> <a id="7819" href="Games.OptimalPlays.html#7787" class="Bound">Xt</a>
    <a id="7826" class="Symbol">â†’</a> <a id="7828" class="Symbol">(</a><a id="7829" href="Games.OptimalPlays.html#7829" class="Bound">Ï•t</a> <a id="7832" class="Symbol">:</a> <a id="7834" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="7836" href="Games.OptimalPlays.html#7787" class="Bound">Xt</a><a id="7838" class="Symbol">)</a>
    <a id="7844" class="Symbol">â†’</a> <a id="7846" class="Symbol">(</a><a id="7847" href="Games.OptimalPlays.html#7847" class="Bound">Îµt</a> <a id="7850" class="Symbol">:</a> <a id="7852" href="Games.FiniteHistoryDependent.html#8970" class="Function">ğ“™</a> <a id="7854" href="Games.OptimalPlays.html#7787" class="Bound">Xt</a><a id="7856" class="Symbol">)</a>
    <a id="7862" class="Symbol">â†’</a> <a id="7864" href="Games.OptimalPlays.html#7847" class="Bound">Îµt</a> <a id="7867" href="Games.FiniteHistoryDependent.html#10543" class="Function Operator">Attains</a> <a id="7875" href="Games.OptimalPlays.html#7829" class="Bound">Ï•t</a>
    <a id="7882" class="Symbol">â†’</a> <a id="7884" href="Games.OptimalPlays.html#7747" class="Function">ğ“™ğ“£</a> <a id="7887" href="Games.OptimalPlays.html#7787" class="Bound">Xt</a>
<a id="7890" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="7894" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a> <a id="7897" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="7900" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="7903" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="7906" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="7909" class="Symbol">=</a> <a id="7911" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>
<a id="7914" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="7918" class="Symbol">(</a><a id="7919" href="Games.OptimalPlays.html#7919" class="Bound">X</a> <a id="7921" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="7923" href="Games.OptimalPlays.html#7923" class="Bound">Xf</a><a id="7925" class="Symbol">)</a> <a id="7927" class="Symbol">(</a><a id="7928" href="Games.OptimalPlays.html#7928" class="Bound">l</a> <a id="7930" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="7933" href="Games.OptimalPlays.html#7933" class="Bound">lf</a><a id="7935" class="Symbol">)</a> <a id="7937" class="Symbol">(</a><a id="7938" href="Games.OptimalPlays.html#7938" class="Bound">Ï•</a> <a id="7940" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="7943" href="Games.OptimalPlays.html#7943" class="Bound">Ï•f</a><a id="7945" class="Symbol">)</a> <a id="7947" class="Symbol">(</a><a id="7948" href="Games.OptimalPlays.html#7948" class="Bound">Îµ</a> <a id="7950" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="7953" href="Games.OptimalPlays.html#7953" class="Bound">Îµf</a><a id="7955" class="Symbol">)</a> <a id="7957" class="Symbol">(</a><a id="7958" href="Games.OptimalPlays.html#7958" class="Bound">a</a> <a id="7960" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="7963" href="Games.OptimalPlays.html#7963" class="Bound">af</a><a id="7965" class="Symbol">)</a> <a id="7967" class="Symbol">=</a>
 <a id="7970" href="Games.OptimalPlays.html#7599" class="Function">Îµâº</a> <a id="7973" href="Games.OptimalPlays.html#7919" class="Bound">X</a> <a id="7975" href="Games.OptimalPlays.html#7928" class="Bound">l</a> <a id="7977" href="Games.OptimalPlays.html#7938" class="Bound">Ï•</a> <a id="7979" href="Games.OptimalPlays.html#7948" class="Bound">Îµ</a> <a id="7981" href="Games.OptimalPlays.html#7958" class="Bound">a</a> <a id="7983" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="7986" class="Symbol">(Î»</a> <a id="7989" href="Games.OptimalPlays.html#7989" class="Bound">x</a> <a id="7991" class="Symbol">â†’</a> <a id="7993" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="7997" class="Symbol">(</a><a id="7998" href="Games.OptimalPlays.html#7923" class="Bound">Xf</a> <a id="8001" href="Games.OptimalPlays.html#7989" class="Bound">x</a><a id="8002" class="Symbol">)</a> <a id="8004" class="Symbol">(</a><a id="8005" href="Games.OptimalPlays.html#7933" class="Bound">lf</a> <a id="8008" href="Games.OptimalPlays.html#7989" class="Bound">x</a><a id="8009" class="Symbol">)</a> <a id="8011" class="Symbol">(</a><a id="8012" href="Games.OptimalPlays.html#7943" class="Bound">Ï•f</a> <a id="8015" href="Games.OptimalPlays.html#7989" class="Bound">x</a><a id="8016" class="Symbol">)</a> <a id="8018" class="Symbol">(</a><a id="8019" href="Games.OptimalPlays.html#7953" class="Bound">Îµf</a> <a id="8022" href="Games.OptimalPlays.html#7989" class="Bound">x</a><a id="8023" class="Symbol">)</a> <a id="8025" class="Symbol">(</a><a id="8026" href="Games.OptimalPlays.html#7963" class="Bound">af</a> <a id="8029" href="Games.OptimalPlays.html#7989" class="Bound">x</a><a id="8030" class="Symbol">))</a>

<a id="8034" class="Keyword">open</a> <a id="8039" href="MonadOnTypes.NonEmptyList.html#2321" class="Module">Listâº-definitions</a>

<a id="8058" class="Markup">\end{code}</a><a id="8068" class="Background">

We now prove a couple of technical lemmas.

</a><a id="8114" class="Markup">\begin{code}</a>

<a id="8128" class="Keyword">module</a> <a id="8135" href="Games.OptimalPlays.html#8135" class="Module">_</a> <a id="8137" class="Symbol">{</a><a id="8138" href="Games.OptimalPlays.html#8138" class="Bound">X</a> <a id="8140" class="Symbol">:</a> <a id="8142" href="Notation.General.html#372" class="Function">Type</a><a id="8146" class="Symbol">}</a> <a id="8148" class="Symbol">{</a><a id="8149" href="Games.OptimalPlays.html#8149" class="Bound">Xf</a> <a id="8152" class="Symbol">:</a> <a id="8154" href="Games.OptimalPlays.html#8138" class="Bound">X</a> <a id="8156" class="Symbol">â†’</a> <a id="8158" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="8159" class="Symbol">}</a>
         <a id="8170" class="Symbol">(</a><a id="8171" href="Games.OptimalPlays.html#8171" class="Bound">eâº</a> <a id="8174" class="Symbol">:</a> <a id="8176" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="8179" href="Games.OptimalPlays.html#8138" class="Bound">X</a><a id="8180" class="Symbol">)</a>
         <a id="8191" class="Symbol">(</a><a id="8192" href="Games.OptimalPlays.html#8192" class="Bound">dâº</a> <a id="8195" class="Symbol">:</a> <a id="8197" class="Symbol">(</a><a id="8198" href="Games.OptimalPlays.html#8198" class="Bound">x</a> <a id="8200" class="Symbol">:</a> <a id="8202" href="Games.OptimalPlays.html#8138" class="Bound">X</a><a id="8203" class="Symbol">)</a> <a id="8205" class="Symbol">â†’</a> <a id="8207" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="8210" class="Symbol">(</a><a id="8211" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="8216" class="Symbol">(</a><a id="8217" href="Games.OptimalPlays.html#8149" class="Bound">Xf</a> <a id="8220" href="Games.OptimalPlays.html#8198" class="Bound">x</a><a id="8221" class="Symbol">)))</a>
         <a id="8234" class="Symbol">(</a><a id="8235" href="Games.OptimalPlays.html#8235" class="Bound">q</a> <a id="8237" class="Symbol">:</a> <a id="8239" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="8244" class="Symbol">(</a><a id="8245" href="Games.OptimalPlays.html#8138" class="Bound">X</a> <a id="8247" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="8249" href="Games.OptimalPlays.html#8149" class="Bound">Xf</a><a id="8251" class="Symbol">)</a>  <a id="8254" class="Symbol">â†’</a> <a id="8256" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="8257" class="Symbol">)</a>
       <a id="8266" class="Keyword">where</a>

 <a id="8274" class="Keyword">private</a>
  <a id="8284" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8286" class="Symbol">:</a> <a id="8288" class="Symbol">(</a><a id="8289" href="Games.OptimalPlays.html#8289" class="Bound">x</a> <a id="8291" class="Symbol">:</a> <a id="8293" href="Games.OptimalPlays.html#8138" class="Bound">X</a><a id="8294" class="Symbol">)</a> <a id="8296" class="Symbol">â†’</a> <a id="8298" href="MonadOnTypes.Monad.html#5068" class="Function">T</a> <a id="8300" class="Symbol">(</a><a id="8301" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="8306" class="Symbol">(</a><a id="8307" href="Games.OptimalPlays.html#8149" class="Bound">Xf</a> <a id="8310" href="Games.OptimalPlays.html#8289" class="Bound">x</a><a id="8311" class="Symbol">))</a>
  <a id="8316" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8318" href="Games.OptimalPlays.html#8318" class="Bound">x</a> <a id="8320" class="Symbol">=</a> <a id="8322" href="Games.OptimalPlays.html#8192" class="Bound">dâº</a> <a id="8325" href="Games.OptimalPlays.html#8318" class="Bound">x</a> <a id="8327" class="Symbol">(</a><a id="8328" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="8336" href="Games.OptimalPlays.html#8235" class="Bound">q</a> <a id="8338" href="Games.OptimalPlays.html#8318" class="Bound">x</a><a id="8339" class="Symbol">)</a>

  <a id="8344" href="Games.OptimalPlays.html#8344" class="Function">f</a> <a id="8346" class="Symbol">:</a> <a id="8348" href="Games.OptimalPlays.html#8138" class="Bound">X</a> <a id="8350" class="Symbol">â†’</a> <a id="8352" href="Games.OptimalPlays.html#596" class="Bound">R</a>
  <a id="8356" href="Games.OptimalPlays.html#8344" class="Function">f</a> <a id="8358" href="Games.OptimalPlays.html#8358" class="Bound">x</a> <a id="8360" class="Symbol">=</a> <a id="8362" href="MonadOnTypes.Monad.html#14835" class="Function">Î±-extáµ€</a> <a id="8369" class="Symbol">(</a><a id="8370" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="8378" href="Games.OptimalPlays.html#8235" class="Bound">q</a> <a id="8380" href="Games.OptimalPlays.html#8358" class="Bound">x</a><a id="8381" class="Symbol">)</a> <a id="8383" class="Symbol">(</a><a id="8384" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8386" href="Games.OptimalPlays.html#8358" class="Bound">x</a><a id="8387" class="Symbol">)</a>

  <a id="8392" href="Games.OptimalPlays.html#8392" class="Function">xt</a> <a id="8395" class="Symbol">:</a> <a id="8397" href="MonadOnTypes.Monad.html#5068" class="Function">T</a> <a id="8399" href="Games.OptimalPlays.html#8138" class="Bound">X</a>
  <a id="8403" href="Games.OptimalPlays.html#8392" class="Function">xt</a> <a id="8406" class="Symbol">=</a> <a id="8408" href="Games.OptimalPlays.html#8171" class="Bound">eâº</a> <a id="8411" href="Games.OptimalPlays.html#8344" class="Function">f</a>

  <a id="8416" href="Games.OptimalPlays.html#8416" class="Function">x</a> <a id="8418" class="Symbol">:</a> <a id="8420" href="Games.OptimalPlays.html#8138" class="Bound">X</a>
  <a id="8424" href="Games.OptimalPlays.html#8416" class="Function">x</a> <a id="8426" class="Symbol">=</a> <a id="8428" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8434" href="Games.OptimalPlays.html#8392" class="Function">xt</a>

  <a id="8440" href="Games.OptimalPlays.html#8440" class="Function">xs</a> <a id="8443" class="Symbol">:</a> <a id="8445" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="8450" class="Symbol">(</a><a id="8451" href="Games.OptimalPlays.html#8149" class="Bound">Xf</a> <a id="8454" href="Games.OptimalPlays.html#8416" class="Function">x</a><a id="8455" class="Symbol">)</a>
  <a id="8459" href="Games.OptimalPlays.html#8440" class="Function">xs</a> <a id="8462" class="Symbol">=</a> <a id="8464" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8470" class="Symbol">(</a><a id="8471" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8473" href="Games.OptimalPlays.html#8416" class="Function">x</a><a id="8474" class="Symbol">)</a>

 <a id="8478" href="Games.OptimalPlays.html#8478" class="Function">headâº-of-âŠ—á´¶áµ€</a> <a id="8491" class="Symbol">:</a> <a id="8493" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8499" class="Symbol">((</a><a id="8501" href="Games.OptimalPlays.html#8171" class="Bound">eâº</a> <a id="8504" href="MonadOnTypes.J-transf-variation.html#2694" class="Function Operator">âŠ—á´¶áµ€</a> <a id="8508" href="Games.OptimalPlays.html#8192" class="Bound">dâº</a><a id="8510" class="Symbol">)</a> <a id="8512" href="Games.OptimalPlays.html#8235" class="Bound">q</a><a id="8513" class="Symbol">)</a> <a id="8515" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="8517" href="Games.OptimalPlays.html#8416" class="Function">x</a> <a id="8519" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="8522" href="Games.OptimalPlays.html#8440" class="Function">xs</a>
 <a id="8526" href="Games.OptimalPlays.html#8478" class="Function">headâº-of-âŠ—á´¶áµ€</a> <a id="8539" class="Symbol">=</a>
  <a id="8543" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8549" class="Symbol">((</a><a id="8551" href="Games.OptimalPlays.html#8171" class="Bound">eâº</a> <a id="8554" href="MonadOnTypes.J-transf-variation.html#2694" class="Function Operator">âŠ—á´¶áµ€</a> <a id="8558" href="Games.OptimalPlays.html#8192" class="Bound">dâº</a><a id="8560" class="Symbol">)</a> <a id="8562" href="Games.OptimalPlays.html#8235" class="Bound">q</a><a id="8563" class="Symbol">)</a>                                         <a id="8605" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="8608" href="Games.OptimalPlays.html#9127" class="Function">I</a> <a id="8610" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
  <a id="8614" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8620" class="Symbol">(</a><a id="8621" href="Games.OptimalPlays.html#8392" class="Function">xt</a> <a id="8624" href="MonadOnTypes.NonEmptyList.html#2347" class="Function Operator">âŠ—á´¸âº</a> <a id="8628" href="Games.OptimalPlays.html#8284" class="Function">g</a><a id="8629" class="Symbol">)</a>                                              <a id="8676" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="8679" href="Games.OptimalPlays.html#9178" class="Function">II</a> <a id="8682" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
  <a id="8686" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8692" class="Symbol">(</a><a id="8693" href="MonadOnTypes.NonEmptyList.html#3050" class="Function">concatâº</a> <a id="8701" class="Symbol">(</a><a id="8702" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="8708" class="Symbol">(Î»</a> <a id="8711" href="Games.OptimalPlays.html#8711" class="Bound">x</a> <a id="8713" class="Symbol">â†’</a> <a id="8715" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="8721" class="Symbol">(Î»</a> <a id="8724" href="Games.OptimalPlays.html#8724" class="Bound">y</a> <a id="8726" class="Symbol">â†’</a> <a id="8728" href="Games.OptimalPlays.html#8711" class="Bound">x</a> <a id="8730" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="8733" href="Games.OptimalPlays.html#8724" class="Bound">y</a><a id="8734" class="Symbol">)</a> <a id="8736" class="Symbol">(</a><a id="8737" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8739" href="Games.OptimalPlays.html#8711" class="Bound">x</a><a id="8740" class="Symbol">))</a> <a id="8743" href="Games.OptimalPlays.html#8392" class="Function">xt</a><a id="8745" class="Symbol">))</a> <a id="8748" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="8751" href="Games.OptimalPlays.html#9226" class="Function">III</a> <a id="8755" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
  <a id="8759" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8765" class="Symbol">(</a><a id="8766" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8772" class="Symbol">(</a><a id="8773" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="8779" class="Symbol">(Î»</a> <a id="8782" href="Games.OptimalPlays.html#8782" class="Bound">x</a> <a id="8784" class="Symbol">â†’</a> <a id="8786" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="8792" class="Symbol">(Î»</a> <a id="8795" href="Games.OptimalPlays.html#8795" class="Bound">y</a> <a id="8797" class="Symbol">â†’</a> <a id="8799" href="Games.OptimalPlays.html#8782" class="Bound">x</a> <a id="8801" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="8804" href="Games.OptimalPlays.html#8795" class="Bound">y</a><a id="8805" class="Symbol">)</a> <a id="8807" class="Symbol">(</a><a id="8808" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8810" href="Games.OptimalPlays.html#8782" class="Bound">x</a><a id="8811" class="Symbol">))</a> <a id="8814" href="Games.OptimalPlays.html#8392" class="Function">xt</a><a id="8816" class="Symbol">))</a>   <a id="8821" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="8824" href="Games.OptimalPlays.html#9299" class="Function">IV</a> <a id="8827" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
  <a id="8831" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8837" class="Symbol">(</a><a id="8838" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="8844" class="Symbol">(</a><a id="8845" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8851" href="Games.OptimalPlays.html#8392" class="Function">xt</a> <a id="8854" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::_</a><a id="8857" class="Symbol">)</a> <a id="8859" class="Symbol">(</a><a id="8860" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8862" class="Symbol">(</a><a id="8863" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8869" href="Games.OptimalPlays.html#8392" class="Function">xt</a><a id="8871" class="Symbol">)))</a>                   <a id="8893" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="8896" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="8901" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
  <a id="8905" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8911" class="Symbol">(</a><a id="8912" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="8918" class="Symbol">(</a><a id="8919" href="Games.OptimalPlays.html#8416" class="Function">x</a> <a id="8921" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::_</a><a id="8924" class="Symbol">)</a> <a id="8926" class="Symbol">(</a><a id="8927" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8929" href="Games.OptimalPlays.html#8416" class="Function">x</a><a id="8930" class="Symbol">))</a>                                   <a id="8967" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="8970" href="Games.OptimalPlays.html#9373" class="Function">V</a> <a id="8972" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
  <a id="8976" href="Games.OptimalPlays.html#8416" class="Function">x</a> <a id="8978" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="8981" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="8987" class="Symbol">(</a><a id="8988" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="8990" href="Games.OptimalPlays.html#8416" class="Function">x</a><a id="8991" class="Symbol">)</a>                                              <a id="9038" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="9041" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="9046" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
  <a id="9050" href="Games.OptimalPlays.html#8416" class="Function">x</a> <a id="9052" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="9055" href="Games.OptimalPlays.html#8440" class="Function">xs</a>                                                       <a id="9112" href="MLTT.Id.html#2785" class="Function Operator">âˆ</a>
   <a id="9117" class="Keyword">where</a>
    <a id="9127" href="Games.OptimalPlays.html#9127" class="Function">I</a>   <a id="9131" class="Symbol">=</a> <a id="9133" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="9136" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="9142" class="Symbol">(</a><a id="9143" href="MonadOnTypes.J-transf-variation.html#4839" class="Function">âŠ—á´¶áµ€-in-terms-of-âŠ—áµ€</a> <a id="9162" href="Games.OptimalPlays.html#8171" class="Bound">eâº</a> <a id="9165" href="Games.OptimalPlays.html#8192" class="Bound">dâº</a> <a id="9168" href="Games.OptimalPlays.html#8235" class="Bound">q</a> <a id="9170" href="Games.OptimalPlays.html#573" class="Bound">fe</a><a id="9172" class="Symbol">)</a>
    <a id="9178" href="Games.OptimalPlays.html#9178" class="Function">II</a>  <a id="9182" class="Symbol">=</a> <a id="9184" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="9187" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="9193" class="Symbol">(</a><a id="9194" href="MonadOnTypes.NonEmptyList.html#3662" class="Function">âŠ—á´¸âº-explicitly</a> <a id="9209" href="Games.OptimalPlays.html#573" class="Bound">fe</a> <a id="9212" class="Symbol">(</a><a id="9213" href="Games.OptimalPlays.html#8171" class="Bound">eâº</a> <a id="9216" href="Games.OptimalPlays.html#8344" class="Function">f</a><a id="9217" class="Symbol">)</a> <a id="9219" href="Games.OptimalPlays.html#8284" class="Function">g</a><a id="9220" class="Symbol">)</a>
    <a id="9226" href="Games.OptimalPlays.html#9226" class="Function">III</a> <a id="9230" class="Symbol">=</a> <a id="9232" href="MonadOnTypes.NonEmptyList.html#5112" class="Function">headâº-of-concatâº</a> <a id="9249" class="Symbol">(</a><a id="9250" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="9256" class="Symbol">(Î»</a> <a id="9259" href="Games.OptimalPlays.html#9259" class="Bound">x</a> <a id="9261" class="Symbol">â†’</a> <a id="9263" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="9269" class="Symbol">(Î»</a> <a id="9272" href="Games.OptimalPlays.html#9272" class="Bound">y</a> <a id="9274" class="Symbol">â†’</a> <a id="9276" href="Games.OptimalPlays.html#9259" class="Bound">x</a> <a id="9278" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="9281" href="Games.OptimalPlays.html#9272" class="Bound">y</a><a id="9282" class="Symbol">)</a> <a id="9284" class="Symbol">(</a><a id="9285" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="9287" href="Games.OptimalPlays.html#9259" class="Bound">x</a><a id="9288" class="Symbol">))</a> <a id="9291" href="Games.OptimalPlays.html#8392" class="Function">xt</a><a id="9293" class="Symbol">)</a>
    <a id="9299" href="Games.OptimalPlays.html#9299" class="Function">IV</a>  <a id="9303" class="Symbol">=</a> <a id="9305" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="9308" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="9314" class="Symbol">(</a><a id="9315" href="MonadOnTypes.NonEmptyList.html#5319" class="Function">headâº-of-lmapâº</a> <a id="9330" class="Symbol">(Î»</a> <a id="9333" href="Games.OptimalPlays.html#9333" class="Bound">x</a> <a id="9335" class="Symbol">â†’</a> <a id="9337" href="MonadOnTypes.NonEmptyList.html#2666" class="Function">lmapâº</a> <a id="9343" class="Symbol">(Î»</a> <a id="9346" href="Games.OptimalPlays.html#9346" class="Bound">y</a> <a id="9348" class="Symbol">â†’</a> <a id="9350" href="Games.OptimalPlays.html#9333" class="Bound">x</a> <a id="9352" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="9355" href="Games.OptimalPlays.html#9346" class="Bound">y</a><a id="9356" class="Symbol">)</a> <a id="9358" class="Symbol">(</a><a id="9359" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="9361" href="Games.OptimalPlays.html#9333" class="Bound">x</a><a id="9362" class="Symbol">))</a> <a id="9365" href="Games.OptimalPlays.html#8392" class="Function">xt</a><a id="9367" class="Symbol">)</a>
    <a id="9373" href="Games.OptimalPlays.html#9373" class="Function">V</a>   <a id="9377" class="Symbol">=</a> <a id="9379" href="MonadOnTypes.NonEmptyList.html#5319" class="Function">headâº-of-lmapâº</a> <a id="9394" class="Symbol">(</a><a id="9395" href="Games.OptimalPlays.html#8416" class="Function">x</a> <a id="9397" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::_</a><a id="9400" class="Symbol">)</a> <a id="9402" class="Symbol">(</a><a id="9403" href="Games.OptimalPlays.html#8284" class="Function">g</a> <a id="9405" href="Games.OptimalPlays.html#8416" class="Function">x</a><a id="9406" class="Symbol">)</a>

<a id="JT-in-terms-of-K"></a><a id="9409" href="Games.OptimalPlays.html#9409" class="Function">JT-in-terms-of-K</a> <a id="9426" class="Symbol">:</a> <a id="9428" class="Symbol">(</a><a id="9429" href="Games.OptimalPlays.html#9429" class="Bound">Xt</a> <a id="9432" class="Symbol">:</a> <a id="9434" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="9435" class="Symbol">)</a>
                   <a id="9456" class="Symbol">(</a><a id="9457" href="Games.OptimalPlays.html#9457" class="Bound">Ï•t</a> <a id="9460" class="Symbol">:</a> <a id="9462" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="9464" href="Games.OptimalPlays.html#9429" class="Bound">Xt</a><a id="9466" class="Symbol">)</a>
                   <a id="9487" class="Symbol">(</a><a id="9488" href="Games.OptimalPlays.html#9488" class="Bound">q</a> <a id="9490" class="Symbol">:</a> <a id="9492" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="9497" href="Games.OptimalPlays.html#9429" class="Bound">Xt</a> <a id="9500" class="Symbol">â†’</a> <a id="9502" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="9503" class="Symbol">)</a>
                   <a id="9524" class="Symbol">(</a><a id="9525" href="Games.OptimalPlays.html#9525" class="Bound">Îµt</a> <a id="9528" class="Symbol">:</a> <a id="9530" href="Games.FiniteHistoryDependent.html#8970" class="Function">ğ“™</a> <a id="9532" href="Games.OptimalPlays.html#9429" class="Bound">Xt</a><a id="9534" class="Symbol">)</a>
                   <a id="9555" class="Symbol">(</a><a id="9556" href="Games.OptimalPlays.html#9556" class="Bound">at</a> <a id="9559" class="Symbol">:</a> <a id="9561" href="Games.OptimalPlays.html#9525" class="Bound">Îµt</a> <a id="9564" href="Games.FiniteHistoryDependent.html#10543" class="Function Operator">Attains</a> <a id="9572" href="Games.OptimalPlays.html#9457" class="Bound">Ï•t</a><a id="9574" class="Symbol">)</a>
                   <a id="9595" class="Symbol">(</a><a id="9596" href="Games.OptimalPlays.html#9596" class="Bound">lt</a> <a id="9599" class="Symbol">:</a> <a id="9601" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="9611" href="MLTT.List.html#6746" class="Function">listedâº</a> <a id="9619" href="Games.OptimalPlays.html#9429" class="Bound">Xt</a><a id="9621" class="Symbol">)</a>
                 <a id="9640" class="Symbol">â†’</a> <a id="9642" href="MonadOnTypes.Monad.html#14835" class="Function">Î±-extáµ€</a> <a id="9649" href="Games.OptimalPlays.html#9488" class="Bound">q</a> <a id="9651" class="Symbol">(</a><a id="9652" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="9666" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="9669" class="Symbol">(</a><a id="9670" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="9674" href="Games.OptimalPlays.html#9429" class="Bound">Xt</a> <a id="9677" href="Games.OptimalPlays.html#9596" class="Bound">lt</a> <a id="9680" href="Games.OptimalPlays.html#9457" class="Bound">Ï•t</a> <a id="9683" href="Games.OptimalPlays.html#9525" class="Bound">Îµt</a> <a id="9686" href="Games.OptimalPlays.html#9556" class="Bound">at</a><a id="9688" class="Symbol">)</a> <a id="9690" href="Games.OptimalPlays.html#9488" class="Bound">q</a><a id="9691" class="Symbol">)</a>
                 <a id="9710" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="9712" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="9726" class="Symbol">(</a><a id="9727" href="MonadOnTypes.K.html#184" class="Function">ğ•‚</a> <a id="9729" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="9730" class="Symbol">)</a> <a id="9732" href="Games.OptimalPlays.html#9457" class="Bound">Ï•t</a> <a id="9735" href="Games.OptimalPlays.html#9488" class="Bound">q</a>
<a id="9737" href="Games.OptimalPlays.html#9409" class="Function">JT-in-terms-of-K</a> <a id="9754" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a> <a id="9757" href="Games.OptimalPlays.html#9757" class="Bound">Ï•t</a> <a id="9760" href="Games.OptimalPlays.html#9760" class="Bound">q</a> <a id="9762" href="Games.OptimalPlays.html#9762" class="Bound">Îµt</a> <a id="9765" href="Games.OptimalPlays.html#9765" class="Bound">at</a> <a id="9768" href="Games.OptimalPlays.html#9768" class="Bound">lt</a> <a id="9771" class="Symbol">=</a> <a id="9773" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>
<a id="9778" href="Games.OptimalPlays.html#9409" class="Function">JT-in-terms-of-K</a> <a id="9795" href="Games.OptimalPlays.html#9795" class="Bound">Xt</a><a id="9797" class="Symbol">@(</a><a id="9799" href="Games.OptimalPlays.html#9799" class="Bound">X</a> <a id="9801" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="9803" href="Games.OptimalPlays.html#9803" class="Bound">Xf</a><a id="9805" class="Symbol">)</a> <a id="9807" href="Games.OptimalPlays.html#9807" class="Bound">Ï•t</a><a id="9809" class="Symbol">@(</a><a id="9811" href="Games.OptimalPlays.html#9811" class="Bound">Ï•</a> <a id="9813" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="9816" href="Games.OptimalPlays.html#9816" class="Bound">Ï•f</a><a id="9818" class="Symbol">)</a> <a id="9820" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="9822" href="Games.OptimalPlays.html#9822" class="Bound">Îµt</a><a id="9824" class="Symbol">@(</a><a id="9826" href="Games.OptimalPlays.html#9826" class="Bound">Îµ</a> <a id="9828" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="9831" href="Games.OptimalPlays.html#9831" class="Bound">Îµf</a><a id="9833" class="Symbol">)</a> <a id="9835" href="Games.OptimalPlays.html#9835" class="Bound">at</a><a id="9837" class="Symbol">@(</a><a id="9839" href="Games.OptimalPlays.html#9839" class="Bound">a</a> <a id="9841" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="9844" href="Games.OptimalPlays.html#9844" class="Bound">af</a><a id="9846" class="Symbol">)</a> <a id="9848" href="Games.OptimalPlays.html#9848" class="Bound">lt</a><a id="9850" class="Symbol">@(</a><a id="9852" href="Games.OptimalPlays.html#9852" class="Bound">l</a> <a id="9854" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="9857" href="Games.OptimalPlays.html#9857" class="Bound">lf</a><a id="9859" class="Symbol">)</a> <a id="9861" class="Symbol">=</a> <a id="9863" href="Games.OptimalPlays.html#10346" class="Function">II</a>
 <a id="9867" class="Keyword">where</a>
  <a id="9875" href="Games.OptimalPlays.html#9875" class="Function">dâº</a> <a id="9878" class="Symbol">:</a> <a id="9880" class="Symbol">(</a><a id="9881" href="Games.OptimalPlays.html#9881" class="Bound">x</a> <a id="9883" class="Symbol">:</a> <a id="9885" href="Games.OptimalPlays.html#9799" class="Bound">X</a><a id="9886" class="Symbol">)</a> <a id="9888" class="Symbol">â†’</a> <a id="9890" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="9893" class="Symbol">(</a><a id="9894" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="9899" class="Symbol">(</a><a id="9900" href="Games.OptimalPlays.html#9803" class="Bound">Xf</a> <a id="9903" href="Games.OptimalPlays.html#9881" class="Bound">x</a><a id="9904" class="Symbol">))</a>
  <a id="9909" href="Games.OptimalPlays.html#9875" class="Function">dâº</a> <a id="9912" href="Games.OptimalPlays.html#9912" class="Bound">x</a> <a id="9914" class="Symbol">=</a> <a id="9916" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="9930" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="9933" class="Symbol">(</a><a id="9934" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="9938" class="Symbol">(</a><a id="9939" href="Games.OptimalPlays.html#9803" class="Bound">Xf</a> <a id="9942" href="Games.OptimalPlays.html#9912" class="Bound">x</a><a id="9943" class="Symbol">)</a> <a id="9945" class="Symbol">(</a><a id="9946" href="Games.OptimalPlays.html#9857" class="Bound">lf</a> <a id="9949" href="Games.OptimalPlays.html#9912" class="Bound">x</a><a id="9950" class="Symbol">)</a> <a id="9952" class="Symbol">(</a><a id="9953" href="Games.OptimalPlays.html#9816" class="Bound">Ï•f</a> <a id="9956" href="Games.OptimalPlays.html#9912" class="Bound">x</a><a id="9957" class="Symbol">)</a> <a id="9959" class="Symbol">(</a><a id="9960" href="Games.OptimalPlays.html#9831" class="Bound">Îµf</a> <a id="9963" href="Games.OptimalPlays.html#9912" class="Bound">x</a><a id="9964" class="Symbol">)</a> <a id="9966" class="Symbol">(</a><a id="9967" href="Games.OptimalPlays.html#9844" class="Bound">af</a> <a id="9970" href="Games.OptimalPlays.html#9912" class="Bound">x</a><a id="9971" class="Symbol">))</a>

  <a id="9977" href="Games.OptimalPlays.html#9977" class="Function">f</a> <a id="9979" class="Symbol">:</a> <a id="9981" class="Symbol">(</a><a id="9982" href="Games.OptimalPlays.html#9982" class="Bound">x</a> <a id="9984" class="Symbol">:</a> <a id="9986" href="Games.OptimalPlays.html#9799" class="Bound">X</a><a id="9987" class="Symbol">)</a> <a id="9989" class="Symbol">â†’</a> <a id="9991" href="MonadOnTypes.NonEmptyList.html#514" class="Function">Listâº</a> <a id="9997" class="Symbol">(</a><a id="9998" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="10003" class="Symbol">(</a><a id="10004" href="Games.OptimalPlays.html#9803" class="Bound">Xf</a> <a id="10007" href="Games.OptimalPlays.html#9982" class="Bound">x</a><a id="10008" class="Symbol">))</a>
  <a id="10013" href="Games.OptimalPlays.html#9977" class="Function">f</a> <a id="10015" href="Games.OptimalPlays.html#10015" class="Bound">x</a> <a id="10017" class="Symbol">=</a> <a id="10019" href="Games.OptimalPlays.html#9875" class="Function">dâº</a> <a id="10022" href="Games.OptimalPlays.html#10015" class="Bound">x</a> <a id="10024" class="Symbol">(</a><a id="10025" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="10033" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10035" href="Games.OptimalPlays.html#10015" class="Bound">x</a><a id="10036" class="Symbol">)</a>

  <a id="10041" href="Games.OptimalPlays.html#10041" class="Function">p</a> <a id="10043" class="Symbol">:</a> <a id="10045" href="Games.OptimalPlays.html#9799" class="Bound">X</a> <a id="10047" class="Symbol">â†’</a> <a id="10049" href="Games.OptimalPlays.html#596" class="Bound">R</a>
  <a id="10053" href="Games.OptimalPlays.html#10041" class="Function">p</a> <a id="10055" href="Games.OptimalPlays.html#10055" class="Bound">x</a> <a id="10057" class="Symbol">=</a> <a id="10059" href="MonadOnTypes.Monad.html#14835" class="Function">Î±-extáµ€</a> <a id="10066" class="Symbol">(</a><a id="10067" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="10075" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10077" href="Games.OptimalPlays.html#10055" class="Bound">x</a><a id="10078" class="Symbol">)</a> <a id="10080" class="Symbol">(</a><a id="10081" href="Games.OptimalPlays.html#9977" class="Function">f</a> <a id="10083" href="Games.OptimalPlays.html#10055" class="Bound">x</a><a id="10084" class="Symbol">)</a>

  <a id="10089" href="Games.OptimalPlays.html#10089" class="Function">IH</a> <a id="10092" class="Symbol">:</a> <a id="10094" class="Symbol">(</a><a id="10095" href="Games.OptimalPlays.html#10095" class="Bound">x</a> <a id="10097" class="Symbol">:</a> <a id="10099" href="Games.OptimalPlays.html#9799" class="Bound">X</a><a id="10100" class="Symbol">)</a> <a id="10102" class="Symbol">â†’</a> <a id="10104" href="Games.OptimalPlays.html#10041" class="Function">p</a> <a id="10106" href="Games.OptimalPlays.html#10095" class="Bound">x</a> <a id="10108" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="10110" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="10124" class="Symbol">(</a><a id="10125" href="MonadOnTypes.K.html#184" class="Function">ğ•‚</a> <a id="10127" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="10128" class="Symbol">)</a> <a id="10130" class="Symbol">(</a><a id="10131" href="Games.OptimalPlays.html#9816" class="Bound">Ï•f</a> <a id="10134" href="Games.OptimalPlays.html#10095" class="Bound">x</a><a id="10135" class="Symbol">)</a> <a id="10137" class="Symbol">(</a><a id="10138" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="10146" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10148" href="Games.OptimalPlays.html#10095" class="Bound">x</a><a id="10149" class="Symbol">)</a>
  <a id="10153" href="Games.OptimalPlays.html#10089" class="Function">IH</a> <a id="10156" href="Games.OptimalPlays.html#10156" class="Bound">x</a> <a id="10158" class="Symbol">=</a> <a id="10160" href="Games.OptimalPlays.html#9409" class="Function">JT-in-terms-of-K</a> <a id="10177" class="Symbol">(</a><a id="10178" href="Games.OptimalPlays.html#9803" class="Bound">Xf</a> <a id="10181" href="Games.OptimalPlays.html#10156" class="Bound">x</a><a id="10182" class="Symbol">)</a> <a id="10184" class="Symbol">(</a><a id="10185" href="Games.OptimalPlays.html#9816" class="Bound">Ï•f</a> <a id="10188" href="Games.OptimalPlays.html#10156" class="Bound">x</a><a id="10189" class="Symbol">)</a> <a id="10191" class="Symbol">(</a><a id="10192" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="10200" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10202" href="Games.OptimalPlays.html#10156" class="Bound">x</a><a id="10203" class="Symbol">)</a> <a id="10205" class="Symbol">(</a><a id="10206" href="Games.OptimalPlays.html#9831" class="Bound">Îµf</a> <a id="10209" href="Games.OptimalPlays.html#10156" class="Bound">x</a><a id="10210" class="Symbol">)</a> <a id="10212" class="Symbol">(</a><a id="10213" href="Games.OptimalPlays.html#9844" class="Bound">af</a> <a id="10216" href="Games.OptimalPlays.html#10156" class="Bound">x</a><a id="10217" class="Symbol">)</a> <a id="10219" class="Symbol">(</a><a id="10220" href="Games.OptimalPlays.html#9857" class="Bound">lf</a> <a id="10223" href="Games.OptimalPlays.html#10156" class="Bound">x</a><a id="10224" class="Symbol">)</a>

  <a id="10229" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10232" class="Symbol">:</a> <a id="10234" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="10237" href="Games.OptimalPlays.html#9799" class="Bound">X</a>
  <a id="10241" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10244" class="Symbol">=</a> <a id="10246" href="Games.OptimalPlays.html#7599" class="Function">Îµâº</a> <a id="10249" href="Games.OptimalPlays.html#9799" class="Bound">X</a> <a id="10251" href="Games.OptimalPlays.html#9852" class="Bound">l</a> <a id="10253" href="Games.OptimalPlays.html#9811" class="Bound">Ï•</a> <a id="10255" href="Games.OptimalPlays.html#9826" class="Bound">Îµ</a> <a id="10257" href="Games.OptimalPlays.html#9839" class="Bound">a</a>

  <a id="10262" href="Games.OptimalPlays.html#10262" class="Function">x</a> <a id="10264" class="Symbol">:</a> <a id="10266" href="Games.OptimalPlays.html#9799" class="Bound">X</a>
  <a id="10270" href="Games.OptimalPlays.html#10262" class="Function">x</a> <a id="10272" class="Symbol">=</a> <a id="10274" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="10280" class="Symbol">(</a><a id="10281" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10284" href="Games.OptimalPlays.html#10041" class="Function">p</a><a id="10285" class="Symbol">)</a>

  <a id="10290" href="Games.OptimalPlays.html#10290" class="Function">I</a> <a id="10292" class="Symbol">:</a> <a id="10294" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="10301" href="Games.OptimalPlays.html#10262" class="Function">x</a> <a id="10303" class="Symbol">(</a><a id="10304" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="10306" class="Symbol">(</a><a id="10307" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10310" href="Games.OptimalPlays.html#10041" class="Function">p</a><a id="10311" class="Symbol">))</a>
  <a id="10316" href="Games.OptimalPlays.html#10290" class="Function">I</a> <a id="10318" class="Symbol">=</a> <a id="10320" href="MonadOnTypes.NonEmptyList.html#1327" class="Function">headâº-is-member</a> <a id="10336" class="Symbol">(</a><a id="10337" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10340" href="Games.OptimalPlays.html#10041" class="Function">p</a><a id="10341" class="Symbol">)</a>

  <a id="10346" href="Games.OptimalPlays.html#10346" class="Function">II</a> <a id="10349" class="Symbol">=</a> <a id="10351" href="MonadOnTypes.Monad.html#14835" class="Function">Î±-extáµ€</a> <a id="10358" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10360" class="Symbol">((</a><a id="10362" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10365" href="MonadOnTypes.J-transf-variation.html#2694" class="Function Operator">âŠ—á´¶áµ€</a> <a id="10369" href="Games.OptimalPlays.html#9875" class="Function">dâº</a><a id="10371" class="Symbol">)</a> <a id="10373" href="Games.OptimalPlays.html#9820" class="Bound">q</a><a id="10374" class="Symbol">)</a>                           <a id="10402" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="10405" href="Games.OptimalPlays.html#10830" class="Function">IIâ‚€</a> <a id="10409" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
       <a id="10418" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10420" class="Symbol">(</a><a id="10421" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="10427" class="Symbol">((</a><a id="10429" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10432" href="MonadOnTypes.J-transf-variation.html#2694" class="Function Operator">âŠ—á´¶áµ€</a> <a id="10436" href="Games.OptimalPlays.html#9875" class="Function">dâº</a><a id="10438" class="Symbol">)</a> <a id="10440" href="Games.OptimalPlays.html#9820" class="Bound">q</a><a id="10441" class="Symbol">))</a>                          <a id="10469" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="10472" href="Games.OptimalPlays.html#10885" class="Function">IIâ‚</a> <a id="10476" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
       <a id="10485" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10487" class="Symbol">(</a><a id="10488" href="Games.OptimalPlays.html#10262" class="Function">x</a> <a id="10490" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="10493" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="10499" class="Symbol">(</a><a id="10500" href="Games.OptimalPlays.html#9977" class="Function">f</a> <a id="10502" href="Games.OptimalPlays.html#10262" class="Function">x</a><a id="10503" class="Symbol">))</a>                               <a id="10536" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="10539" href="Games.OptimalPlays.html#10928" class="Function">IIâ‚‚</a> <a id="10543" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
       <a id="10552" href="Games.OptimalPlays.html#10041" class="Function">p</a> <a id="10554" href="Games.OptimalPlays.html#10262" class="Function">x</a>                                                <a id="10603" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="10606" href="Games.OptimalPlays.html#10985" class="Function">IIâ‚ƒ</a> <a id="10610" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
       <a id="10619" href="Games.OptimalPlays.html#9811" class="Bound">Ï•</a> <a id="10621" href="Games.OptimalPlays.html#10041" class="Function">p</a>                                                <a id="10670" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="10673" href="Games.OptimalPlays.html#11025" class="Function">IIâ‚„</a> <a id="10677" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
       <a id="10686" href="Games.OptimalPlays.html#9811" class="Bound">Ï•</a> <a id="10688" class="Symbol">(Î»</a> <a id="10691" href="Games.OptimalPlays.html#10691" class="Bound">x</a> <a id="10693" class="Symbol">â†’</a> <a id="10695" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="10709" class="Symbol">(</a><a id="10710" href="MonadOnTypes.K.html#184" class="Function">ğ•‚</a> <a id="10712" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="10713" class="Symbol">)</a> <a id="10715" class="Symbol">(</a><a id="10716" href="Games.OptimalPlays.html#9816" class="Bound">Ï•f</a> <a id="10719" href="Games.OptimalPlays.html#10691" class="Bound">x</a><a id="10720" class="Symbol">)</a> <a id="10722" class="Symbol">(</a><a id="10723" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="10731" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10733" href="Games.OptimalPlays.html#10691" class="Bound">x</a><a id="10734" class="Symbol">))</a> <a id="10737" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="10740" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="10745" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
       <a id="10754" class="Symbol">(</a><a id="10755" href="Games.OptimalPlays.html#9811" class="Bound">Ï•</a> <a id="10757" href="MonadOnTypes.Monad.html#4201" class="Function">âŠ—[</a> <a id="10760" href="MonadOnTypes.K.html#184" class="Function">ğ•‚</a> <a id="10762" href="Games.OptimalPlays.html#596" class="Bound">R</a> <a id="10764" href="MonadOnTypes.Monad.html#4201" class="Function">]</a> <a id="10766" class="Symbol">(Î»</a> <a id="10769" href="Games.OptimalPlays.html#10769" class="Bound">x</a> <a id="10771" class="Symbol">â†’</a> <a id="10773" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="10787" class="Symbol">(</a><a id="10788" href="MonadOnTypes.K.html#184" class="Function">ğ•‚</a> <a id="10790" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="10791" class="Symbol">)</a> <a id="10793" class="Symbol">(</a><a id="10794" href="Games.OptimalPlays.html#9816" class="Bound">Ï•f</a> <a id="10797" href="Games.OptimalPlays.html#10769" class="Bound">x</a><a id="10798" class="Symbol">)))</a> <a id="10802" href="Games.OptimalPlays.html#9820" class="Bound">q</a>  <a id="10805" href="MLTT.Id.html#2785" class="Function Operator">âˆ</a>
        <a id="10815" class="Keyword">where</a>
         <a id="10830" href="Games.OptimalPlays.html#10830" class="Function">IIâ‚€</a> <a id="10834" class="Symbol">=</a> <a id="10836" href="Games.OptimalPlays.html#6186" class="Function">Î±-extáµ€-explicitly</a> <a id="10854" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10856" class="Symbol">((</a><a id="10858" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10861" href="MonadOnTypes.Monad.html#4201" class="Function">âŠ—[</a> <a id="10864" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="10867" href="MonadOnTypes.Monad.html#4201" class="Function">]</a> <a id="10869" href="Games.OptimalPlays.html#9875" class="Function">dâº</a><a id="10871" class="Symbol">)</a> <a id="10873" href="Games.OptimalPlays.html#9820" class="Bound">q</a><a id="10874" class="Symbol">)</a>
         <a id="10885" href="Games.OptimalPlays.html#10885" class="Function">IIâ‚</a> <a id="10889" class="Symbol">=</a> <a id="10891" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="10894" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10896" class="Symbol">(</a><a id="10897" href="Games.OptimalPlays.html#8478" class="Function">headâº-of-âŠ—á´¶áµ€</a> <a id="10910" href="Games.OptimalPlays.html#10229" class="Function">eâº</a> <a id="10913" href="Games.OptimalPlays.html#9875" class="Function">dâº</a> <a id="10916" href="Games.OptimalPlays.html#9820" class="Bound">q</a><a id="10917" class="Symbol">)</a>
         <a id="10928" href="Games.OptimalPlays.html#10928" class="Function">IIâ‚‚</a> <a id="10932" class="Symbol">=</a> <a id="10934" class="Symbol">(</a><a id="10935" href="Games.OptimalPlays.html#6186" class="Function">Î±-extáµ€-explicitly</a> <a id="10953" class="Symbol">(</a><a id="10954" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="10962" href="Games.OptimalPlays.html#9820" class="Bound">q</a> <a id="10964" href="Games.OptimalPlays.html#10262" class="Function">x</a><a id="10965" class="Symbol">)</a> <a id="10967" class="Symbol">(</a><a id="10968" href="Games.OptimalPlays.html#9977" class="Function">f</a> <a id="10970" href="Games.OptimalPlays.html#10262" class="Function">x</a><a id="10971" class="Symbol">))</a><a id="10973" href="MLTT.Id.html#1055" class="Function Operator">â»Â¹</a>
         <a id="10985" href="Games.OptimalPlays.html#10985" class="Function">IIâ‚ƒ</a> <a id="10989" class="Symbol">=</a> <a id="10991" href="Games.OptimalPlays.html#7000" class="Function">Îµá´¸-propertyâ†’</a> <a id="11004" href="Games.OptimalPlays.html#9799" class="Bound">X</a> <a id="11006" href="Games.OptimalPlays.html#9852" class="Bound">l</a> <a id="11008" href="Games.OptimalPlays.html#9811" class="Bound">Ï•</a> <a id="11010" href="Games.OptimalPlays.html#10041" class="Function">p</a> <a id="11012" href="Games.OptimalPlays.html#10262" class="Function">x</a> <a id="11014" href="Games.OptimalPlays.html#10290" class="Function">I</a>
         <a id="11025" href="Games.OptimalPlays.html#11025" class="Function">IIâ‚„</a> <a id="11029" class="Symbol">=</a> <a id="11031" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="11034" href="Games.OptimalPlays.html#9811" class="Bound">Ï•</a> <a id="11036" class="Symbol">(</a><a id="11037" href="UF.FunExt.html#1242" class="Function">dfunext</a> <a id="11045" href="Games.OptimalPlays.html#573" class="Bound">fe</a> <a id="11048" href="Games.OptimalPlays.html#10089" class="Function">IH</a><a id="11050" class="Symbol">)</a>

<a id="11053" class="Markup">\end{code}</a><a id="11063" class="Background">

We now show that path-sequence ğ•ğ•‹ computes the non-empty list of all
optimal plays.

</a><a id="11150" class="Markup">\begin{code}</a>

<a id="main-lemmaâ†’"></a><a id="11164" href="Games.OptimalPlays.html#11164" class="Function">main-lemmaâ†’</a> <a id="11176" class="Symbol">:</a> <a id="11178" class="Symbol">(</a><a id="11179" href="Games.OptimalPlays.html#11179" class="Bound">Xt</a> <a id="11182" class="Symbol">:</a> <a id="11184" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="11185" class="Symbol">)</a>
              <a id="11201" class="Symbol">(</a><a id="11202" href="Games.OptimalPlays.html#11202" class="Bound">Ï•t</a> <a id="11205" class="Symbol">:</a> <a id="11207" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="11209" href="Games.OptimalPlays.html#11179" class="Bound">Xt</a><a id="11211" class="Symbol">)</a>
              <a id="11227" class="Symbol">(</a><a id="11228" href="Games.OptimalPlays.html#11228" class="Bound">q</a> <a id="11230" class="Symbol">:</a> <a id="11232" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="11237" href="Games.OptimalPlays.html#11179" class="Bound">Xt</a> <a id="11240" class="Symbol">â†’</a> <a id="11242" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="11243" class="Symbol">)</a>
              <a id="11259" class="Symbol">(</a><a id="11260" href="Games.OptimalPlays.html#11260" class="Bound">Îµt</a> <a id="11263" class="Symbol">:</a> <a id="11265" href="Games.FiniteHistoryDependent.html#8970" class="Function">ğ“™</a> <a id="11267" href="Games.OptimalPlays.html#11179" class="Bound">Xt</a><a id="11269" class="Symbol">)</a>
              <a id="11285" class="Symbol">(</a><a id="11286" href="Games.OptimalPlays.html#11286" class="Bound">at</a> <a id="11289" class="Symbol">:</a> <a id="11291" href="Games.OptimalPlays.html#11260" class="Bound">Îµt</a> <a id="11294" href="Games.FiniteHistoryDependent.html#10543" class="Function Operator">Attains</a> <a id="11302" href="Games.OptimalPlays.html#11202" class="Bound">Ï•t</a><a id="11304" class="Symbol">)</a>
              <a id="11320" class="Symbol">(</a><a id="11321" href="Games.OptimalPlays.html#11321" class="Bound">lt</a> <a id="11324" class="Symbol">:</a> <a id="11326" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="11336" href="MLTT.List.html#6746" class="Function">listedâº</a> <a id="11344" href="Games.OptimalPlays.html#11179" class="Bound">Xt</a><a id="11346" class="Symbol">)</a>
              <a id="11362" class="Symbol">(</a><a id="11363" href="Games.OptimalPlays.html#11363" class="Bound">xs</a> <a id="11366" class="Symbol">:</a> <a id="11368" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="11373" href="Games.OptimalPlays.html#11179" class="Bound">Xt</a><a id="11375" class="Symbol">)</a>
            <a id="11389" class="Symbol">â†’</a> <a id="11391" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="11398" href="Games.OptimalPlays.html#11363" class="Bound">xs</a> <a id="11401" class="Symbol">(</a><a id="11402" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="11404" class="Symbol">(</a><a id="11405" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="11419" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="11422" class="Symbol">(</a><a id="11423" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="11427" href="Games.OptimalPlays.html#11179" class="Bound">Xt</a> <a id="11430" href="Games.OptimalPlays.html#11321" class="Bound">lt</a> <a id="11433" href="Games.OptimalPlays.html#11202" class="Bound">Ï•t</a> <a id="11436" href="Games.OptimalPlays.html#11260" class="Bound">Îµt</a> <a id="11439" href="Games.OptimalPlays.html#11286" class="Bound">at</a><a id="11441" class="Symbol">)</a> <a id="11443" href="Games.OptimalPlays.html#11228" class="Bound">q</a><a id="11444" class="Symbol">))</a>
            <a id="11459" class="Symbol">â†’</a> <a id="11461" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="11477" href="Games.OptimalPlays.html#11202" class="Bound">Ï•t</a> <a id="11480" href="Games.OptimalPlays.html#11228" class="Bound">q</a> <a id="11482" href="Games.OptimalPlays.html#11363" class="Bound">xs</a>
<a id="11485" href="Games.OptimalPlays.html#11164" class="Function">main-lemmaâ†’</a> <a id="11497" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a> <a id="11500" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="11503" href="Games.OptimalPlays.html#11503" class="Bound">q</a> <a id="11505" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="11508" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="11511" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="11514" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="11517" href="MLTT.List.html#3461" class="InductiveConstructor">in-head</a> <a id="11525" class="Symbol">=</a> <a id="11527" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>
<a id="11530" href="Games.OptimalPlays.html#11164" class="Function">main-lemmaâ†’</a> <a id="11542" href="Games.OptimalPlays.html#11542" class="Bound">Xt</a><a id="11544" class="Symbol">@(</a><a id="11546" href="Games.OptimalPlays.html#11546" class="Bound">X</a> <a id="11548" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="11550" href="Games.OptimalPlays.html#11550" class="Bound">Xf</a><a id="11552" class="Symbol">)</a> <a id="11554" href="Games.OptimalPlays.html#11554" class="Bound">Ï•t</a><a id="11556" class="Symbol">@(</a><a id="11558" href="Games.OptimalPlays.html#11558" class="Bound">Ï•</a> <a id="11560" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="11563" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a><a id="11565" class="Symbol">)</a> <a id="11567" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="11569" href="Games.OptimalPlays.html#11569" class="Bound">Îµt</a><a id="11571" class="Symbol">@(</a><a id="11573" href="Games.OptimalPlays.html#11573" class="Bound">Îµ</a> <a id="11575" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="11578" href="Games.OptimalPlays.html#11578" class="Bound">Îµf</a><a id="11580" class="Symbol">)</a> <a id="11582" href="Games.OptimalPlays.html#11582" class="Bound">at</a><a id="11584" class="Symbol">@(</a><a id="11586" href="Games.OptimalPlays.html#11586" class="Bound">a</a> <a id="11588" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="11591" href="Games.OptimalPlays.html#11591" class="Bound">af</a><a id="11593" class="Symbol">)</a>
            <a id="11607" href="Games.OptimalPlays.html#11607" class="Bound">lt</a><a id="11609" class="Symbol">@(</a><a id="11611" href="Games.OptimalPlays.html#11611" class="Bound">l</a> <a id="11613" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="11616" href="Games.OptimalPlays.html#11616" class="Bound">lf</a><a id="11618" class="Symbol">)</a> <a id="11620" class="Symbol">(</a><a id="11621" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="11623" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="11626" href="Games.OptimalPlays.html#11626" class="Bound">xs</a><a id="11628" class="Symbol">)</a> <a id="11630" href="Games.OptimalPlays.html#11630" class="Bound">m</a> <a id="11632" class="Symbol">=</a>
 <a id="11635" href="Games.OptimalPlays.html#12678" class="Function">head-is-optimal-move</a> <a id="11656" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="11658" href="Games.OptimalPlays.html#13058" class="Function">tail-is-optimal-play</a>
 <a id="11680" class="Keyword">where</a>
  <a id="11688" href="Games.OptimalPlays.html#11688" class="Function">eâº</a> <a id="11691" class="Symbol">:</a> <a id="11693" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="11696" href="Games.OptimalPlays.html#11546" class="Bound">X</a>
  <a id="11700" href="Games.OptimalPlays.html#11688" class="Function">eâº</a> <a id="11703" class="Symbol">=</a> <a id="11705" href="Games.OptimalPlays.html#7599" class="Function">Îµâº</a> <a id="11708" href="Games.OptimalPlays.html#11546" class="Bound">X</a> <a id="11710" href="Games.OptimalPlays.html#11611" class="Bound">l</a> <a id="11712" href="Games.OptimalPlays.html#11558" class="Bound">Ï•</a> <a id="11714" href="Games.OptimalPlays.html#11573" class="Bound">Îµ</a> <a id="11716" href="Games.OptimalPlays.html#11586" class="Bound">a</a>

  <a id="11721" href="Games.OptimalPlays.html#11721" class="Function">dâº</a> <a id="11724" class="Symbol">:</a> <a id="11726" class="Symbol">(</a><a id="11727" href="Games.OptimalPlays.html#11727" class="Bound">x</a> <a id="11729" class="Symbol">:</a> <a id="11731" href="Games.OptimalPlays.html#11546" class="Bound">X</a><a id="11732" class="Symbol">)</a> <a id="11734" class="Symbol">â†’</a> <a id="11736" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="11739" class="Symbol">(</a><a id="11740" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="11745" class="Symbol">(</a><a id="11746" href="Games.OptimalPlays.html#11550" class="Bound">Xf</a> <a id="11749" href="Games.OptimalPlays.html#11727" class="Bound">x</a><a id="11750" class="Symbol">))</a>
  <a id="11755" href="Games.OptimalPlays.html#11721" class="Function">dâº</a> <a id="11758" href="Games.OptimalPlays.html#11758" class="Bound">x</a> <a id="11760" class="Symbol">=</a> <a id="11762" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="11776" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="11779" class="Symbol">(</a><a id="11780" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="11784" class="Symbol">(</a><a id="11785" href="Games.OptimalPlays.html#11550" class="Bound">Xf</a> <a id="11788" href="Games.OptimalPlays.html#11758" class="Bound">x</a><a id="11789" class="Symbol">)</a> <a id="11791" class="Symbol">(</a><a id="11792" href="Games.OptimalPlays.html#11616" class="Bound">lf</a> <a id="11795" href="Games.OptimalPlays.html#11758" class="Bound">x</a><a id="11796" class="Symbol">)</a> <a id="11798" class="Symbol">(</a><a id="11799" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a> <a id="11802" href="Games.OptimalPlays.html#11758" class="Bound">x</a><a id="11803" class="Symbol">)</a> <a id="11805" class="Symbol">(</a><a id="11806" href="Games.OptimalPlays.html#11578" class="Bound">Îµf</a> <a id="11809" href="Games.OptimalPlays.html#11758" class="Bound">x</a><a id="11810" class="Symbol">)</a> <a id="11812" class="Symbol">(</a><a id="11813" href="Games.OptimalPlays.html#11591" class="Bound">af</a> <a id="11816" href="Games.OptimalPlays.html#11758" class="Bound">x</a><a id="11817" class="Symbol">))</a>

  <a id="11823" href="Games.OptimalPlays.html#11823" class="Function">t</a> <a id="11825" class="Symbol">:</a> <a id="11827" href="MonadOnTypes.NonEmptyList.html#514" class="Function">Listâº</a> <a id="11833" href="Games.OptimalPlays.html#11546" class="Bound">X</a>
  <a id="11837" href="Games.OptimalPlays.html#11823" class="Function">t</a> <a id="11839" class="Symbol">=</a> <a id="11841" href="MonadOnTypes.J-transf-variation.html#3331" class="Function">Ï„</a> <a id="11843" href="Games.OptimalPlays.html#11688" class="Function">eâº</a> <a id="11846" href="Games.OptimalPlays.html#11721" class="Function">dâº</a> <a id="11849" href="Games.OptimalPlays.html#11567" class="Bound">q</a>

  <a id="11854" href="Games.OptimalPlays.html#11854" class="Function">tf</a> <a id="11857" class="Symbol">:</a> <a id="11859" class="Symbol">(</a><a id="11860" href="Games.OptimalPlays.html#11860" class="Bound">x</a> <a id="11862" class="Symbol">:</a> <a id="11864" href="Games.OptimalPlays.html#11546" class="Bound">X</a><a id="11865" class="Symbol">)</a> <a id="11867" class="Symbol">â†’</a> <a id="11869" href="MonadOnTypes.Monad.html#5068" class="Function">T</a> <a id="11871" class="Symbol">(</a><a id="11872" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="11877" class="Symbol">(</a><a id="11878" href="Games.OptimalPlays.html#11550" class="Bound">Xf</a> <a id="11881" href="Games.OptimalPlays.html#11860" class="Bound">x</a><a id="11882" class="Symbol">))</a>
  <a id="11887" href="Games.OptimalPlays.html#11854" class="Function">tf</a> <a id="11890" href="Games.OptimalPlays.html#11890" class="Bound">x</a> <a id="11892" class="Symbol">=</a> <a id="11894" href="Games.OptimalPlays.html#11721" class="Function">dâº</a> <a id="11897" href="Games.OptimalPlays.html#11890" class="Bound">x</a> <a id="11899" class="Symbol">(</a><a id="11900" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="11908" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="11910" href="Games.OptimalPlays.html#11890" class="Bound">x</a><a id="11911" class="Symbol">)</a>

  <a id="11916" href="Games.OptimalPlays.html#11916" class="Function">p</a> <a id="11918" class="Symbol">:</a> <a id="11920" href="Games.OptimalPlays.html#11546" class="Bound">X</a> <a id="11922" class="Symbol">â†’</a> <a id="11924" href="Games.OptimalPlays.html#596" class="Bound">R</a>
  <a id="11928" href="Games.OptimalPlays.html#11916" class="Function">p</a> <a id="11930" href="Games.OptimalPlays.html#11930" class="Bound">x</a> <a id="11932" class="Symbol">=</a> <a id="11934" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="11948" class="Symbol">(</a><a id="11949" href="MonadOnTypes.K.html#184" class="Function">ğ•‚</a> <a id="11951" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="11952" class="Symbol">)</a> <a id="11954" class="Symbol">(</a><a id="11955" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a> <a id="11958" href="Games.OptimalPlays.html#11930" class="Bound">x</a><a id="11959" class="Symbol">)</a> <a id="11961" class="Symbol">(</a><a id="11962" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="11970" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="11972" href="Games.OptimalPlays.html#11930" class="Bound">x</a><a id="11973" class="Symbol">)</a>

  <a id="11978" href="Games.OptimalPlays.html#11978" class="Function">p&#39;</a> <a id="11981" class="Symbol">:</a> <a id="11983" href="Games.OptimalPlays.html#11546" class="Bound">X</a> <a id="11985" class="Symbol">â†’</a> <a id="11987" href="Games.OptimalPlays.html#596" class="Bound">R</a>
  <a id="11991" href="Games.OptimalPlays.html#11978" class="Function">p&#39;</a> <a id="11994" href="Games.OptimalPlays.html#11994" class="Bound">x</a> <a id="11996" class="Symbol">=</a> <a id="11998" href="MonadOnTypes.Monad.html#14835" class="Function">Î±-extáµ€</a>
          <a id="12015" class="Symbol">(</a><a id="12016" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="12024" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="12026" href="Games.OptimalPlays.html#11994" class="Bound">x</a><a id="12027" class="Symbol">)</a>
          <a id="12039" class="Symbol">(</a><a id="12040" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="12054" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a>
            <a id="12069" class="Symbol">(</a><a id="12070" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="12074" class="Symbol">(</a><a id="12075" href="Games.OptimalPlays.html#11550" class="Bound">Xf</a> <a id="12078" href="Games.OptimalPlays.html#11994" class="Bound">x</a><a id="12079" class="Symbol">)</a> <a id="12081" class="Symbol">(</a><a id="12082" href="Games.OptimalPlays.html#11616" class="Bound">lf</a> <a id="12085" href="Games.OptimalPlays.html#11994" class="Bound">x</a><a id="12086" class="Symbol">)</a> <a id="12088" class="Symbol">(</a><a id="12089" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a> <a id="12092" href="Games.OptimalPlays.html#11994" class="Bound">x</a><a id="12093" class="Symbol">)</a> <a id="12095" class="Symbol">(</a><a id="12096" href="Games.OptimalPlays.html#11578" class="Bound">Îµf</a> <a id="12099" href="Games.OptimalPlays.html#11994" class="Bound">x</a><a id="12100" class="Symbol">)</a> <a id="12102" class="Symbol">(</a><a id="12103" href="Games.OptimalPlays.html#11591" class="Bound">af</a> <a id="12106" href="Games.OptimalPlays.html#11994" class="Bound">x</a><a id="12107" class="Symbol">))</a>
            <a id="12122" class="Symbol">(</a><a id="12123" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="12131" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="12133" href="Games.OptimalPlays.html#11994" class="Bound">x</a><a id="12134" class="Symbol">))</a>

  <a id="12140" href="Games.OptimalPlays.html#12140" class="Function">I</a> <a id="12142" class="Symbol">:</a> <a id="12144" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="12158" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="12161" class="Symbol">(</a><a id="12162" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="12166" href="Games.OptimalPlays.html#11542" class="Bound">Xt</a> <a id="12169" href="Games.OptimalPlays.html#11607" class="Bound">lt</a> <a id="12172" href="Games.OptimalPlays.html#11554" class="Bound">Ï•t</a> <a id="12175" href="Games.OptimalPlays.html#11569" class="Bound">Îµt</a> <a id="12178" href="Games.OptimalPlays.html#11582" class="Bound">at</a><a id="12180" class="Symbol">)</a> <a id="12182" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="12184" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="12186" href="Games.OptimalPlays.html#11823" class="Function">t</a> <a id="12188" href="MonadOnTypes.NonEmptyList.html#2347" class="Function Operator">âŠ—á´¸âº</a> <a id="12192" href="Games.OptimalPlays.html#11854" class="Function">tf</a>
  <a id="12197" href="Games.OptimalPlays.html#12140" class="Function">I</a> <a id="12199" class="Symbol">=</a> <a id="12201" href="MonadOnTypes.J-transf-variation.html#4839" class="Function">âŠ—á´¶áµ€-in-terms-of-âŠ—áµ€</a> <a id="12220" href="Games.OptimalPlays.html#11688" class="Function">eâº</a> <a id="12223" href="Games.OptimalPlays.html#11721" class="Function">dâº</a> <a id="12226" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="12228" href="Games.OptimalPlays.html#573" class="Bound">fe</a>

  <a id="12234" href="Games.OptimalPlays.html#12234" class="Function">II</a> <a id="12237" class="Symbol">:</a> <a id="12239" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="12246" class="Symbol">(</a><a id="12247" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="12249" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="12252" href="Games.OptimalPlays.html#11626" class="Bound">xs</a><a id="12254" class="Symbol">)</a> <a id="12256" class="Symbol">(</a><a id="12257" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="12259" class="Symbol">(</a><a id="12260" href="Games.OptimalPlays.html#11823" class="Function">t</a> <a id="12262" href="MonadOnTypes.NonEmptyList.html#2347" class="Function Operator">âŠ—á´¸âº</a> <a id="12266" href="Games.OptimalPlays.html#11854" class="Function">tf</a><a id="12268" class="Symbol">))</a>
  <a id="12273" href="Games.OptimalPlays.html#12234" class="Function">II</a> <a id="12276" class="Symbol">=</a> <a id="12278" href="MLTT.Id.html#735" class="Function">transport</a> <a id="12288" class="Symbol">(</a><a id="12289" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="12296" class="Symbol">(</a><a id="12297" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="12299" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="12302" href="Games.OptimalPlays.html#11626" class="Bound">xs</a><a id="12304" class="Symbol">))</a> <a id="12307" class="Symbol">(</a><a id="12308" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="12311" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="12313" href="Games.OptimalPlays.html#12140" class="Function">I</a><a id="12314" class="Symbol">)</a> <a id="12316" href="Games.OptimalPlays.html#11630" class="Bound">m</a>

  <a id="12321" href="Games.OptimalPlays.html#12321" class="Function">III</a> <a id="12325" class="Symbol">:</a> <a id="12327" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="12334" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="12336" class="Symbol">(</a><a id="12337" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="12339" href="Games.OptimalPlays.html#11823" class="Function">t</a><a id="12340" class="Symbol">)</a>
  <a id="12344" href="Games.OptimalPlays.html#12321" class="Function">III</a> <a id="12348" class="Symbol">=</a> <a id="12350" href="MLTT.Sigma-Type.html#198" class="Field">prâ‚</a> <a id="12354" class="Symbol">(</a><a id="12355" href="MonadOnTypes.NonEmptyList.html#5471" class="Function">split-membership</a> <a id="12372" href="Games.OptimalPlays.html#573" class="Bound">fe</a> <a id="12375" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="12377" href="Games.OptimalPlays.html#11626" class="Bound">xs</a> <a id="12380" href="Games.OptimalPlays.html#11823" class="Function">t</a> <a id="12382" href="Games.OptimalPlays.html#11854" class="Function">tf</a> <a id="12385" href="Games.OptimalPlays.html#12234" class="Function">II</a><a id="12387" class="Symbol">)</a>

  <a id="12392" href="Games.OptimalPlays.html#12392" class="Function">IV</a> <a id="12395" class="Symbol">:</a> <a id="12397" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="12404" href="Games.OptimalPlays.html#11626" class="Bound">xs</a> <a id="12407" class="Symbol">(</a><a id="12408" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="12410" class="Symbol">(</a><a id="12411" href="Games.OptimalPlays.html#11854" class="Function">tf</a> <a id="12414" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="12415" class="Symbol">))</a>
  <a id="12420" href="Games.OptimalPlays.html#12392" class="Function">IV</a> <a id="12423" class="Symbol">=</a> <a id="12425" href="MLTT.Sigma-Type.html#209" class="Field">prâ‚‚</a> <a id="12429" class="Symbol">(</a><a id="12430" href="MonadOnTypes.NonEmptyList.html#5471" class="Function">split-membership</a> <a id="12447" href="Games.OptimalPlays.html#573" class="Bound">fe</a> <a id="12450" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="12452" href="Games.OptimalPlays.html#11626" class="Bound">xs</a> <a id="12455" href="Games.OptimalPlays.html#11823" class="Function">t</a> <a id="12457" href="Games.OptimalPlays.html#11854" class="Function">tf</a> <a id="12460" href="Games.OptimalPlays.html#12234" class="Function">II</a><a id="12462" class="Symbol">)</a>

  <a id="12467" href="Games.OptimalPlays.html#12467" class="Function">V</a> <a id="12469" class="Symbol">:</a> <a id="12471" href="Games.OptimalPlays.html#11978" class="Function">p&#39;</a> <a id="12474" href="MLTT.Id.html#1889" class="Function Operator">âˆ¼</a> <a id="12476" href="Games.OptimalPlays.html#11916" class="Function">p</a>
  <a id="12480" href="Games.OptimalPlays.html#12467" class="Function">V</a> <a id="12482" href="Games.OptimalPlays.html#12482" class="Bound">x</a> <a id="12484" class="Symbol">=</a> <a id="12486" href="Games.OptimalPlays.html#9409" class="Function">JT-in-terms-of-K</a> <a id="12503" class="Symbol">(</a><a id="12504" href="Games.OptimalPlays.html#11550" class="Bound">Xf</a> <a id="12507" href="Games.OptimalPlays.html#12482" class="Bound">x</a><a id="12508" class="Symbol">)</a> <a id="12510" class="Symbol">(</a><a id="12511" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a> <a id="12514" href="Games.OptimalPlays.html#12482" class="Bound">x</a><a id="12515" class="Symbol">)</a> <a id="12517" class="Symbol">(</a><a id="12518" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="12526" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="12528" href="Games.OptimalPlays.html#12482" class="Bound">x</a><a id="12529" class="Symbol">)</a> <a id="12531" class="Symbol">(</a><a id="12532" href="Games.OptimalPlays.html#11578" class="Bound">Îµf</a> <a id="12535" href="Games.OptimalPlays.html#12482" class="Bound">x</a> <a id="12537" class="Symbol">)</a> <a id="12539" class="Symbol">(</a><a id="12540" href="Games.OptimalPlays.html#11591" class="Bound">af</a> <a id="12543" href="Games.OptimalPlays.html#12482" class="Bound">x</a><a id="12544" class="Symbol">)</a> <a id="12546" class="Symbol">(</a><a id="12547" href="Games.OptimalPlays.html#11616" class="Bound">lf</a> <a id="12550" href="Games.OptimalPlays.html#12482" class="Bound">x</a><a id="12551" class="Symbol">)</a>

  <a id="12556" href="Games.OptimalPlays.html#12556" class="Function">VI</a> <a id="12559" class="Symbol">:</a> <a id="12561" href="Games.OptimalPlays.html#11823" class="Function">t</a> <a id="12563" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="12565" href="Games.OptimalPlays.html#11688" class="Function">eâº</a> <a id="12568" href="Games.OptimalPlays.html#11916" class="Function">p</a>
  <a id="12572" href="Games.OptimalPlays.html#12556" class="Function">VI</a> <a id="12575" class="Symbol">=</a> <a id="12577" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="12580" href="Games.OptimalPlays.html#11688" class="Function">eâº</a> <a id="12583" class="Symbol">(</a><a id="12584" href="UF.FunExt.html#1242" class="Function">dfunext</a> <a id="12592" href="Games.OptimalPlays.html#573" class="Bound">fe</a> <a id="12595" href="Games.OptimalPlays.html#12467" class="Function">V</a><a id="12596" class="Symbol">)</a>

  <a id="12601" href="Games.OptimalPlays.html#12601" class="Function">VII</a> <a id="12605" class="Symbol">:</a> <a id="12607" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="12614" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="12616" class="Symbol">(</a><a id="12617" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="12619" class="Symbol">(</a><a id="12620" href="Games.OptimalPlays.html#11688" class="Function">eâº</a> <a id="12623" href="Games.OptimalPlays.html#11916" class="Function">p</a><a id="12624" class="Symbol">))</a>
  <a id="12629" href="Games.OptimalPlays.html#12601" class="Function">VII</a> <a id="12633" class="Symbol">=</a> <a id="12635" href="MLTT.Id.html#735" class="Function">transport</a> <a id="12645" class="Symbol">(Î»</a> <a id="12648" href="Games.OptimalPlays.html#12648" class="Bound">-</a> <a id="12650" class="Symbol">â†’</a> <a id="12652" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="12659" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="12661" class="Symbol">(</a><a id="12662" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="12664" href="Games.OptimalPlays.html#12648" class="Bound">-</a><a id="12665" class="Symbol">))</a> <a id="12668" href="Games.OptimalPlays.html#12556" class="Function">VI</a> <a id="12671" href="Games.OptimalPlays.html#12321" class="Function">III</a>

  <a id="12678" href="Games.OptimalPlays.html#12678" class="Function">head-is-optimal-move</a> <a id="12699" class="Symbol">=</a>
   <a id="12704" href="Games.OptimalPlays.html#11558" class="Bound">Ï•</a> <a id="12706" href="Games.OptimalPlays.html#11916" class="Function">p</a>                                      <a id="12745" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="12748" href="Games.OptimalPlays.html#12870" class="Function">VIII</a> <a id="12753" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
   <a id="12758" href="Games.OptimalPlays.html#11916" class="Function">p</a> <a id="12760" href="Games.OptimalPlays.html#11621" class="Bound">x</a>                                      <a id="12799" href="MLTT.Id.html#2703" class="Function Operator">ï¼âŸ¨</a> <a id="12802" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="12807" href="MLTT.Id.html#2703" class="Function Operator">âŸ©</a>
   <a id="12812" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="12826" class="Symbol">(</a><a id="12827" href="MonadOnTypes.K.html#184" class="Function">ğ•‚</a> <a id="12829" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="12830" class="Symbol">)</a> <a id="12832" class="Symbol">(</a><a id="12833" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a> <a id="12836" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="12837" class="Symbol">)</a> <a id="12839" class="Symbol">(</a><a id="12840" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="12848" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="12850" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="12851" class="Symbol">)</a> <a id="12853" href="MLTT.Id.html#2785" class="Function Operator">âˆ</a>
    <a id="12859" class="Keyword">where</a>
     <a id="12870" href="Games.OptimalPlays.html#12870" class="Function">VIII</a> <a id="12875" class="Symbol">=</a> <a id="12877" class="Symbol">(</a><a id="12878" href="Games.OptimalPlays.html#7000" class="Function">Îµá´¸-propertyâ†’</a> <a id="12891" href="Games.OptimalPlays.html#11546" class="Bound">X</a> <a id="12893" href="Games.OptimalPlays.html#11611" class="Bound">l</a> <a id="12895" href="Games.OptimalPlays.html#11558" class="Bound">Ï•</a> <a id="12897" href="Games.OptimalPlays.html#11916" class="Function">p</a> <a id="12899" href="Games.OptimalPlays.html#11621" class="Bound">x</a> <a id="12901" href="Games.OptimalPlays.html#12601" class="Function">VII</a><a id="12904" class="Symbol">)</a><a id="12905" href="MLTT.Id.html#1055" class="Function Operator">â»Â¹</a>

  <a id="12911" href="Games.OptimalPlays.html#12911" class="Function">IH</a> <a id="12914" class="Symbol">:</a> <a id="12916" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="12923" href="Games.OptimalPlays.html#11626" class="Bound">xs</a> <a id="12926" class="Symbol">(</a><a id="12927" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="12929" class="Symbol">(</a><a id="12930" href="Games.OptimalPlays.html#11854" class="Function">tf</a> <a id="12933" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="12934" class="Symbol">))</a>
     <a id="12942" class="Symbol">â†’</a> <a id="12944" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="12960" class="Symbol">(</a><a id="12961" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a> <a id="12964" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="12965" class="Symbol">)</a> <a id="12967" class="Symbol">(</a><a id="12968" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="12976" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="12978" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="12979" class="Symbol">)</a> <a id="12981" href="Games.OptimalPlays.html#11626" class="Bound">xs</a>
  <a id="12986" href="Games.OptimalPlays.html#12911" class="Function">IH</a> <a id="12989" class="Symbol">=</a> <a id="12991" href="Games.OptimalPlays.html#11164" class="Function">main-lemmaâ†’</a> <a id="13003" class="Symbol">(</a><a id="13004" href="Games.OptimalPlays.html#11550" class="Bound">Xf</a> <a id="13007" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="13008" class="Symbol">)</a> <a id="13010" class="Symbol">(</a><a id="13011" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a> <a id="13014" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="13015" class="Symbol">)</a> <a id="13017" class="Symbol">(</a><a id="13018" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="13026" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="13028" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="13029" class="Symbol">)</a> <a id="13031" class="Symbol">(</a><a id="13032" href="Games.OptimalPlays.html#11578" class="Bound">Îµf</a> <a id="13035" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="13036" class="Symbol">)</a> <a id="13038" class="Symbol">(</a><a id="13039" href="Games.OptimalPlays.html#11591" class="Bound">af</a> <a id="13042" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="13043" class="Symbol">)</a> <a id="13045" class="Symbol">(</a><a id="13046" href="Games.OptimalPlays.html#11616" class="Bound">lf</a> <a id="13049" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="13050" class="Symbol">)</a> <a id="13052" href="Games.OptimalPlays.html#11626" class="Bound">xs</a>

  <a id="13058" href="Games.OptimalPlays.html#13058" class="Function">tail-is-optimal-play</a> <a id="13079" class="Symbol">:</a> <a id="13081" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="13097" class="Symbol">(</a><a id="13098" href="Games.OptimalPlays.html#11563" class="Bound">Ï•f</a> <a id="13101" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="13102" class="Symbol">)</a> <a id="13104" class="Symbol">(</a><a id="13105" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="13113" href="Games.OptimalPlays.html#11567" class="Bound">q</a> <a id="13115" href="Games.OptimalPlays.html#11621" class="Bound">x</a><a id="13116" class="Symbol">)</a> <a id="13118" href="Games.OptimalPlays.html#11626" class="Bound">xs</a>
  <a id="13123" href="Games.OptimalPlays.html#13058" class="Function">tail-is-optimal-play</a> <a id="13144" class="Symbol">=</a> <a id="13146" href="Games.OptimalPlays.html#12911" class="Function">IH</a> <a id="13149" href="Games.OptimalPlays.html#12392" class="Function">IV</a>

<a id="main-lemmaâ†"></a><a id="13153" href="Games.OptimalPlays.html#13153" class="Function">main-lemmaâ†</a> <a id="13165" class="Symbol">:</a> <a id="13167" class="Symbol">(</a><a id="13168" href="Games.OptimalPlays.html#13168" class="Bound">Xt</a> <a id="13171" class="Symbol">:</a> <a id="13173" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="13174" class="Symbol">)</a>
              <a id="13190" class="Symbol">(</a><a id="13191" href="Games.OptimalPlays.html#13191" class="Bound">Ï•t</a> <a id="13194" class="Symbol">:</a> <a id="13196" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="13198" href="Games.OptimalPlays.html#13168" class="Bound">Xt</a><a id="13200" class="Symbol">)</a>
              <a id="13216" class="Symbol">(</a><a id="13217" href="Games.OptimalPlays.html#13217" class="Bound">q</a> <a id="13219" class="Symbol">:</a> <a id="13221" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="13226" href="Games.OptimalPlays.html#13168" class="Bound">Xt</a> <a id="13229" class="Symbol">â†’</a> <a id="13231" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="13232" class="Symbol">)</a>
              <a id="13248" class="Symbol">(</a><a id="13249" href="Games.OptimalPlays.html#13249" class="Bound">Îµt</a> <a id="13252" class="Symbol">:</a> <a id="13254" href="Games.FiniteHistoryDependent.html#8970" class="Function">ğ“™</a> <a id="13256" href="Games.OptimalPlays.html#13168" class="Bound">Xt</a><a id="13258" class="Symbol">)</a>
              <a id="13274" class="Symbol">(</a><a id="13275" href="Games.OptimalPlays.html#13275" class="Bound">at</a> <a id="13278" class="Symbol">:</a> <a id="13280" href="Games.OptimalPlays.html#13249" class="Bound">Îµt</a> <a id="13283" href="Games.FiniteHistoryDependent.html#10543" class="Function Operator">Attains</a> <a id="13291" href="Games.OptimalPlays.html#13191" class="Bound">Ï•t</a><a id="13293" class="Symbol">)</a>
              <a id="13309" class="Symbol">(</a><a id="13310" href="Games.OptimalPlays.html#13310" class="Bound">lt</a> <a id="13313" class="Symbol">:</a> <a id="13315" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="13325" href="MLTT.List.html#6746" class="Function">listedâº</a> <a id="13333" href="Games.OptimalPlays.html#13168" class="Bound">Xt</a><a id="13335" class="Symbol">)</a>
              <a id="13351" class="Symbol">(</a><a id="13352" href="Games.OptimalPlays.html#13352" class="Bound">xs</a> <a id="13355" class="Symbol">:</a> <a id="13357" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="13362" href="Games.OptimalPlays.html#13168" class="Bound">Xt</a><a id="13364" class="Symbol">)</a>
            <a id="13378" class="Symbol">â†’</a> <a id="13380" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="13396" href="Games.OptimalPlays.html#13191" class="Bound">Ï•t</a> <a id="13399" href="Games.OptimalPlays.html#13217" class="Bound">q</a> <a id="13401" href="Games.OptimalPlays.html#13352" class="Bound">xs</a>
            <a id="13416" class="Symbol">â†’</a> <a id="13418" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="13425" href="Games.OptimalPlays.html#13352" class="Bound">xs</a> <a id="13428" class="Symbol">(</a><a id="13429" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="13431" class="Symbol">(</a><a id="13432" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="13446" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="13449" class="Symbol">(</a><a id="13450" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="13454" href="Games.OptimalPlays.html#13168" class="Bound">Xt</a> <a id="13457" href="Games.OptimalPlays.html#13310" class="Bound">lt</a> <a id="13460" href="Games.OptimalPlays.html#13191" class="Bound">Ï•t</a> <a id="13463" href="Games.OptimalPlays.html#13249" class="Bound">Îµt</a> <a id="13466" href="Games.OptimalPlays.html#13275" class="Bound">at</a><a id="13468" class="Symbol">)</a> <a id="13470" href="Games.OptimalPlays.html#13217" class="Bound">q</a><a id="13471" class="Symbol">))</a>
<a id="13474" href="Games.OptimalPlays.html#13153" class="Function">main-lemmaâ†</a> <a id="13486" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a> <a id="13489" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="13492" href="Games.OptimalPlays.html#13492" class="Bound">q</a> <a id="13494" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="13497" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="13500" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="13503" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="13506" href="MLTT.Unit.html#162" class="InductiveConstructor">â‹†</a> <a id="13508" class="Symbol">=</a> <a id="13510" href="MLTT.List.html#3461" class="InductiveConstructor">in-head</a>
<a id="13518" href="Games.OptimalPlays.html#13153" class="Function">main-lemmaâ†</a> <a id="13530" href="Games.OptimalPlays.html#13530" class="Bound">Xt</a><a id="13532" class="Symbol">@(</a><a id="13534" href="Games.OptimalPlays.html#13534" class="Bound">X</a> <a id="13536" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="13538" href="Games.OptimalPlays.html#13538" class="Bound">Xf</a><a id="13540" class="Symbol">)</a> <a id="13542" href="Games.OptimalPlays.html#13542" class="Bound">Ï•t</a><a id="13544" class="Symbol">@(</a><a id="13546" href="Games.OptimalPlays.html#13546" class="Bound">Ï•</a> <a id="13548" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="13551" href="Games.OptimalPlays.html#13551" class="Bound">Ï•f</a><a id="13553" class="Symbol">)</a> <a id="13555" href="Games.OptimalPlays.html#13555" class="Bound">q</a> <a id="13557" href="Games.OptimalPlays.html#13557" class="Bound">Îµt</a><a id="13559" class="Symbol">@(</a><a id="13561" href="Games.OptimalPlays.html#13561" class="Bound">Îµ</a> <a id="13563" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="13566" href="Games.OptimalPlays.html#13566" class="Bound">Îµf</a><a id="13568" class="Symbol">)</a> <a id="13570" href="Games.OptimalPlays.html#13570" class="Bound">at</a><a id="13572" class="Symbol">@(</a><a id="13574" href="Games.OptimalPlays.html#13574" class="Bound">a</a> <a id="13576" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="13579" href="Games.OptimalPlays.html#13579" class="Bound">af</a><a id="13581" class="Symbol">)</a>
            <a id="13595" href="Games.OptimalPlays.html#13595" class="Bound">lt</a><a id="13597" class="Symbol">@(</a><a id="13599" href="Games.OptimalPlays.html#13599" class="Bound">l</a> <a id="13601" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="13604" href="Games.OptimalPlays.html#13604" class="Bound">lf</a><a id="13606" class="Symbol">)</a> <a id="13608" class="Symbol">(</a><a id="13609" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="13611" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="13614" href="Games.OptimalPlays.html#13614" class="Bound">xs</a><a id="13616" class="Symbol">)</a> <a id="13618" class="Symbol">(</a><a id="13619" href="Games.OptimalPlays.html#13619" class="Bound">om</a> <a id="13622" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="13624" href="Games.OptimalPlays.html#13624" class="Bound">op</a><a id="13626" class="Symbol">)</a> <a id="13628" class="Symbol">=</a> <a id="13630" href="Games.OptimalPlays.html#14526" class="Function">VI</a>
 <a id="13634" class="Keyword">where</a>
  <a id="13642" href="Games.OptimalPlays.html#13642" class="Function">p</a> <a id="13644" class="Symbol">:</a> <a id="13646" href="Games.OptimalPlays.html#13534" class="Bound">X</a> <a id="13648" class="Symbol">â†’</a> <a id="13650" href="Games.OptimalPlays.html#596" class="Bound">R</a>
  <a id="13654" href="Games.OptimalPlays.html#13642" class="Function">p</a> <a id="13656" href="Games.OptimalPlays.html#13656" class="Bound">x</a> <a id="13658" class="Symbol">=</a> <a id="13660" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="13674" class="Symbol">(</a><a id="13675" href="MonadOnTypes.K.html#184" class="Function">ğ•‚</a> <a id="13677" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="13678" class="Symbol">)</a> <a id="13680" class="Symbol">(</a><a id="13681" href="Games.OptimalPlays.html#13551" class="Bound">Ï•f</a> <a id="13684" href="Games.OptimalPlays.html#13656" class="Bound">x</a><a id="13685" class="Symbol">)</a> <a id="13687" class="Symbol">(</a><a id="13688" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="13696" href="Games.OptimalPlays.html#13555" class="Bound">q</a> <a id="13698" href="Games.OptimalPlays.html#13656" class="Bound">x</a><a id="13699" class="Symbol">)</a>

  <a id="13704" href="Games.OptimalPlays.html#13704" class="Function">eâº</a> <a id="13707" class="Symbol">:</a> <a id="13709" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="13712" href="Games.OptimalPlays.html#13534" class="Bound">X</a>
  <a id="13716" href="Games.OptimalPlays.html#13704" class="Function">eâº</a> <a id="13719" class="Symbol">=</a> <a id="13721" href="Games.OptimalPlays.html#7599" class="Function">Îµâº</a> <a id="13724" href="Games.OptimalPlays.html#13534" class="Bound">X</a> <a id="13726" href="Games.OptimalPlays.html#13599" class="Bound">l</a> <a id="13728" href="Games.OptimalPlays.html#13546" class="Bound">Ï•</a> <a id="13730" href="Games.OptimalPlays.html#13561" class="Bound">Îµ</a> <a id="13732" href="Games.OptimalPlays.html#13574" class="Bound">a</a>

  <a id="13737" href="Games.OptimalPlays.html#13737" class="Function">dâº</a> <a id="13740" class="Symbol">:</a> <a id="13742" class="Symbol">(</a><a id="13743" href="Games.OptimalPlays.html#13743" class="Bound">x</a> <a id="13745" class="Symbol">:</a> <a id="13747" href="Games.OptimalPlays.html#13534" class="Bound">X</a><a id="13748" class="Symbol">)</a> <a id="13750" class="Symbol">â†’</a> <a id="13752" href="MonadOnTypes.J-transf-variation.html#2446" class="Function">JT</a> <a id="13755" class="Symbol">(</a><a id="13756" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="13761" class="Symbol">(</a><a id="13762" href="Games.OptimalPlays.html#13538" class="Bound">Xf</a> <a id="13765" href="Games.OptimalPlays.html#13743" class="Bound">x</a><a id="13766" class="Symbol">))</a>
  <a id="13771" href="Games.OptimalPlays.html#13737" class="Function">dâº</a> <a id="13774" href="Games.OptimalPlays.html#13774" class="Bound">x</a> <a id="13776" class="Symbol">=</a> <a id="13778" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="13792" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="13795" class="Symbol">(</a><a id="13796" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="13800" class="Symbol">(</a><a id="13801" href="Games.OptimalPlays.html#13538" class="Bound">Xf</a> <a id="13804" href="Games.OptimalPlays.html#13774" class="Bound">x</a><a id="13805" class="Symbol">)</a> <a id="13807" class="Symbol">(</a><a id="13808" href="Games.OptimalPlays.html#13604" class="Bound">lf</a> <a id="13811" href="Games.OptimalPlays.html#13774" class="Bound">x</a><a id="13812" class="Symbol">)</a> <a id="13814" class="Symbol">(</a><a id="13815" href="Games.OptimalPlays.html#13551" class="Bound">Ï•f</a> <a id="13818" href="Games.OptimalPlays.html#13774" class="Bound">x</a><a id="13819" class="Symbol">)</a> <a id="13821" class="Symbol">(</a><a id="13822" href="Games.OptimalPlays.html#13566" class="Bound">Îµf</a> <a id="13825" href="Games.OptimalPlays.html#13774" class="Bound">x</a><a id="13826" class="Symbol">)</a> <a id="13828" class="Symbol">(</a><a id="13829" href="Games.OptimalPlays.html#13579" class="Bound">af</a> <a id="13832" href="Games.OptimalPlays.html#13774" class="Bound">x</a><a id="13833" class="Symbol">))</a>

  <a id="13839" href="Games.OptimalPlays.html#13839" class="Function">t</a> <a id="13841" class="Symbol">:</a> <a id="13843" href="MonadOnTypes.NonEmptyList.html#514" class="Function">Listâº</a> <a id="13849" href="Games.OptimalPlays.html#13534" class="Bound">X</a>
  <a id="13853" href="Games.OptimalPlays.html#13839" class="Function">t</a> <a id="13855" class="Symbol">=</a> <a id="13857" href="MonadOnTypes.J-transf-variation.html#3331" class="Function">Ï„</a> <a id="13859" href="Games.OptimalPlays.html#13704" class="Function">eâº</a> <a id="13862" href="Games.OptimalPlays.html#13737" class="Function">dâº</a> <a id="13865" href="Games.OptimalPlays.html#13555" class="Bound">q</a>

  <a id="13870" href="Games.OptimalPlays.html#13870" class="Function">tf</a> <a id="13873" class="Symbol">:</a> <a id="13875" class="Symbol">(</a><a id="13876" href="Games.OptimalPlays.html#13876" class="Bound">x</a> <a id="13878" class="Symbol">:</a> <a id="13880" href="Games.OptimalPlays.html#13534" class="Bound">X</a><a id="13881" class="Symbol">)</a> <a id="13883" class="Symbol">â†’</a> <a id="13885" href="MonadOnTypes.Monad.html#5068" class="Function">T</a> <a id="13887" class="Symbol">(</a><a id="13888" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="13893" class="Symbol">(</a><a id="13894" href="Games.OptimalPlays.html#13538" class="Bound">Xf</a> <a id="13897" href="Games.OptimalPlays.html#13876" class="Bound">x</a><a id="13898" class="Symbol">))</a>
  <a id="13903" href="Games.OptimalPlays.html#13870" class="Function">tf</a> <a id="13906" href="Games.OptimalPlays.html#13906" class="Bound">x</a> <a id="13908" class="Symbol">=</a> <a id="13910" href="Games.OptimalPlays.html#13737" class="Function">dâº</a> <a id="13913" href="Games.OptimalPlays.html#13906" class="Bound">x</a> <a id="13915" class="Symbol">(</a><a id="13916" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="13924" href="Games.OptimalPlays.html#13555" class="Bound">q</a> <a id="13926" href="Games.OptimalPlays.html#13906" class="Bound">x</a><a id="13927" class="Symbol">)</a>

  <a id="13932" href="Games.OptimalPlays.html#13932" class="Function">p&#39;</a> <a id="13935" class="Symbol">:</a> <a id="13937" href="Games.OptimalPlays.html#13534" class="Bound">X</a> <a id="13939" class="Symbol">â†’</a> <a id="13941" href="Games.OptimalPlays.html#596" class="Bound">R</a>
  <a id="13945" href="Games.OptimalPlays.html#13932" class="Function">p&#39;</a> <a id="13948" href="Games.OptimalPlays.html#13948" class="Bound">x</a> <a id="13950" class="Symbol">=</a> <a id="13952" href="MonadOnTypes.Monad.html#14835" class="Function">Î±-extáµ€</a> <a id="13959" class="Symbol">(</a><a id="13960" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="13968" href="Games.OptimalPlays.html#13555" class="Bound">q</a> <a id="13970" href="Games.OptimalPlays.html#13948" class="Bound">x</a><a id="13971" class="Symbol">)</a> <a id="13973" class="Symbol">(</a><a id="13974" href="Games.OptimalPlays.html#13870" class="Function">tf</a> <a id="13977" href="Games.OptimalPlays.html#13948" class="Bound">x</a><a id="13978" class="Symbol">)</a>

  <a id="13983" href="Games.OptimalPlays.html#13983" class="Function">IH</a> <a id="13986" class="Symbol">:</a> <a id="13988" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="13995" href="Games.OptimalPlays.html#13614" class="Bound">xs</a> <a id="13998" class="Symbol">(</a><a id="13999" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="14001" class="Symbol">(</a><a id="14002" href="Games.OptimalPlays.html#13870" class="Function">tf</a> <a id="14005" href="Games.OptimalPlays.html#13609" class="Bound">x</a><a id="14006" class="Symbol">))</a>
  <a id="14011" href="Games.OptimalPlays.html#13983" class="Function">IH</a> <a id="14014" class="Symbol">=</a> <a id="14016" href="Games.OptimalPlays.html#13153" class="Function">main-lemmaâ†</a> <a id="14028" class="Symbol">(</a><a id="14029" href="Games.OptimalPlays.html#13538" class="Bound">Xf</a> <a id="14032" href="Games.OptimalPlays.html#13609" class="Bound">x</a><a id="14033" class="Symbol">)</a> <a id="14035" class="Symbol">(</a><a id="14036" href="Games.OptimalPlays.html#13551" class="Bound">Ï•f</a> <a id="14039" href="Games.OptimalPlays.html#13609" class="Bound">x</a><a id="14040" class="Symbol">)</a> <a id="14042" class="Symbol">(</a><a id="14043" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="14051" href="Games.OptimalPlays.html#13555" class="Bound">q</a> <a id="14053" href="Games.OptimalPlays.html#13609" class="Bound">x</a><a id="14054" class="Symbol">)</a> <a id="14056" class="Symbol">(</a><a id="14057" href="Games.OptimalPlays.html#13566" class="Bound">Îµf</a> <a id="14060" href="Games.OptimalPlays.html#13609" class="Bound">x</a><a id="14061" class="Symbol">)</a> <a id="14063" class="Symbol">(</a><a id="14064" href="Games.OptimalPlays.html#13579" class="Bound">af</a> <a id="14067" href="Games.OptimalPlays.html#13609" class="Bound">x</a><a id="14068" class="Symbol">)</a> <a id="14070" class="Symbol">(</a><a id="14071" href="Games.OptimalPlays.html#13604" class="Bound">lf</a> <a id="14074" href="Games.OptimalPlays.html#13609" class="Bound">x</a><a id="14075" class="Symbol">)</a> <a id="14077" href="Games.OptimalPlays.html#13614" class="Bound">xs</a> <a id="14080" href="Games.OptimalPlays.html#13624" class="Bound">op</a>

  <a id="14086" href="Games.OptimalPlays.html#14086" class="Function">I</a> <a id="14088" class="Symbol">:</a> <a id="14090" href="Games.OptimalPlays.html#13642" class="Function">p</a> <a id="14092" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="14094" href="Games.OptimalPlays.html#13932" class="Function">p&#39;</a>
  <a id="14099" href="Games.OptimalPlays.html#14086" class="Function">I</a> <a id="14101" class="Symbol">=</a> <a id="14103" href="UF.FunExt.html#1242" class="Function">dfunext</a> <a id="14111" href="Games.OptimalPlays.html#573" class="Bound">fe</a>
       <a id="14121" class="Symbol">(Î»</a> <a id="14124" href="Games.OptimalPlays.html#14124" class="Bound">x</a> <a id="14126" class="Symbol">â†’</a> <a id="14128" class="Symbol">(</a><a id="14129" href="Games.OptimalPlays.html#9409" class="Function">JT-in-terms-of-K</a> <a id="14146" class="Symbol">(</a><a id="14147" href="Games.OptimalPlays.html#13538" class="Bound">Xf</a> <a id="14150" href="Games.OptimalPlays.html#14124" class="Bound">x</a><a id="14151" class="Symbol">)</a> <a id="14153" class="Symbol">(</a><a id="14154" href="Games.OptimalPlays.html#13551" class="Bound">Ï•f</a> <a id="14157" href="Games.OptimalPlays.html#14124" class="Bound">x</a><a id="14158" class="Symbol">)</a> <a id="14160" class="Symbol">(</a><a id="14161" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="14169" href="Games.OptimalPlays.html#13555" class="Bound">q</a> <a id="14171" href="Games.OptimalPlays.html#14124" class="Bound">x</a><a id="14172" class="Symbol">)</a> <a id="14174" class="Symbol">(</a><a id="14175" href="Games.OptimalPlays.html#13566" class="Bound">Îµf</a> <a id="14178" href="Games.OptimalPlays.html#14124" class="Bound">x</a><a id="14179" class="Symbol">)</a> <a id="14181" class="Symbol">(</a><a id="14182" href="Games.OptimalPlays.html#13579" class="Bound">af</a> <a id="14185" href="Games.OptimalPlays.html#14124" class="Bound">x</a><a id="14186" class="Symbol">)</a> <a id="14188" class="Symbol">(</a><a id="14189" href="Games.OptimalPlays.html#13604" class="Bound">lf</a> <a id="14192" href="Games.OptimalPlays.html#14124" class="Bound">x</a><a id="14193" class="Symbol">))</a><a id="14195" href="MLTT.Id.html#1055" class="Function Operator">â»Â¹</a><a id="14197" class="Symbol">)</a>

  <a id="14202" href="Games.OptimalPlays.html#14202" class="Function">II</a> <a id="14205" class="Symbol">:</a> <a id="14207" href="Games.OptimalPlays.html#13932" class="Function">p&#39;</a> <a id="14210" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="14212" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="14214" href="Games.OptimalPlays.html#13546" class="Bound">Ï•</a> <a id="14216" href="Games.OptimalPlays.html#13932" class="Function">p&#39;</a>
  <a id="14221" href="Games.OptimalPlays.html#14202" class="Function">II</a> <a id="14224" class="Symbol">=</a> <a id="14226" href="MLTT.Id.html#735" class="Function">transport</a> <a id="14236" class="Symbol">(Î»</a> <a id="14239" href="Games.OptimalPlays.html#14239" class="Bound">-</a> <a id="14241" class="Symbol">â†’</a> <a id="14243" href="Games.OptimalPlays.html#14239" class="Bound">-</a> <a id="14245" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="14247" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="14249" href="Games.OptimalPlays.html#13546" class="Bound">Ï•</a> <a id="14251" href="Games.OptimalPlays.html#14239" class="Bound">-</a><a id="14252" class="Symbol">)</a> <a id="14254" href="Games.OptimalPlays.html#14086" class="Function">I</a> <a id="14256" class="Symbol">(</a><a id="14257" href="Games.OptimalPlays.html#13619" class="Bound">om</a> <a id="14260" href="MLTT.Id.html#1055" class="Function Operator">â»Â¹</a><a id="14262" class="Symbol">)</a>

  <a id="14267" href="Games.OptimalPlays.html#14267" class="Function">III</a> <a id="14271" class="Symbol">:</a> <a id="14273" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="14280" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="14282" class="Symbol">(</a><a id="14283" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="14285" href="Games.OptimalPlays.html#13839" class="Function">t</a><a id="14286" class="Symbol">)</a>
  <a id="14290" href="Games.OptimalPlays.html#14267" class="Function">III</a> <a id="14294" class="Symbol">=</a> <a id="14296" href="Games.OptimalPlays.html#7120" class="Function">Îµá´¸-propertyâ†</a> <a id="14309" href="Games.OptimalPlays.html#13534" class="Bound">X</a> <a id="14311" href="Games.OptimalPlays.html#13599" class="Bound">l</a> <a id="14313" href="Games.OptimalPlays.html#13546" class="Bound">Ï•</a> <a id="14315" href="Games.OptimalPlays.html#13932" class="Function">p&#39;</a> <a id="14318" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="14320" href="Games.OptimalPlays.html#14202" class="Function">II</a>

  <a id="14326" href="Games.OptimalPlays.html#14326" class="Function">IV</a> <a id="14329" class="Symbol">:</a> <a id="14331" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="14338" class="Symbol">(</a><a id="14339" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="14341" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="14344" href="Games.OptimalPlays.html#13614" class="Bound">xs</a><a id="14346" class="Symbol">)</a> <a id="14348" class="Symbol">(</a><a id="14349" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="14351" class="Symbol">(</a><a id="14352" href="Games.OptimalPlays.html#13839" class="Function">t</a> <a id="14354" href="MonadOnTypes.NonEmptyList.html#2347" class="Function Operator">âŠ—á´¸âº</a> <a id="14358" href="Games.OptimalPlays.html#13870" class="Function">tf</a><a id="14360" class="Symbol">))</a>
  <a id="14365" href="Games.OptimalPlays.html#14326" class="Function">IV</a> <a id="14368" class="Symbol">=</a> <a id="14370" href="MonadOnTypes.NonEmptyList.html#7325" class="Function">join-membership</a> <a id="14386" href="Games.OptimalPlays.html#573" class="Bound">fe</a> <a id="14389" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="14391" href="Games.OptimalPlays.html#13614" class="Bound">xs</a> <a id="14394" href="Games.OptimalPlays.html#13839" class="Function">t</a> <a id="14396" href="Games.OptimalPlays.html#13870" class="Function">tf</a> <a id="14399" class="Symbol">(</a><a id="14400" href="Games.OptimalPlays.html#14267" class="Function">III</a> <a id="14404" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="14406" href="Games.OptimalPlays.html#13983" class="Function">IH</a><a id="14408" class="Symbol">)</a>

  <a id="14413" href="Games.OptimalPlays.html#14413" class="Function">V</a> <a id="14415" class="Symbol">:</a> <a id="14417" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="14419" class="Symbol">(</a><a id="14420" href="Games.OptimalPlays.html#13839" class="Function">t</a> <a id="14422" href="MonadOnTypes.NonEmptyList.html#2347" class="Function Operator">âŠ—á´¸âº</a> <a id="14426" href="Games.OptimalPlays.html#13870" class="Function">tf</a><a id="14428" class="Symbol">)</a> <a id="14430" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="14432" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="14434" class="Symbol">(</a><a id="14435" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="14449" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="14452" class="Symbol">(</a><a id="14453" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="14457" href="Games.OptimalPlays.html#13530" class="Bound">Xt</a> <a id="14460" href="Games.OptimalPlays.html#13595" class="Bound">lt</a> <a id="14463" href="Games.OptimalPlays.html#13542" class="Bound">Ï•t</a> <a id="14466" href="Games.OptimalPlays.html#13557" class="Bound">Îµt</a> <a id="14469" href="Games.OptimalPlays.html#13570" class="Bound">at</a><a id="14471" class="Symbol">)</a> <a id="14473" href="Games.OptimalPlays.html#13555" class="Bound">q</a><a id="14474" class="Symbol">)</a>
  <a id="14478" href="Games.OptimalPlays.html#14413" class="Function">V</a> <a id="14480" class="Symbol">=</a> <a id="14482" class="Symbol">(</a><a id="14483" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="14486" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="14488" class="Symbol">(</a><a id="14489" href="MonadOnTypes.J-transf-variation.html#4839" class="Function">âŠ—á´¶áµ€-in-terms-of-âŠ—áµ€</a> <a id="14508" href="Games.OptimalPlays.html#13704" class="Function">eâº</a> <a id="14511" href="Games.OptimalPlays.html#13737" class="Function">dâº</a> <a id="14514" href="Games.OptimalPlays.html#13555" class="Bound">q</a> <a id="14516" href="Games.OptimalPlays.html#573" class="Bound">fe</a><a id="14518" class="Symbol">))</a><a id="14520" href="MLTT.Id.html#1055" class="Function Operator">â»Â¹</a>

  <a id="14526" href="Games.OptimalPlays.html#14526" class="Function">VI</a> <a id="14529" class="Symbol">:</a> <a id="14531" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="14538" class="Symbol">(</a><a id="14539" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="14541" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="14544" href="Games.OptimalPlays.html#13614" class="Bound">xs</a><a id="14546" class="Symbol">)</a> <a id="14548" class="Symbol">(</a><a id="14549" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="14551" class="Symbol">(</a><a id="14552" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="14566" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="14569" class="Symbol">(</a><a id="14570" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="14574" href="Games.OptimalPlays.html#13530" class="Bound">Xt</a> <a id="14577" href="Games.OptimalPlays.html#13595" class="Bound">lt</a> <a id="14580" href="Games.OptimalPlays.html#13542" class="Bound">Ï•t</a> <a id="14583" href="Games.OptimalPlays.html#13557" class="Bound">Îµt</a> <a id="14586" href="Games.OptimalPlays.html#13570" class="Bound">at</a><a id="14588" class="Symbol">)</a> <a id="14590" href="Games.OptimalPlays.html#13555" class="Bound">q</a><a id="14591" class="Symbol">))</a>
  <a id="14596" href="Games.OptimalPlays.html#14526" class="Function">VI</a> <a id="14599" class="Symbol">=</a> <a id="14601" href="MLTT.Id.html#735" class="Function">transport</a> <a id="14611" class="Symbol">(</a><a id="14612" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="14619" class="Symbol">(</a><a id="14620" href="Games.OptimalPlays.html#13609" class="Bound">x</a> <a id="14622" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="14625" href="Games.OptimalPlays.html#13614" class="Bound">xs</a><a id="14627" class="Symbol">))</a> <a id="14630" href="Games.OptimalPlays.html#14413" class="Function">V</a> <a id="14632" href="Games.OptimalPlays.html#14326" class="Function">IV</a>

<a id="14636" class="Markup">\end{code}</a><a id="14646" class="Background">

To conclude, we package the above with a game as a parameter, where
the types of moves are listed, and where we are given attaining
selection functions for the quantifiers.

</a><a id="14822" class="Markup">\begin{code}</a>

<a id="14836" class="Keyword">module</a> <a id="14843" href="Games.OptimalPlays.html#14843" class="Module">_</a> <a id="14845" class="Symbol">(</a><a id="14846" href="Games.OptimalPlays.html#14846" class="Bound">G</a><a id="14847" class="Symbol">@(</a><a id="14849" href="Games.FiniteHistoryDependent.html#3164" class="InductiveConstructor">game</a> <a id="14854" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a> <a id="14857" href="Games.OptimalPlays.html#14857" class="Bound">q</a> <a id="14859" href="Games.OptimalPlays.html#14859" class="Bound">Ï•t</a><a id="14861" class="Symbol">)</a> <a id="14863" class="Symbol">:</a> <a id="14865" href="Games.FiniteHistoryDependent.html#3132" class="Record">Game</a><a id="14869" class="Symbol">)</a>
         <a id="14880" class="Symbol">(</a><a id="14881" href="Games.OptimalPlays.html#14881" class="Bound">Xt-is-listedâº</a> <a id="14895" class="Symbol">:</a> <a id="14897" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="14907" href="MLTT.List.html#6746" class="Function">listedâº</a> <a id="14915" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a><a id="14917" class="Symbol">)</a>
         <a id="14928" class="Symbol">(</a><a id="14929" href="Games.OptimalPlays.html#14929" class="Bound">Îµt</a> <a id="14932" class="Symbol">:</a> <a id="14934" href="Games.FiniteHistoryDependent.html#8970" class="Function">ğ“™</a> <a id="14936" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a><a id="14938" class="Symbol">)</a>
         <a id="14949" class="Symbol">(</a><a id="14950" href="Games.OptimalPlays.html#14950" class="Bound">Îµt-Attains-Ï•t</a> <a id="14964" class="Symbol">:</a> <a id="14966" href="Games.OptimalPlays.html#14929" class="Bound">Îµt</a> <a id="14969" href="Games.FiniteHistoryDependent.html#10543" class="Function Operator">Attains</a> <a id="14977" href="Games.OptimalPlays.html#14859" class="Bound">Ï•t</a><a id="14979" class="Symbol">)</a>
       <a id="14988" class="Keyword">where</a>

 <a id="14996" href="Games.OptimalPlays.html#14996" class="Function">optimal-plays</a> <a id="15010" class="Symbol">:</a> <a id="15012" href="MonadOnTypes.NonEmptyList.html#514" class="Function">Listâº</a> <a id="15018" class="Symbol">(</a><a id="15019" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="15024" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a><a id="15026" class="Symbol">)</a>
 <a id="15029" href="Games.OptimalPlays.html#14996" class="Function">optimal-plays</a> <a id="15043" class="Symbol">=</a> <a id="15045" href="Games.TypeTrees.html#3789" class="Function">path-sequence</a> <a id="15059" href="MonadOnTypes.J-transf-variation.html#2409" class="Function">ğ•ğ•‹</a> <a id="15062" class="Symbol">(</a><a id="15063" href="Games.OptimalPlays.html#7780" class="Function">Îµtâº</a> <a id="15067" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a> <a id="15070" href="Games.OptimalPlays.html#14881" class="Bound">Xt-is-listedâº</a> <a id="15084" href="Games.OptimalPlays.html#14859" class="Bound">Ï•t</a> <a id="15087" href="Games.OptimalPlays.html#14929" class="Bound">Îµt</a> <a id="15090" href="Games.OptimalPlays.html#14950" class="Bound">Îµt-Attains-Ï•t</a><a id="15103" class="Symbol">)</a> <a id="15105" href="Games.OptimalPlays.html#14857" class="Bound">q</a>

 <a id="15109" href="Games.OptimalPlays.html#15109" class="Function">Theoremâ†’</a> <a id="15118" class="Symbol">:</a> <a id="15120" class="Symbol">(</a><a id="15121" href="Games.OptimalPlays.html#15121" class="Bound">xs</a> <a id="15124" class="Symbol">:</a> <a id="15126" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="15131" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a><a id="15133" class="Symbol">)</a> <a id="15135" class="Symbol">â†’</a> <a id="15137" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="15144" href="Games.OptimalPlays.html#15121" class="Bound">xs</a> <a id="15147" class="Symbol">(</a><a id="15148" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="15150" href="Games.OptimalPlays.html#14996" class="Function">optimal-plays</a><a id="15163" class="Symbol">)</a> <a id="15165" class="Symbol">â†’</a> <a id="15167" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="15183" href="Games.OptimalPlays.html#14859" class="Bound">Ï•t</a> <a id="15186" href="Games.OptimalPlays.html#14857" class="Bound">q</a> <a id="15188" href="Games.OptimalPlays.html#15121" class="Bound">xs</a>
 <a id="15192" href="Games.OptimalPlays.html#15109" class="Function">Theoremâ†’</a> <a id="15201" class="Symbol">=</a> <a id="15203" href="Games.OptimalPlays.html#11164" class="Function">main-lemmaâ†’</a> <a id="15215" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a> <a id="15218" href="Games.OptimalPlays.html#14859" class="Bound">Ï•t</a> <a id="15221" href="Games.OptimalPlays.html#14857" class="Bound">q</a> <a id="15223" href="Games.OptimalPlays.html#14929" class="Bound">Îµt</a> <a id="15226" href="Games.OptimalPlays.html#14950" class="Bound">Îµt-Attains-Ï•t</a> <a id="15240" href="Games.OptimalPlays.html#14881" class="Bound">Xt-is-listedâº</a>

 <a id="15256" href="Games.OptimalPlays.html#15256" class="Function">Theoremâ†</a> <a id="15265" class="Symbol">:</a> <a id="15267" class="Symbol">(</a><a id="15268" href="Games.OptimalPlays.html#15268" class="Bound">xs</a> <a id="15271" class="Symbol">:</a> <a id="15273" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="15278" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a><a id="15280" class="Symbol">)</a> <a id="15282" class="Symbol">â†’</a> <a id="15284" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="15300" href="Games.OptimalPlays.html#14859" class="Bound">Ï•t</a> <a id="15303" href="Games.OptimalPlays.html#14857" class="Bound">q</a> <a id="15305" href="Games.OptimalPlays.html#15268" class="Bound">xs</a> <a id="15308" class="Symbol">â†’</a> <a id="15310" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="15317" href="Games.OptimalPlays.html#15268" class="Bound">xs</a> <a id="15320" class="Symbol">(</a><a id="15321" href="Notation.CanonicalMap.html#359" class="Field">Î¹</a> <a id="15323" href="Games.OptimalPlays.html#14996" class="Function">optimal-plays</a><a id="15336" class="Symbol">)</a>
 <a id="15339" href="Games.OptimalPlays.html#15256" class="Function">Theoremâ†</a> <a id="15348" class="Symbol">=</a> <a id="15350" href="Games.OptimalPlays.html#13153" class="Function">main-lemmaâ†</a> <a id="15362" href="Games.OptimalPlays.html#14854" class="Bound">Xt</a> <a id="15365" href="Games.OptimalPlays.html#14859" class="Bound">Ï•t</a> <a id="15368" href="Games.OptimalPlays.html#14857" class="Bound">q</a> <a id="15370" href="Games.OptimalPlays.html#14929" class="Bound">Îµt</a> <a id="15373" href="Games.OptimalPlays.html#14950" class="Bound">Îµt-Attains-Ï•t</a> <a id="15387" href="Games.OptimalPlays.html#14881" class="Bound">Xt-is-listedâº</a>

<a id="15402" class="Markup">\end{code}</a><a id="15412" class="Background">

This concludes what we wished to construct and prove.

Remark. The assumption Xt-is-listedâº implies that the type R of
outcomes has at least one element.

</a><a id="15569" class="Markup">\begin{code}</a>

 <a id="15584" href="Games.OptimalPlays.html#15584" class="Function">râ‚€</a> <a id="15587" class="Symbol">:</a> <a id="15589" href="Games.OptimalPlays.html#596" class="Bound">R</a>
 <a id="15592" href="Games.OptimalPlays.html#15584" class="Function">râ‚€</a> <a id="15595" class="Symbol">=</a> <a id="15597" href="Games.OptimalPlays.html#14857" class="Bound">q</a> <a id="15599" class="Symbol">(</a><a id="15600" href="MonadOnTypes.NonEmptyList.html#665" class="Function">headâº</a> <a id="15606" href="Games.OptimalPlays.html#14996" class="Function">optimal-plays</a><a id="15619" class="Symbol">)</a>

<a id="15622" class="Markup">\end{code}</a><a id="15632" class="Background">

In a previous version of this file, we instead assumed râ‚€ : R, and we
worked with &quot;listed&quot; instead of &quot;listedâº&quot;, but the listings were
automatically non-empty.

Added 24th September 2025.

</a><a id="15823" class="Markup">\begin{code}</a>

<a id="quantifiers-over-empty-types-are-not-attainable"></a><a id="15837" href="Games.OptimalPlays.html#15837" class="Function">quantifiers-over-empty-types-are-not-attainable</a>
 <a id="15886" class="Symbol">:</a> <a id="15888" class="Symbol">{</a><a id="15889" href="Games.OptimalPlays.html#15889" class="Bound">X</a> <a id="15891" class="Symbol">:</a> <a id="15893" href="Notation.General.html#372" class="Function">Type</a><a id="15897" class="Symbol">}</a>
 <a id="15900" class="Symbol">â†’</a> <a id="15902" href="MLTT.Negation.html#1004" class="Function">is-empty</a> <a id="15911" href="Games.OptimalPlays.html#15889" class="Bound">X</a>
 <a id="15914" class="Symbol">â†’</a> <a id="15916" class="Symbol">(</a><a id="15917" href="Games.OptimalPlays.html#15917" class="Bound">Ï•</a> <a id="15919" class="Symbol">:</a> <a id="15921" href="MonadOnTypes.K.html#471" class="Function">K</a> <a id="15923" href="Games.OptimalPlays.html#15889" class="Bound">X</a><a id="15924" class="Symbol">)</a>
 <a id="15927" class="Symbol">â†’</a> <a id="15929" href="MLTT.Negation.html#278" class="Function Operator">Â¬</a> <a id="15931" href="MonadOnTypes.JK.html#629" class="Function">is-attainable</a> <a id="15945" href="Games.OptimalPlays.html#15917" class="Bound">Ï•</a>
<a id="15947" href="Games.OptimalPlays.html#15837" class="Function">quantifiers-over-empty-types-are-not-attainable</a> <a id="15995" href="Games.OptimalPlays.html#15995" class="Bound">e</a> <a id="15997" href="Games.OptimalPlays.html#15997" class="Bound">Ï•</a> <a id="15999" class="Symbol">(</a><a id="16000" href="Games.OptimalPlays.html#16000" class="Bound">Îµ</a> <a id="16002" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="16004" href="Games.OptimalPlays.html#16004" class="Bound">a</a><a id="16005" class="Symbol">)</a>
 <a id="16008" class="Symbol">=</a> <a id="16010" href="Games.OptimalPlays.html#15995" class="Bound">e</a> <a id="16012" class="Symbol">(</a><a id="16013" href="Games.OptimalPlays.html#16000" class="Bound">Îµ</a> <a id="16015" class="Symbol">(</a><a id="16016" href="MLTT.Empty.html#288" class="Function">unique-from-ğŸ˜</a> <a id="16030" href="MLTT.Pi.html#513" class="Function Operator">âˆ˜</a> <a id="16032" href="Games.OptimalPlays.html#15995" class="Bound">e</a><a id="16033" class="Symbol">))</a>

<a id="16037" class="Markup">\end{code}</a><a id="16047" class="Background">

TODO. It is not in general decidable whether a quantifier is attainable.

Added 17th September. We calculate the subtree of the game tree whose
paths are precisely the optimal plays of the original game.

</a><a id="16254" class="Markup">\begin{code}</a>

<a id="prune"></a><a id="16268" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="16274" class="Symbol">:</a> <a id="16276" class="Symbol">(</a><a id="16277" href="Games.OptimalPlays.html#16277" class="Bound">Xt</a> <a id="16280" class="Symbol">:</a> <a id="16282" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="16283" class="Symbol">)</a>
        <a id="16293" class="Symbol">(</a><a id="16294" href="Games.OptimalPlays.html#16294" class="Bound">q</a> <a id="16296" class="Symbol">:</a> <a id="16298" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="16303" href="Games.OptimalPlays.html#16277" class="Bound">Xt</a> <a id="16306" class="Symbol">â†’</a> <a id="16308" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="16309" class="Symbol">)</a>
        <a id="16319" class="Symbol">(</a><a id="16320" href="Games.OptimalPlays.html#16320" class="Bound">Ï•t</a> <a id="16323" class="Symbol">:</a> <a id="16325" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="16327" href="Games.OptimalPlays.html#16277" class="Bound">Xt</a><a id="16329" class="Symbol">)</a>
      <a id="16337" class="Symbol">â†’</a> <a id="16339" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a>
<a id="16341" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="16347" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a> <a id="16350" href="Games.OptimalPlays.html#16350" class="Bound">q</a> <a id="16352" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="16355" class="Symbol">=</a> <a id="16357" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a>
<a id="16360" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="16366" class="Symbol">(</a><a id="16367" href="Games.OptimalPlays.html#16367" class="Bound">X</a> <a id="16369" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="16371" href="Games.OptimalPlays.html#16371" class="Bound">Xf</a><a id="16373" class="Symbol">)</a> <a id="16375" href="Games.OptimalPlays.html#16375" class="Bound">q</a> <a id="16377" class="Symbol">(</a><a id="16378" href="Games.OptimalPlays.html#16378" class="Bound">Ï•</a> <a id="16380" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="16383" href="Games.OptimalPlays.html#16383" class="Bound">Ï•f</a><a id="16385" class="Symbol">)</a> <a id="16387" class="Symbol">=</a> <a id="16389" class="Symbol">(</a><a id="16390" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="16392" href="Games.OptimalPlays.html#16392" class="Bound">x</a> <a id="16394" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="16396" href="Games.OptimalPlays.html#16367" class="Bound">X</a> <a id="16398" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="16400" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="16416" href="Games.OptimalPlays.html#16375" class="Bound">q</a> <a id="16418" href="Games.OptimalPlays.html#16378" class="Bound">Ï•</a> <a id="16420" href="Games.OptimalPlays.html#16383" class="Bound">Ï•f</a> <a id="16423" href="Games.OptimalPlays.html#16392" class="Bound">x</a><a id="16424" class="Symbol">)</a>
                           <a id="16453" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="16455" class="Symbol">(Î»</a> <a id="16458" class="Symbol">(</a><a id="16459" href="Games.OptimalPlays.html#16459" class="Bound">x</a> <a id="16461" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="16463" href="Games.OptimalPlays.html#16463" class="Bound">o</a><a id="16464" class="Symbol">)</a> <a id="16466" class="Symbol">â†’</a> <a id="16468" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="16474" class="Symbol">(</a><a id="16475" href="Games.OptimalPlays.html#16371" class="Bound">Xf</a> <a id="16478" href="Games.OptimalPlays.html#16459" class="Bound">x</a><a id="16479" class="Symbol">)</a> <a id="16481" class="Symbol">(</a><a id="16482" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="16490" href="Games.OptimalPlays.html#16375" class="Bound">q</a> <a id="16492" href="Games.OptimalPlays.html#16459" class="Bound">x</a><a id="16493" class="Symbol">)</a> <a id="16495" class="Symbol">(</a><a id="16496" href="Games.OptimalPlays.html#16383" class="Bound">Ï•f</a> <a id="16499" href="Games.OptimalPlays.html#16459" class="Bound">x</a><a id="16500" class="Symbol">))</a>
<a id="16503" class="Markup">\end{code}</a><a id="16513" class="Background">

Notice that it may happen that the pruned tree is non-empty, but all
the nodes in the tree are empty types of moves. So we can&#39;t use the
pruned tree to decide whether or not there is an optimal
play. However, if we further assume that the types of moves in the
original tree are listed, we can decide this, and, moreover, get the
list of all optimal plays from the pruned tree *without* assuming that
the quantifiers are attainable (as we did above).

Each path in the pruned tree is a path in the original tree.

</a><a id="17029" class="Markup">\begin{code}</a>

<a id="inclusion"></a><a id="17043" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="17053" class="Symbol">:</a> <a id="17055" class="Symbol">{</a><a id="17056" href="Games.OptimalPlays.html#17056" class="Bound">Xt</a> <a id="17059" class="Symbol">:</a> <a id="17061" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="17062" class="Symbol">}</a>
            <a id="17076" class="Symbol">(</a><a id="17077" href="Games.OptimalPlays.html#17077" class="Bound">q</a> <a id="17079" class="Symbol">:</a> <a id="17081" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="17086" href="Games.OptimalPlays.html#17056" class="Bound">Xt</a> <a id="17089" class="Symbol">â†’</a> <a id="17091" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="17092" class="Symbol">)</a>
            <a id="17106" class="Symbol">(</a><a id="17107" href="Games.OptimalPlays.html#17107" class="Bound">Ï•t</a> <a id="17110" class="Symbol">:</a> <a id="17112" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="17114" href="Games.OptimalPlays.html#17056" class="Bound">Xt</a><a id="17116" class="Symbol">)</a>
          <a id="17128" class="Symbol">â†’</a> <a id="17130" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="17135" class="Symbol">(</a><a id="17136" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="17142" href="Games.OptimalPlays.html#17056" class="Bound">Xt</a> <a id="17145" href="Games.OptimalPlays.html#17077" class="Bound">q</a> <a id="17147" href="Games.OptimalPlays.html#17107" class="Bound">Ï•t</a><a id="17149" class="Symbol">)</a>
          <a id="17161" class="Symbol">â†’</a> <a id="17163" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="17168" href="Games.OptimalPlays.html#17056" class="Bound">Xt</a>
<a id="17171" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="17181" class="Symbol">{</a><a id="17182" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a><a id="17184" class="Symbol">}</a> <a id="17186" href="Games.OptimalPlays.html#17186" class="Bound">q</a> <a id="17188" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="17191" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="17194" class="Symbol">=</a> <a id="17196" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>
<a id="17199" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="17209" class="Symbol">{</a><a id="17210" href="Games.OptimalPlays.html#17210" class="Bound">X</a> <a id="17212" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="17214" href="Games.OptimalPlays.html#17214" class="Bound">Xf</a><a id="17216" class="Symbol">}</a> <a id="17218" href="Games.OptimalPlays.html#17218" class="Bound">q</a> <a id="17220" class="Symbol">(</a><a id="17221" href="Games.OptimalPlays.html#17221" class="Bound">Ï•</a> <a id="17223" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="17226" href="Games.OptimalPlays.html#17226" class="Bound">Ï•f</a><a id="17228" class="Symbol">)</a> <a id="17230" class="Symbol">((</a><a id="17232" href="Games.OptimalPlays.html#17232" class="Bound">x</a> <a id="17234" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="17236" class="Symbol">_)</a> <a id="17239" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="17242" href="Games.OptimalPlays.html#17242" class="Bound">xos</a><a id="17245" class="Symbol">)</a>
 <a id="17248" class="Symbol">=</a> <a id="17250" href="Games.OptimalPlays.html#17232" class="Bound">x</a> <a id="17252" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="17255" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="17265" class="Symbol">{</a><a id="17266" href="Games.OptimalPlays.html#17214" class="Bound">Xf</a> <a id="17269" href="Games.OptimalPlays.html#17232" class="Bound">x</a><a id="17270" class="Symbol">}</a> <a id="17272" class="Symbol">(</a><a id="17273" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="17281" href="Games.OptimalPlays.html#17218" class="Bound">q</a> <a id="17283" href="Games.OptimalPlays.html#17232" class="Bound">x</a><a id="17284" class="Symbol">)</a> <a id="17286" class="Symbol">(</a><a id="17287" href="Games.OptimalPlays.html#17226" class="Bound">Ï•f</a> <a id="17290" href="Games.OptimalPlays.html#17232" class="Bound">x</a><a id="17291" class="Symbol">)</a> <a id="17293" href="Games.OptimalPlays.html#17242" class="Bound">xos</a>

<a id="17298" class="Markup">\end{code}</a><a id="17308" class="Background">

The predicate q restricts to a predicate in the pruned tree.

</a><a id="17372" class="Markup">\begin{code}</a>

<a id="restriction"></a><a id="17386" href="Games.OptimalPlays.html#17386" class="Function">restriction</a> <a id="17398" class="Symbol">:</a> <a id="17400" class="Symbol">{</a><a id="17401" href="Games.OptimalPlays.html#17401" class="Bound">Xt</a> <a id="17404" class="Symbol">:</a> <a id="17406" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="17407" class="Symbol">}</a>
              <a id="17423" class="Symbol">(</a><a id="17424" href="Games.OptimalPlays.html#17424" class="Bound">q</a> <a id="17426" class="Symbol">:</a> <a id="17428" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="17433" href="Games.OptimalPlays.html#17401" class="Bound">Xt</a> <a id="17436" class="Symbol">â†’</a> <a id="17438" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="17439" class="Symbol">)</a>
              <a id="17455" class="Symbol">(</a><a id="17456" href="Games.OptimalPlays.html#17456" class="Bound">Ï•t</a> <a id="17459" class="Symbol">:</a> <a id="17461" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="17463" href="Games.OptimalPlays.html#17401" class="Bound">Xt</a><a id="17465" class="Symbol">)</a>
            <a id="17479" class="Symbol">â†’</a> <a id="17481" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="17486" class="Symbol">(</a><a id="17487" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="17493" href="Games.OptimalPlays.html#17401" class="Bound">Xt</a> <a id="17496" href="Games.OptimalPlays.html#17424" class="Bound">q</a> <a id="17498" href="Games.OptimalPlays.html#17456" class="Bound">Ï•t</a><a id="17500" class="Symbol">)</a> <a id="17502" class="Symbol">â†’</a> <a id="17504" href="Games.OptimalPlays.html#596" class="Bound">R</a>
<a id="17506" href="Games.OptimalPlays.html#17386" class="Function">restriction</a> <a id="17518" href="Games.OptimalPlays.html#17518" class="Bound">q</a> <a id="17520" href="Games.OptimalPlays.html#17520" class="Bound">Ï•t</a> <a id="17523" class="Symbol">=</a> <a id="17525" href="Games.OptimalPlays.html#17518" class="Bound">q</a> <a id="17527" href="MLTT.Pi.html#513" class="Function Operator">âˆ˜</a> <a id="17529" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="17539" href="Games.OptimalPlays.html#17518" class="Bound">q</a> <a id="17541" href="Games.OptimalPlays.html#17520" class="Bound">Ï•t</a>

<a id="17545" class="Markup">\end{code}</a><a id="17555" class="Background">

The paths in the pruned tree are precisely the optimals plays in the
original tree.

</a><a id="17642" class="Markup">\begin{code}</a>

<a id="lemmaâ†’"></a><a id="17656" href="Games.OptimalPlays.html#17656" class="Function">lemmaâ†’</a> <a id="17663" class="Symbol">:</a> <a id="17665" class="Symbol">{</a><a id="17666" href="Games.OptimalPlays.html#17666" class="Bound">Xt</a> <a id="17669" class="Symbol">:</a> <a id="17671" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="17672" class="Symbol">}</a>
         <a id="17683" class="Symbol">(</a><a id="17684" href="Games.OptimalPlays.html#17684" class="Bound">q</a> <a id="17686" class="Symbol">:</a> <a id="17688" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="17693" href="Games.OptimalPlays.html#17666" class="Bound">Xt</a> <a id="17696" class="Symbol">â†’</a> <a id="17698" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="17699" class="Symbol">)</a>
         <a id="17710" class="Symbol">(</a><a id="17711" href="Games.OptimalPlays.html#17711" class="Bound">Ï•t</a> <a id="17714" class="Symbol">:</a> <a id="17716" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="17718" href="Games.OptimalPlays.html#17666" class="Bound">Xt</a><a id="17720" class="Symbol">)</a>
       <a id="17729" class="Symbol">â†’</a> <a id="17731" class="Symbol">(</a><a id="17732" href="Games.OptimalPlays.html#17732" class="Bound">xos</a> <a id="17736" class="Symbol">:</a> <a id="17738" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="17743" class="Symbol">(</a><a id="17744" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="17750" href="Games.OptimalPlays.html#17666" class="Bound">Xt</a> <a id="17753" href="Games.OptimalPlays.html#17684" class="Bound">q</a> <a id="17755" href="Games.OptimalPlays.html#17711" class="Bound">Ï•t</a><a id="17757" class="Symbol">))</a>
       <a id="17767" class="Symbol">â†’</a> <a id="17769" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="17785" href="Games.OptimalPlays.html#17711" class="Bound">Ï•t</a> <a id="17788" href="Games.OptimalPlays.html#17684" class="Bound">q</a> <a id="17790" class="Symbol">(</a><a id="17791" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="17801" href="Games.OptimalPlays.html#17684" class="Bound">q</a> <a id="17803" href="Games.OptimalPlays.html#17711" class="Bound">Ï•t</a> <a id="17806" href="Games.OptimalPlays.html#17732" class="Bound">xos</a><a id="17809" class="Symbol">)</a>
<a id="17811" href="Games.OptimalPlays.html#17656" class="Function">lemmaâ†’</a> <a id="17818" class="Symbol">{</a><a id="17819" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a><a id="17821" class="Symbol">}</a> <a id="17823" href="Games.OptimalPlays.html#17823" class="Bound">q</a> <a id="17825" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="17828" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="17831" class="Symbol">=</a> <a id="17833" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>
<a id="17836" href="Games.OptimalPlays.html#17656" class="Function">lemmaâ†’</a> <a id="17843" class="Symbol">{</a><a id="17844" href="Games.OptimalPlays.html#17844" class="Bound">X</a> <a id="17846" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="17848" href="Games.OptimalPlays.html#17848" class="Bound">Xf</a><a id="17850" class="Symbol">}</a> <a id="17852" href="Games.OptimalPlays.html#17852" class="Bound">q</a> <a id="17854" class="Symbol">(</a><a id="17855" href="Games.OptimalPlays.html#17855" class="Bound">Ï•</a> <a id="17857" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="17860" href="Games.OptimalPlays.html#17860" class="Bound">Ï•f</a><a id="17862" class="Symbol">)</a> <a id="17864" class="Symbol">((</a><a id="17866" href="Games.OptimalPlays.html#17866" class="Bound">x</a> <a id="17868" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="17870" href="Games.OptimalPlays.html#17870" class="Bound">o</a><a id="17871" class="Symbol">)</a> <a id="17873" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="17876" href="Games.OptimalPlays.html#17876" class="Bound">xos</a><a id="17879" class="Symbol">)</a>
 <a id="17882" class="Symbol">=</a> <a id="17884" href="Games.OptimalPlays.html#17870" class="Bound">o</a> <a id="17886" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="17888" href="Games.OptimalPlays.html#17656" class="Function">lemmaâ†’</a> <a id="17895" class="Symbol">{</a><a id="17896" href="Games.OptimalPlays.html#17848" class="Bound">Xf</a> <a id="17899" href="Games.OptimalPlays.html#17866" class="Bound">x</a><a id="17900" class="Symbol">}</a> <a id="17902" class="Symbol">(</a><a id="17903" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="17911" href="Games.OptimalPlays.html#17852" class="Bound">q</a> <a id="17913" href="Games.OptimalPlays.html#17866" class="Bound">x</a><a id="17914" class="Symbol">)</a> <a id="17916" class="Symbol">(</a><a id="17917" href="Games.OptimalPlays.html#17860" class="Bound">Ï•f</a> <a id="17920" href="Games.OptimalPlays.html#17866" class="Bound">x</a><a id="17921" class="Symbol">)</a> <a id="17923" href="Games.OptimalPlays.html#17876" class="Bound">xos</a>

<a id="lemmaâ†"></a><a id="17928" href="Games.OptimalPlays.html#17928" class="Function">lemmaâ†</a> <a id="17935" class="Symbol">:</a> <a id="17937" class="Symbol">{</a><a id="17938" href="Games.OptimalPlays.html#17938" class="Bound">Xt</a> <a id="17941" class="Symbol">:</a> <a id="17943" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="17944" class="Symbol">}</a>
         <a id="17955" class="Symbol">(</a><a id="17956" href="Games.OptimalPlays.html#17956" class="Bound">q</a> <a id="17958" class="Symbol">:</a> <a id="17960" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="17965" href="Games.OptimalPlays.html#17938" class="Bound">Xt</a> <a id="17968" class="Symbol">â†’</a> <a id="17970" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="17971" class="Symbol">)</a>
         <a id="17982" class="Symbol">(</a><a id="17983" href="Games.OptimalPlays.html#17983" class="Bound">Ï•t</a> <a id="17986" class="Symbol">:</a> <a id="17988" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="17990" href="Games.OptimalPlays.html#17938" class="Bound">Xt</a><a id="17992" class="Symbol">)</a>
         <a id="18003" class="Symbol">(</a><a id="18004" href="Games.OptimalPlays.html#18004" class="Bound">xs</a> <a id="18007" class="Symbol">:</a> <a id="18009" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="18014" href="Games.OptimalPlays.html#17938" class="Bound">Xt</a><a id="18016" class="Symbol">)</a>
       <a id="18025" class="Symbol">â†’</a> <a id="18027" href="Games.OptimalPlays.html#1548" class="Function">is-optimal-play</a> <a id="18043" href="Games.OptimalPlays.html#17983" class="Bound">Ï•t</a> <a id="18046" href="Games.OptimalPlays.html#17956" class="Bound">q</a> <a id="18048" href="Games.OptimalPlays.html#18004" class="Bound">xs</a>
       <a id="18058" class="Symbol">â†’</a> <a id="18060" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="18062" href="Games.OptimalPlays.html#18062" class="Bound">xos</a> <a id="18066" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="18068" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="18073" class="Symbol">(</a><a id="18074" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="18080" href="Games.OptimalPlays.html#17938" class="Bound">Xt</a> <a id="18083" href="Games.OptimalPlays.html#17956" class="Bound">q</a> <a id="18085" href="Games.OptimalPlays.html#17983" class="Bound">Ï•t</a><a id="18087" class="Symbol">)</a> <a id="18089" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="18091" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="18101" href="Games.OptimalPlays.html#17956" class="Bound">q</a> <a id="18103" href="Games.OptimalPlays.html#17983" class="Bound">Ï•t</a> <a id="18106" href="Games.OptimalPlays.html#18062" class="Bound">xos</a> <a id="18110" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="18112" href="Games.OptimalPlays.html#18004" class="Bound">xs</a>
<a id="18115" href="Games.OptimalPlays.html#17928" class="Function">lemmaâ†</a> <a id="18122" class="Symbol">{</a><a id="18123" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a><a id="18125" class="Symbol">}</a> <a id="18127" href="Games.OptimalPlays.html#18127" class="Bound">q</a> <a id="18129" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="18132" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="18135" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="18138" class="Symbol">=</a> <a id="18140" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="18143" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="18145" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>
<a id="18150" href="Games.OptimalPlays.html#17928" class="Function">lemmaâ†</a> <a id="18157" class="Symbol">{</a><a id="18158" href="Games.OptimalPlays.html#18158" class="Bound">X</a> <a id="18160" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="18162" href="Games.OptimalPlays.html#18162" class="Bound">Xf</a><a id="18164" class="Symbol">}</a> <a id="18166" href="Games.OptimalPlays.html#18166" class="Bound">q</a> <a id="18168" class="Symbol">(</a><a id="18169" href="Games.OptimalPlays.html#18169" class="Bound">Ï•</a> <a id="18171" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="18174" href="Games.OptimalPlays.html#18174" class="Bound">Ï•f</a><a id="18176" class="Symbol">)</a> <a id="18178" class="Symbol">(</a><a id="18179" href="Games.OptimalPlays.html#18179" class="Bound">x</a> <a id="18181" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="18184" href="Games.OptimalPlays.html#18184" class="Bound">xs</a><a id="18186" class="Symbol">)</a> <a id="18188" class="Symbol">(</a><a id="18189" href="Games.OptimalPlays.html#18189" class="Bound">o</a> <a id="18191" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="18194" href="Games.OptimalPlays.html#18194" class="Bound">os</a><a id="18196" class="Symbol">)</a>
 <a id="18199" class="Symbol">=</a> <a id="18201" class="Symbol">((</a><a id="18203" href="Games.OptimalPlays.html#18179" class="Bound">x</a> <a id="18205" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="18207" href="Games.OptimalPlays.html#18189" class="Bound">o</a><a id="18208" class="Symbol">)</a> <a id="18210" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="18213" href="MLTT.Sigma-Type.html#198" class="Field">prâ‚</a> <a id="18217" href="Games.OptimalPlays.html#18252" class="Function">IH</a><a id="18219" class="Symbol">)</a> <a id="18221" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="18223" href="MLTT.Id.html#1136" class="Function">ap</a> <a id="18226" class="Symbol">(</a><a id="18227" href="Games.OptimalPlays.html#18179" class="Bound">x</a> <a id="18229" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::_</a><a id="18232" class="Symbol">)</a> <a id="18234" class="Symbol">(</a><a id="18235" href="MLTT.Sigma-Type.html#209" class="Field">prâ‚‚</a> <a id="18239" href="Games.OptimalPlays.html#18252" class="Function">IH</a><a id="18241" class="Symbol">)</a>
 <a id="18244" class="Keyword">where</a>
  <a id="18252" href="Games.OptimalPlays.html#18252" class="Function">IH</a> <a id="18255" class="Symbol">:</a> <a id="18257" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="18259" href="Games.OptimalPlays.html#18259" class="Bound">xos</a> <a id="18263" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="18265" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="18270" class="Symbol">(</a><a id="18271" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="18277" class="Symbol">(</a><a id="18278" href="Games.OptimalPlays.html#18162" class="Bound">Xf</a> <a id="18281" href="Games.OptimalPlays.html#18179" class="Bound">x</a><a id="18282" class="Symbol">)</a> <a id="18284" class="Symbol">(</a><a id="18285" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="18293" href="Games.OptimalPlays.html#18166" class="Bound">q</a> <a id="18295" href="Games.OptimalPlays.html#18179" class="Bound">x</a><a id="18296" class="Symbol">)</a> <a id="18298" class="Symbol">(</a><a id="18299" href="Games.OptimalPlays.html#18174" class="Bound">Ï•f</a> <a id="18302" href="Games.OptimalPlays.html#18179" class="Bound">x</a><a id="18303" class="Symbol">))</a>
             <a id="18319" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="18321" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="18331" class="Symbol">(</a><a id="18332" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="18340" href="Games.OptimalPlays.html#18166" class="Bound">q</a> <a id="18342" href="Games.OptimalPlays.html#18179" class="Bound">x</a><a id="18343" class="Symbol">)</a> <a id="18345" class="Symbol">(</a><a id="18346" href="Games.OptimalPlays.html#18174" class="Bound">Ï•f</a> <a id="18349" href="Games.OptimalPlays.html#18179" class="Bound">x</a><a id="18350" class="Symbol">)</a> <a id="18352" href="Games.OptimalPlays.html#18259" class="Bound">xos</a> <a id="18356" href="MLTT.Id.html#193" class="Datatype Operator">ï¼</a> <a id="18358" href="Games.OptimalPlays.html#18184" class="Bound">xs</a>
  <a id="18363" href="Games.OptimalPlays.html#18252" class="Function">IH</a> <a id="18366" class="Symbol">=</a> <a id="18368" href="Games.OptimalPlays.html#17928" class="Function">lemmaâ†</a> <a id="18375" class="Symbol">{</a><a id="18376" href="Games.OptimalPlays.html#18162" class="Bound">Xf</a> <a id="18379" href="Games.OptimalPlays.html#18179" class="Bound">x</a><a id="18380" class="Symbol">}</a> <a id="18382" class="Symbol">(</a><a id="18383" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="18391" href="Games.OptimalPlays.html#18166" class="Bound">q</a> <a id="18393" href="Games.OptimalPlays.html#18179" class="Bound">x</a><a id="18394" class="Symbol">)</a> <a id="18396" class="Symbol">(</a><a id="18397" href="Games.OptimalPlays.html#18174" class="Bound">Ï•f</a> <a id="18400" href="Games.OptimalPlays.html#18179" class="Bound">x</a><a id="18401" class="Symbol">)</a> <a id="18403" href="Games.OptimalPlays.html#18184" class="Bound">xs</a> <a id="18406" href="Games.OptimalPlays.html#18194" class="Bound">os</a>

<a id="18410" class="Markup">\end{code}</a><a id="18420" class="Background">

This gives an alternative way to calculate the list of optimal plays,
which doesn&#39;t use selection functions.

Added 8th October 2025.

TODO. Move the following general purpose functions on paths and on
lists to appropriate modules. Also think of better names for the
functions.

</a><a id="18701" class="Markup">\begin{code}</a>

<a id="18715" class="Keyword">module</a> <a id="18722" href="Games.OptimalPlays.html#18722" class="Module">_</a> <a id="18724" class="Symbol">{</a><a id="18725" href="Games.OptimalPlays.html#18725" class="Bound">X</a> <a id="18727" class="Symbol">:</a> <a id="18729" href="Notation.General.html#372" class="Function">Type</a><a id="18733" class="Symbol">}</a>
         <a id="18744" class="Symbol">{</a><a id="18745" href="Games.OptimalPlays.html#18745" class="Bound">Xf</a> <a id="18748" class="Symbol">:</a> <a id="18750" href="Games.OptimalPlays.html#18725" class="Bound">X</a> <a id="18752" class="Symbol">â†’</a> <a id="18754" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="18755" class="Symbol">}</a>
       <a id="18764" class="Keyword">where</a>

 <a id="18772" href="Games.OptimalPlays.html#18772" class="Function">prepend</a> <a id="18780" class="Symbol">:</a> <a id="18782" class="Symbol">(</a><a id="18783" href="Games.OptimalPlays.html#18783" class="Bound">x</a> <a id="18785" class="Symbol">:</a> <a id="18787" href="Games.OptimalPlays.html#18725" class="Bound">X</a><a id="18788" class="Symbol">)</a>
         <a id="18799" class="Symbol">â†’</a> <a id="18801" href="MLTT.List.html#488" class="Datatype">List</a> <a id="18806" class="Symbol">(</a><a id="18807" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="18812" class="Symbol">(</a><a id="18813" href="Games.OptimalPlays.html#18745" class="Bound">Xf</a> <a id="18816" href="Games.OptimalPlays.html#18783" class="Bound">x</a><a id="18817" class="Symbol">))</a>
         <a id="18829" class="Symbol">â†’</a> <a id="18831" href="MLTT.List.html#488" class="Datatype">List</a> <a id="18836" class="Symbol">(</a><a id="18837" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="18842" class="Symbol">(</a><a id="18843" href="Games.OptimalPlays.html#18725" class="Bound">X</a> <a id="18845" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="18847" href="Games.OptimalPlays.html#18745" class="Bound">Xf</a><a id="18849" class="Symbol">))</a>
 <a id="18853" href="Games.OptimalPlays.html#18772" class="Function">prepend</a> <a id="18861" href="Games.OptimalPlays.html#18861" class="Bound">x</a> <a id="18863" href="MLTT.List.html#521" class="InductiveConstructor">[]</a> <a id="18866" class="Symbol">=</a> <a id="18868" href="MLTT.List.html#521" class="InductiveConstructor">[]</a>
 <a id="18872" href="Games.OptimalPlays.html#18772" class="Function">prepend</a> <a id="18880" href="Games.OptimalPlays.html#18880" class="Bound">x</a> <a id="18882" class="Symbol">(</a><a id="18883" href="Games.OptimalPlays.html#18883" class="Bound">xs</a> <a id="18886" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="18888" href="Games.OptimalPlays.html#18888" class="Bound">xss</a><a id="18891" class="Symbol">)</a> <a id="18893" class="Symbol">=</a> <a id="18895" class="Symbol">(</a><a id="18896" href="Games.OptimalPlays.html#18880" class="Bound">x</a> <a id="18898" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="18901" href="Games.OptimalPlays.html#18883" class="Bound">xs</a><a id="18903" class="Symbol">)</a> <a id="18905" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="18907" href="Games.OptimalPlays.html#18772" class="Function">prepend</a> <a id="18915" href="Games.OptimalPlays.html#18880" class="Bound">x</a> <a id="18917" href="Games.OptimalPlays.html#18888" class="Bound">xss</a>

 <a id="18923" href="Games.OptimalPlays.html#18923" class="Function">map-prepend</a> <a id="18935" class="Symbol">:</a> <a id="18937" class="Symbol">((</a><a id="18939" href="Games.OptimalPlays.html#18939" class="Bound">x</a> <a id="18941" class="Symbol">:</a> <a id="18943" href="Games.OptimalPlays.html#18725" class="Bound">X</a><a id="18944" class="Symbol">)</a> <a id="18946" class="Symbol">â†’</a> <a id="18948" href="MLTT.List.html#488" class="Datatype">List</a> <a id="18953" class="Symbol">(</a><a id="18954" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="18959" class="Symbol">(</a><a id="18960" href="Games.OptimalPlays.html#18745" class="Bound">Xf</a> <a id="18963" href="Games.OptimalPlays.html#18939" class="Bound">x</a><a id="18964" class="Symbol">)))</a>
             <a id="18981" class="Symbol">â†’</a> <a id="18983" href="MLTT.List.html#488" class="Datatype">List</a> <a id="18988" href="Games.OptimalPlays.html#18725" class="Bound">X</a>
             <a id="19003" class="Symbol">â†’</a> <a id="19005" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19010" class="Symbol">(</a><a id="19011" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19016" class="Symbol">(</a><a id="19017" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="19022" class="Symbol">(</a><a id="19023" href="Games.OptimalPlays.html#18725" class="Bound">X</a> <a id="19025" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="19027" href="Games.OptimalPlays.html#18745" class="Bound">Xf</a><a id="19029" class="Symbol">)))</a>
 <a id="19034" href="Games.OptimalPlays.html#18923" class="Function">map-prepend</a> <a id="19046" href="Games.OptimalPlays.html#19046" class="Bound">f</a> <a id="19048" href="MLTT.List.html#521" class="InductiveConstructor">[]</a> <a id="19051" class="Symbol">=</a> <a id="19053" href="MLTT.List.html#521" class="InductiveConstructor">[]</a>
 <a id="19057" href="Games.OptimalPlays.html#18923" class="Function">map-prepend</a> <a id="19069" href="Games.OptimalPlays.html#19069" class="Bound">f</a> <a id="19071" class="Symbol">(</a><a id="19072" href="Games.OptimalPlays.html#19072" class="Bound">x</a> <a id="19074" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="19076" href="Games.OptimalPlays.html#19076" class="Bound">xs</a><a id="19078" class="Symbol">)</a> <a id="19080" class="Symbol">=</a> <a id="19082" href="Games.OptimalPlays.html#18772" class="Function">prepend</a> <a id="19090" href="Games.OptimalPlays.html#19072" class="Bound">x</a> <a id="19092" class="Symbol">(</a><a id="19093" href="Games.OptimalPlays.html#19069" class="Bound">f</a> <a id="19095" href="Games.OptimalPlays.html#19072" class="Bound">x</a><a id="19096" class="Symbol">)</a> <a id="19098" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="19100" href="Games.OptimalPlays.html#18923" class="Function">map-prepend</a> <a id="19112" href="Games.OptimalPlays.html#19069" class="Bound">f</a> <a id="19114" href="Games.OptimalPlays.html#19076" class="Bound">xs</a>

 <a id="19119" href="Games.OptimalPlays.html#19119" class="Function">map-concat-prepend</a> <a id="19138" class="Symbol">:</a> <a id="19140" class="Symbol">((</a><a id="19142" href="Games.OptimalPlays.html#19142" class="Bound">x</a> <a id="19144" class="Symbol">:</a> <a id="19146" href="Games.OptimalPlays.html#18725" class="Bound">X</a><a id="19147" class="Symbol">)</a> <a id="19149" class="Symbol">â†’</a> <a id="19151" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19156" class="Symbol">(</a><a id="19157" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="19162" class="Symbol">(</a><a id="19163" href="Games.OptimalPlays.html#18745" class="Bound">Xf</a> <a id="19166" href="Games.OptimalPlays.html#19142" class="Bound">x</a><a id="19167" class="Symbol">)))</a>
                    <a id="19191" class="Symbol">â†’</a> <a id="19193" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19198" href="Games.OptimalPlays.html#18725" class="Bound">X</a>
                    <a id="19220" class="Symbol">â†’</a> <a id="19222" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19227" class="Symbol">(</a><a id="19228" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="19233" class="Symbol">(</a><a id="19234" href="Games.OptimalPlays.html#18725" class="Bound">X</a> <a id="19236" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="19238" href="Games.OptimalPlays.html#18745" class="Bound">Xf</a><a id="19240" class="Symbol">))</a>
 <a id="19244" href="Games.OptimalPlays.html#19119" class="Function">map-concat-prepend</a> <a id="19263" href="Games.OptimalPlays.html#19263" class="Bound">f</a> <a id="19265" href="MLTT.List.html#521" class="InductiveConstructor">[]</a> <a id="19268" class="Symbol">=</a> <a id="19270" href="MLTT.List.html#521" class="InductiveConstructor">[]</a>
 <a id="19274" href="Games.OptimalPlays.html#19119" class="Function">map-concat-prepend</a> <a id="19293" href="Games.OptimalPlays.html#19293" class="Bound">f</a> <a id="19295" class="Symbol">(</a><a id="19296" href="Games.OptimalPlays.html#19296" class="Bound">x</a> <a id="19298" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="19300" href="Games.OptimalPlays.html#19300" class="Bound">xs</a><a id="19302" class="Symbol">)</a> <a id="19304" class="Symbol">=</a> <a id="19306" href="Games.OptimalPlays.html#18772" class="Function">prepend</a> <a id="19314" href="Games.OptimalPlays.html#19296" class="Bound">x</a> <a id="19316" class="Symbol">(</a><a id="19317" href="Games.OptimalPlays.html#19293" class="Bound">f</a> <a id="19319" href="Games.OptimalPlays.html#19296" class="Bound">x</a><a id="19320" class="Symbol">)</a> <a id="19322" href="MLTT.List.html#1772" class="Function Operator">++</a> <a id="19325" href="Games.OptimalPlays.html#19119" class="Function">map-concat-prepend</a> <a id="19344" href="Games.OptimalPlays.html#19293" class="Bound">f</a> <a id="19346" href="Games.OptimalPlays.html#19300" class="Bound">xs</a>


<a id="list-of-paths"></a><a id="19351" href="Games.OptimalPlays.html#19351" class="Function">list-of-paths</a> <a id="19365" class="Symbol">:</a> <a id="19367" class="Symbol">(</a><a id="19368" href="Games.OptimalPlays.html#19368" class="Bound">Xt</a> <a id="19371" class="Symbol">:</a> <a id="19373" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="19374" class="Symbol">)</a>
                <a id="19392" class="Symbol">(</a><a id="19393" href="Games.OptimalPlays.html#19393" class="Bound">Xt-is-listed</a> <a id="19406" class="Symbol">:</a> <a id="19408" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="19418" href="MLTT.List.html#6385" class="Function">listed</a> <a id="19425" href="Games.OptimalPlays.html#19368" class="Bound">Xt</a><a id="19427" class="Symbol">)</a>
              <a id="19443" class="Symbol">â†’</a> <a id="19445" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19450" class="Symbol">(</a><a id="19451" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="19456" href="Games.OptimalPlays.html#19368" class="Bound">Xt</a><a id="19458" class="Symbol">)</a>
<a id="19460" href="Games.OptimalPlays.html#19351" class="Function">list-of-paths</a> <a id="19474" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a> <a id="19477" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="19480" class="Symbol">=</a> <a id="19482" href="MLTT.List.html#521" class="InductiveConstructor">[]</a>
<a id="19485" href="Games.OptimalPlays.html#19351" class="Function">list-of-paths</a> <a id="19499" class="Symbol">(</a><a id="19500" href="Games.OptimalPlays.html#19500" class="Bound">X</a> <a id="19502" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="19504" href="Games.OptimalPlays.html#19504" class="Bound">Xf</a><a id="19506" class="Symbol">)</a> <a id="19508" class="Symbol">((</a><a id="19510" href="Games.OptimalPlays.html#19510" class="Bound">xs</a> <a id="19513" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="19515" href="Games.OptimalPlays.html#19515" class="Bound">m</a><a id="19516" class="Symbol">)</a> <a id="19518" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="19520" href="Games.OptimalPlays.html#19520" class="Bound">Xf-is-listed</a><a id="19532" class="Symbol">)</a> <a id="19534" class="Symbol">=</a> <a id="19536" href="Games.OptimalPlays.html#19119" class="Function">map-concat-prepend</a> <a id="19555" href="Games.OptimalPlays.html#19570" class="Function">IH</a> <a id="19558" href="Games.OptimalPlays.html#19510" class="Bound">xs</a>
 <a id="19562" class="Keyword">where</a>
  <a id="19570" href="Games.OptimalPlays.html#19570" class="Function">IH</a> <a id="19573" class="Symbol">:</a> <a id="19575" class="Symbol">(</a><a id="19576" href="Games.OptimalPlays.html#19576" class="Bound">x</a> <a id="19578" class="Symbol">:</a> <a id="19580" href="Games.OptimalPlays.html#19500" class="Bound">X</a><a id="19581" class="Symbol">)</a> <a id="19583" class="Symbol">â†’</a> <a id="19585" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19590" class="Symbol">(</a><a id="19591" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="19596" class="Symbol">(</a><a id="19597" href="Games.OptimalPlays.html#19504" class="Bound">Xf</a> <a id="19600" href="Games.OptimalPlays.html#19576" class="Bound">x</a><a id="19601" class="Symbol">))</a>
  <a id="19606" href="Games.OptimalPlays.html#19570" class="Function">IH</a> <a id="19609" href="Games.OptimalPlays.html#19609" class="Bound">x</a> <a id="19611" class="Symbol">=</a> <a id="19613" href="Games.OptimalPlays.html#19351" class="Function">list-of-paths</a> <a id="19627" class="Symbol">(</a><a id="19628" href="Games.OptimalPlays.html#19504" class="Bound">Xf</a> <a id="19631" href="Games.OptimalPlays.html#19609" class="Bound">x</a><a id="19632" class="Symbol">)</a> <a id="19634" class="Symbol">(</a><a id="19635" href="Games.OptimalPlays.html#19520" class="Bound">Xf-is-listed</a> <a id="19648" href="Games.OptimalPlays.html#19609" class="Bound">x</a><a id="19649" class="Symbol">)</a>

<a id="conditionally-prepend"></a><a id="19652" href="Games.OptimalPlays.html#19652" class="Function">conditionally-prepend</a> <a id="19674" class="Symbol">:</a> <a id="19676" class="Symbol">{</a><a id="19677" href="Games.OptimalPlays.html#19677" class="Bound">X</a> <a id="19679" class="Symbol">:</a> <a id="19681" href="MLTT.Universes.html#3834" class="Generalizable">ğ“¤</a> <a id="19683" href="MLTT.Universes.html#3977" class="Function Operator">Ì‡</a> <a id="19685" class="Symbol">}</a> <a id="19687" class="Symbol">(</a><a id="19688" href="Games.OptimalPlays.html#19688" class="Bound">A</a> <a id="19690" class="Symbol">:</a> <a id="19692" href="Games.OptimalPlays.html#19677" class="Bound">X</a> <a id="19694" class="Symbol">â†’</a> <a id="19696" href="MLTT.Universes.html#3836" class="Generalizable">ğ“¥</a> <a id="19698" href="MLTT.Universes.html#3977" class="Function Operator">Ì‡</a> <a id="19700" class="Symbol">)</a>
                      <a id="19724" class="Symbol">â†’</a> <a id="19726" class="Symbol">(</a><a id="19727" href="Games.OptimalPlays.html#19727" class="Bound">x</a> <a id="19729" class="Symbol">:</a> <a id="19731" href="Games.OptimalPlays.html#19677" class="Bound">X</a><a id="19732" class="Symbol">)</a>
                      <a id="19756" class="Symbol">â†’</a> <a id="19758" href="Games.OptimalPlays.html#19688" class="Bound">A</a> <a id="19760" href="Games.OptimalPlays.html#19727" class="Bound">x</a> <a id="19762" href="MLTT.Plus-Type.html#120" class="Datatype Operator">+</a> <a id="19764" href="MLTT.Negation.html#278" class="Function Operator">Â¬</a> <a id="19766" href="Games.OptimalPlays.html#19688" class="Bound">A</a> <a id="19768" href="Games.OptimalPlays.html#19727" class="Bound">x</a>
                      <a id="19792" class="Symbol">â†’</a> <a id="19794" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19799" class="Symbol">(</a><a id="19800" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="19802" href="Games.OptimalPlays.html#19802" class="Bound">x</a> <a id="19804" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="19806" href="Games.OptimalPlays.html#19677" class="Bound">X</a> <a id="19808" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="19810" href="Games.OptimalPlays.html#19688" class="Bound">A</a> <a id="19812" href="Games.OptimalPlays.html#19802" class="Bound">x</a><a id="19813" class="Symbol">)</a>
                      <a id="19837" class="Symbol">â†’</a> <a id="19839" href="MLTT.List.html#488" class="Datatype">List</a> <a id="19844" class="Symbol">(</a><a id="19845" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="19847" href="Games.OptimalPlays.html#19847" class="Bound">x</a> <a id="19849" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="19851" href="Games.OptimalPlays.html#19677" class="Bound">X</a> <a id="19853" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="19855" href="Games.OptimalPlays.html#19688" class="Bound">A</a> <a id="19857" href="Games.OptimalPlays.html#19847" class="Bound">x</a><a id="19858" class="Symbol">)</a>
<a id="19860" href="Games.OptimalPlays.html#19652" class="Function">conditionally-prepend</a> <a id="19882" href="Games.OptimalPlays.html#19882" class="Bound">A</a> <a id="19884" href="Games.OptimalPlays.html#19884" class="Bound">x</a> <a id="19886" class="Symbol">(</a><a id="19887" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="19891" href="Games.OptimalPlays.html#19891" class="Bound">a</a><a id="19892" class="Symbol">)</a> <a id="19894" href="Games.OptimalPlays.html#19894" class="Bound">ys</a> <a id="19897" class="Symbol">=</a> <a id="19899" class="Symbol">(</a><a id="19900" href="Games.OptimalPlays.html#19884" class="Bound">x</a> <a id="19902" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="19904" href="Games.OptimalPlays.html#19891" class="Bound">a</a><a id="19905" class="Symbol">)</a> <a id="19907" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="19909" href="Games.OptimalPlays.html#19894" class="Bound">ys</a>
<a id="19912" href="Games.OptimalPlays.html#19652" class="Function">conditionally-prepend</a> <a id="19934" href="Games.OptimalPlays.html#19934" class="Bound">A</a> <a id="19936" href="Games.OptimalPlays.html#19936" class="Bound">x</a> <a id="19938" class="Symbol">(</a><a id="19939" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="19943" class="Symbol">_)</a> <a id="19946" href="Games.OptimalPlays.html#19946" class="Bound">ys</a> <a id="19949" class="Symbol">=</a> <a id="19951" href="Games.OptimalPlays.html#19946" class="Bound">ys</a>


<a id="filter&#39;"></a><a id="19956" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="19964" class="Symbol">:</a> <a id="19966" class="Symbol">{</a><a id="19967" href="Games.OptimalPlays.html#19967" class="Bound">X</a> <a id="19969" class="Symbol">:</a> <a id="19971" href="MLTT.Universes.html#3834" class="Generalizable">ğ“¤</a> <a id="19973" href="MLTT.Universes.html#3977" class="Function Operator">Ì‡</a> <a id="19975" class="Symbol">}</a>
          <a id="19987" class="Symbol">(</a><a id="19988" href="Games.OptimalPlays.html#19988" class="Bound">A</a> <a id="19990" class="Symbol">:</a> <a id="19992" href="Games.OptimalPlays.html#19967" class="Bound">X</a> <a id="19994" class="Symbol">â†’</a> <a id="19996" href="MLTT.Universes.html#3836" class="Generalizable">ğ“¥</a> <a id="19998" href="MLTT.Universes.html#3977" class="Function Operator">Ì‡</a> <a id="20000" class="Symbol">)</a>
        <a id="20010" class="Symbol">â†’</a> <a id="20012" class="Symbol">((</a><a id="20014" href="Games.OptimalPlays.html#20014" class="Bound">x</a> <a id="20016" class="Symbol">:</a> <a id="20018" href="Games.OptimalPlays.html#19967" class="Bound">X</a><a id="20019" class="Symbol">)</a> <a id="20021" class="Symbol">â†’</a> <a id="20023" href="Games.OptimalPlays.html#19988" class="Bound">A</a> <a id="20025" href="Games.OptimalPlays.html#20014" class="Bound">x</a> <a id="20027" href="MLTT.Plus-Type.html#120" class="Datatype Operator">+</a> <a id="20029" href="MLTT.Negation.html#278" class="Function Operator">Â¬</a> <a id="20031" href="Games.OptimalPlays.html#19988" class="Bound">A</a> <a id="20033" href="Games.OptimalPlays.html#20014" class="Bound">x</a><a id="20034" class="Symbol">)</a>
        <a id="20044" class="Symbol">â†’</a> <a id="20046" href="MLTT.List.html#488" class="Datatype">List</a> <a id="20051" href="Games.OptimalPlays.html#19967" class="Bound">X</a>
        <a id="20061" class="Symbol">â†’</a> <a id="20063" href="MLTT.List.html#488" class="Datatype">List</a> <a id="20068" class="Symbol">(</a><a id="20069" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="20071" href="Games.OptimalPlays.html#20071" class="Bound">x</a> <a id="20073" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="20075" href="Games.OptimalPlays.html#19967" class="Bound">X</a> <a id="20077" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="20079" href="Games.OptimalPlays.html#19988" class="Bound">A</a> <a id="20081" href="Games.OptimalPlays.html#20071" class="Bound">x</a><a id="20082" class="Symbol">)</a>
<a id="20084" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="20092" href="Games.OptimalPlays.html#20092" class="Bound">A</a> <a id="20094" href="Games.OptimalPlays.html#20094" class="Bound">Î´</a> <a id="20096" href="MLTT.List.html#521" class="InductiveConstructor">[]</a>       <a id="20105" class="Symbol">=</a> <a id="20107" href="MLTT.List.html#521" class="InductiveConstructor">[]</a>
<a id="20110" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="20118" href="Games.OptimalPlays.html#20118" class="Bound">A</a> <a id="20120" href="Games.OptimalPlays.html#20120" class="Bound">Î´</a> <a id="20122" class="Symbol">(</a><a id="20123" href="Games.OptimalPlays.html#20123" class="Bound">x</a> <a id="20125" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="20127" href="Games.OptimalPlays.html#20127" class="Bound">xs</a><a id="20129" class="Symbol">)</a> <a id="20131" class="Symbol">=</a> <a id="20133" href="Games.OptimalPlays.html#19652" class="Function">conditionally-prepend</a> <a id="20155" href="Games.OptimalPlays.html#20118" class="Bound">A</a> <a id="20157" href="Games.OptimalPlays.html#20123" class="Bound">x</a> <a id="20159" class="Symbol">(</a><a id="20160" href="Games.OptimalPlays.html#20120" class="Bound">Î´</a> <a id="20162" href="Games.OptimalPlays.html#20123" class="Bound">x</a><a id="20163" class="Symbol">)</a> <a id="20165" class="Symbol">(</a><a id="20166" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="20174" href="Games.OptimalPlays.html#20118" class="Bound">A</a> <a id="20176" href="Games.OptimalPlays.html#20120" class="Bound">Î´</a> <a id="20178" href="Games.OptimalPlays.html#20127" class="Bound">xs</a><a id="20180" class="Symbol">)</a>

<a id="filter&#39;-memberâ†"></a><a id="20183" href="Games.OptimalPlays.html#20183" class="Function">filter&#39;-memberâ†</a> <a id="20199" class="Symbol">:</a> <a id="20201" class="Symbol">{</a><a id="20202" href="Games.OptimalPlays.html#20202" class="Bound">X</a> <a id="20204" class="Symbol">:</a> <a id="20206" href="MLTT.Universes.html#3834" class="Generalizable">ğ“¤</a> <a id="20208" href="MLTT.Universes.html#3977" class="Function Operator">Ì‡</a> <a id="20210" class="Symbol">}</a>
                  <a id="20230" class="Symbol">(</a><a id="20231" href="Games.OptimalPlays.html#20231" class="Bound">A</a> <a id="20233" class="Symbol">:</a> <a id="20235" href="Games.OptimalPlays.html#20202" class="Bound">X</a> <a id="20237" class="Symbol">â†’</a> <a id="20239" href="MLTT.Universes.html#3836" class="Generalizable">ğ“¥</a> <a id="20241" href="MLTT.Universes.html#3977" class="Function Operator">Ì‡</a> <a id="20243" class="Symbol">)</a>
                  <a id="20263" class="Symbol">(</a><a id="20264" href="Games.OptimalPlays.html#20264" class="Bound">Î´</a> <a id="20266" class="Symbol">:</a> <a id="20268" class="Symbol">(</a><a id="20269" href="Games.OptimalPlays.html#20269" class="Bound">x</a> <a id="20271" class="Symbol">:</a> <a id="20273" href="Games.OptimalPlays.html#20202" class="Bound">X</a><a id="20274" class="Symbol">)</a> <a id="20276" class="Symbol">â†’</a> <a id="20278" href="Games.OptimalPlays.html#20231" class="Bound">A</a> <a id="20280" href="Games.OptimalPlays.html#20269" class="Bound">x</a> <a id="20282" href="MLTT.Plus-Type.html#120" class="Datatype Operator">+</a> <a id="20284" href="MLTT.Negation.html#278" class="Function Operator">Â¬</a> <a id="20286" href="Games.OptimalPlays.html#20231" class="Bound">A</a> <a id="20288" href="Games.OptimalPlays.html#20269" class="Bound">x</a><a id="20289" class="Symbol">)</a>
                  <a id="20309" class="Symbol">(</a><a id="20310" href="Games.OptimalPlays.html#20310" class="Bound">A-is-prop-valued</a> <a id="20327" class="Symbol">:</a> <a id="20329" class="Symbol">(</a><a id="20330" href="Games.OptimalPlays.html#20330" class="Bound">x</a> <a id="20332" class="Symbol">:</a> <a id="20334" href="Games.OptimalPlays.html#20202" class="Bound">X</a><a id="20335" class="Symbol">)</a> <a id="20337" class="Symbol">â†’</a> <a id="20339" href="UF.Subsingletons.html#469" class="Function">is-prop</a> <a id="20347" class="Symbol">(</a><a id="20348" href="Games.OptimalPlays.html#20231" class="Bound">A</a> <a id="20350" href="Games.OptimalPlays.html#20330" class="Bound">x</a><a id="20351" class="Symbol">))</a>
                  <a id="20372" class="Symbol">(</a><a id="20373" href="Games.OptimalPlays.html#20373" class="Bound">y</a> <a id="20375" class="Symbol">:</a> <a id="20377" href="Games.OptimalPlays.html#20202" class="Bound">X</a><a id="20378" class="Symbol">)</a>
                  <a id="20398" class="Symbol">(</a><a id="20399" href="Games.OptimalPlays.html#20399" class="Bound">xs</a> <a id="20402" class="Symbol">:</a> <a id="20404" href="MLTT.List.html#488" class="Datatype">List</a> <a id="20409" href="Games.OptimalPlays.html#20202" class="Bound">X</a><a id="20410" class="Symbol">)</a>
                  <a id="20430" class="Symbol">(</a><a id="20431" href="Games.OptimalPlays.html#20431" class="Bound">a</a> <a id="20433" class="Symbol">:</a> <a id="20435" href="Games.OptimalPlays.html#20231" class="Bound">A</a> <a id="20437" href="Games.OptimalPlays.html#20373" class="Bound">y</a><a id="20438" class="Symbol">)</a>
                <a id="20456" class="Symbol">â†’</a> <a id="20458" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="20465" href="Games.OptimalPlays.html#20373" class="Bound">y</a> <a id="20467" href="Games.OptimalPlays.html#20399" class="Bound">xs</a>
                <a id="20486" class="Symbol">â†’</a> <a id="20488" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="20495" class="Symbol">(</a><a id="20496" href="Games.OptimalPlays.html#20373" class="Bound">y</a> <a id="20498" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="20500" href="Games.OptimalPlays.html#20431" class="Bound">a</a><a id="20501" class="Symbol">)</a> <a id="20503" class="Symbol">(</a><a id="20504" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="20512" href="Games.OptimalPlays.html#20231" class="Bound">A</a> <a id="20514" href="Games.OptimalPlays.html#20264" class="Bound">Î´</a> <a id="20516" href="Games.OptimalPlays.html#20399" class="Bound">xs</a><a id="20518" class="Symbol">)</a>
<a id="20520" href="Games.OptimalPlays.html#20183" class="Function">filter&#39;-memberâ†</a> <a id="20536" class="Symbol">{</a><a id="20537" href="Games.OptimalPlays.html#20537" class="Bound">ğ“¤</a><a id="20538" class="Symbol">}</a> <a id="20540" class="Symbol">{</a><a id="20541" href="Games.OptimalPlays.html#20541" class="Bound">ğ“¥</a><a id="20542" class="Symbol">}</a> <a id="20544" class="Symbol">{</a><a id="20545" href="Games.OptimalPlays.html#20545" class="Bound">X</a><a id="20546" class="Symbol">}</a> <a id="20548" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20550" href="Games.OptimalPlays.html#20550" class="Bound">Î´</a> <a id="20552" href="Games.OptimalPlays.html#20552" class="Bound">A-is-prop-valued</a> <a id="20569" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20571" class="Symbol">(</a><a id="20572" href="Games.OptimalPlays.html#20572" class="Bound">x</a> <a id="20574" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="20576" href="Games.OptimalPlays.html#20576" class="Bound">xs</a><a id="20578" class="Symbol">)</a> <a id="20580" class="Symbol">=</a> <a id="20582" href="Games.OptimalPlays.html#20604" class="Function">h</a> <a id="20584" href="Games.OptimalPlays.html#20572" class="Bound">x</a> <a id="20586" href="Games.OptimalPlays.html#20576" class="Bound">xs</a> <a id="20589" class="Symbol">(</a><a id="20590" href="Games.OptimalPlays.html#20550" class="Bound">Î´</a> <a id="20592" href="Games.OptimalPlays.html#20572" class="Bound">x</a><a id="20593" class="Symbol">)</a>
 <a id="20596" class="Keyword">where</a>
  <a id="20604" href="Games.OptimalPlays.html#20604" class="Function">h</a> <a id="20606" class="Symbol">:</a> <a id="20608" class="Symbol">(</a><a id="20609" href="Games.OptimalPlays.html#20609" class="Bound">x</a> <a id="20611" class="Symbol">:</a> <a id="20613" href="Games.OptimalPlays.html#20545" class="Bound">X</a><a id="20614" class="Symbol">)</a>
      <a id="20622" class="Symbol">(</a><a id="20623" href="Games.OptimalPlays.html#20623" class="Bound">xs</a> <a id="20626" class="Symbol">:</a> <a id="20628" href="MLTT.List.html#488" class="Datatype">List</a> <a id="20633" href="Games.OptimalPlays.html#20545" class="Bound">X</a><a id="20634" class="Symbol">)</a>
    <a id="20640" class="Symbol">â†’</a> <a id="20642" class="Symbol">(</a><a id="20643" href="Games.OptimalPlays.html#20643" class="Bound">d</a> <a id="20645" class="Symbol">:</a> <a id="20647" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20649" href="Games.OptimalPlays.html#20609" class="Bound">x</a> <a id="20651" href="MLTT.Plus-Type.html#120" class="Datatype Operator">+</a> <a id="20653" href="MLTT.Negation.html#278" class="Function Operator">Â¬</a> <a id="20655" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20657" href="Games.OptimalPlays.html#20609" class="Bound">x</a><a id="20658" class="Symbol">)</a>
      <a id="20666" class="Symbol">(</a><a id="20667" href="Games.OptimalPlays.html#20667" class="Bound">a</a> <a id="20669" class="Symbol">:</a> <a id="20671" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20673" href="Games.OptimalPlays.html#20569" class="Bound">y</a><a id="20674" class="Symbol">)</a>
    <a id="20680" class="Symbol">â†’</a> <a id="20682" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="20689" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20691" class="Symbol">(</a><a id="20692" href="Games.OptimalPlays.html#20609" class="Bound">x</a> <a id="20694" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="20696" href="Games.OptimalPlays.html#20623" class="Bound">xs</a><a id="20698" class="Symbol">)</a>
    <a id="20704" class="Symbol">â†’</a> <a id="20706" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="20713" class="Symbol">(</a><a id="20714" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20716" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="20718" href="Games.OptimalPlays.html#20667" class="Bound">a</a><a id="20719" class="Symbol">)</a> <a id="20721" class="Symbol">(</a><a id="20722" href="Games.OptimalPlays.html#19652" class="Function">conditionally-prepend</a> <a id="20744" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20746" href="Games.OptimalPlays.html#20609" class="Bound">x</a> <a id="20748" href="Games.OptimalPlays.html#20643" class="Bound">d</a> <a id="20750" class="Symbol">(</a><a id="20751" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="20759" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20761" href="Games.OptimalPlays.html#20550" class="Bound">Î´</a> <a id="20763" href="Games.OptimalPlays.html#20623" class="Bound">xs</a><a id="20765" class="Symbol">))</a>
  <a id="20770" href="Games.OptimalPlays.html#20604" class="Function">h</a> <a id="20772" href="Games.OptimalPlays.html#20772" class="Bound">x</a> <a id="20774" href="Games.OptimalPlays.html#20774" class="Bound">xs</a> <a id="20777" class="Symbol">(</a><a id="20778" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="20782" href="Games.OptimalPlays.html#20782" class="Bound">b</a><a id="20783" class="Symbol">)</a> <a id="20785" href="Games.OptimalPlays.html#20785" class="Bound">a</a> <a id="20787" href="MLTT.List.html#3461" class="InductiveConstructor">in-head</a> <a id="20795" class="Symbol">=</a> <a id="20797" href="Games.OptimalPlays.html#20880" class="Function">II</a>
   <a id="20803" class="Keyword">where</a>
    <a id="20813" href="Games.OptimalPlays.html#20813" class="Function">I</a> <a id="20815" class="Symbol">:</a> <a id="20817" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="20824" class="Symbol">(</a><a id="20825" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20827" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="20829" href="Games.OptimalPlays.html#20785" class="Bound">a</a><a id="20830" class="Symbol">)</a> <a id="20832" class="Symbol">((</a><a id="20834" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20836" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="20838" href="Games.OptimalPlays.html#20785" class="Bound">a</a><a id="20839" class="Symbol">)</a> <a id="20841" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="20843" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="20851" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20853" href="Games.OptimalPlays.html#20550" class="Bound">Î´</a> <a id="20855" href="Games.OptimalPlays.html#20774" class="Bound">xs</a><a id="20857" class="Symbol">)</a>
    <a id="20863" href="Games.OptimalPlays.html#20813" class="Function">I</a> <a id="20865" class="Symbol">=</a> <a id="20867" href="MLTT.List.html#3461" class="InductiveConstructor">in-head</a>

    <a id="20880" href="Games.OptimalPlays.html#20880" class="Function">II</a> <a id="20883" class="Symbol">:</a> <a id="20885" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="20892" class="Symbol">(</a><a id="20893" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20895" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="20897" href="Games.OptimalPlays.html#20785" class="Bound">a</a><a id="20898" class="Symbol">)</a> <a id="20900" class="Symbol">((</a><a id="20902" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20904" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="20906" href="Games.OptimalPlays.html#20782" class="Bound">b</a><a id="20907" class="Symbol">)</a> <a id="20909" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="20911" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="20919" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20921" href="Games.OptimalPlays.html#20550" class="Bound">Î´</a> <a id="20923" href="Games.OptimalPlays.html#20774" class="Bound">xs</a><a id="20925" class="Symbol">)</a>
    <a id="20931" href="Games.OptimalPlays.html#20880" class="Function">II</a> <a id="20934" class="Symbol">=</a> <a id="20936" href="MLTT.Id.html#735" class="Function">transport</a>
          <a id="20956" class="Symbol">(Î»</a> <a id="20959" href="Games.OptimalPlays.html#20959" class="Bound">-</a> <a id="20961" class="Symbol">â†’</a> <a id="20963" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="20970" class="Symbol">(</a><a id="20971" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20973" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="20975" href="Games.OptimalPlays.html#20785" class="Bound">a</a><a id="20976" class="Symbol">)</a> <a id="20978" class="Symbol">((</a><a id="20980" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="20982" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="20984" href="Games.OptimalPlays.html#20959" class="Bound">-</a><a id="20985" class="Symbol">)</a> <a id="20987" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="20989" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="20997" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="20999" href="Games.OptimalPlays.html#20550" class="Bound">Î´</a> <a id="21001" href="Games.OptimalPlays.html#20774" class="Bound">xs</a><a id="21003" class="Symbol">))</a>
          <a id="21016" class="Symbol">(</a><a id="21017" href="Games.OptimalPlays.html#20552" class="Bound">A-is-prop-valued</a> <a id="21034" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="21036" href="Games.OptimalPlays.html#20785" class="Bound">a</a> <a id="21038" href="Games.OptimalPlays.html#20782" class="Bound">b</a><a id="21039" class="Symbol">)</a>
          <a id="21051" href="Games.OptimalPlays.html#20813" class="Function">I</a>
  <a id="21055" href="Games.OptimalPlays.html#20604" class="Function">h</a> <a id="21057" href="Games.OptimalPlays.html#21057" class="Bound">x</a> <a id="21059" class="Symbol">(</a><a id="21060" href="Games.OptimalPlays.html#21060" class="Bound">x&#39;</a> <a id="21063" href="MLTT.List.html#534" class="InductiveConstructor Operator">âˆ·</a> <a id="21065" href="Games.OptimalPlays.html#21065" class="Bound">xs</a><a id="21067" class="Symbol">)</a> <a id="21069" class="Symbol">(</a><a id="21070" href="MLTT.Plus-Type.html#169" class="InductiveConstructor">inl</a> <a id="21074" href="Games.OptimalPlays.html#21074" class="Bound">b</a><a id="21075" class="Symbol">)</a> <a id="21077" href="Games.OptimalPlays.html#21077" class="Bound">a</a> <a id="21079" class="Symbol">(</a><a id="21080" href="MLTT.List.html#3516" class="InductiveConstructor">in-tail</a> <a id="21088" href="Games.OptimalPlays.html#21088" class="Bound">m</a><a id="21089" class="Symbol">)</a> <a id="21091" class="Symbol">=</a> <a id="21093" href="MLTT.List.html#3516" class="InductiveConstructor">in-tail</a> <a id="21101" class="Symbol">(</a><a id="21102" href="Games.OptimalPlays.html#20604" class="Function">h</a> <a id="21104" href="Games.OptimalPlays.html#21060" class="Bound">x&#39;</a> <a id="21107" href="Games.OptimalPlays.html#21065" class="Bound">xs</a> <a id="21110" class="Symbol">(</a><a id="21111" href="Games.OptimalPlays.html#20550" class="Bound">Î´</a> <a id="21113" href="Games.OptimalPlays.html#21060" class="Bound">x&#39;</a><a id="21115" class="Symbol">)</a> <a id="21117" href="Games.OptimalPlays.html#21077" class="Bound">a</a> <a id="21119" href="Games.OptimalPlays.html#21088" class="Bound">m</a><a id="21120" class="Symbol">)</a>
  <a id="21124" href="Games.OptimalPlays.html#20604" class="Function">h</a> <a id="21126" href="Games.OptimalPlays.html#21126" class="Bound">x</a> <a id="21128" href="Games.OptimalPlays.html#21128" class="Bound">xs</a> <a id="21131" class="Symbol">(</a><a id="21132" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="21136" href="Games.OptimalPlays.html#21136" class="Bound">r</a><a id="21137" class="Symbol">)</a> <a id="21139" href="Games.OptimalPlays.html#21139" class="Bound">a</a> <a id="21141" href="MLTT.List.html#3461" class="InductiveConstructor">in-head</a> <a id="21149" class="Symbol">=</a> <a id="21151" href="MLTT.Empty.html#356" class="Function">ğŸ˜-elim</a> <a id="21158" class="Symbol">(</a><a id="21159" href="Games.OptimalPlays.html#21136" class="Bound">r</a> <a id="21161" href="Games.OptimalPlays.html#21139" class="Bound">a</a><a id="21162" class="Symbol">)</a>
  <a id="21166" href="Games.OptimalPlays.html#20604" class="Function">h</a> <a id="21168" href="Games.OptimalPlays.html#21168" class="Bound">x</a> <a id="21170" href="Games.OptimalPlays.html#21170" class="Bound">xs</a> <a id="21173" class="Symbol">(</a><a id="21174" href="MLTT.Plus-Type.html#186" class="InductiveConstructor">inr</a> <a id="21178" href="Games.OptimalPlays.html#21178" class="Bound">xâ‚</a><a id="21180" class="Symbol">)</a> <a id="21182" href="Games.OptimalPlays.html#21182" class="Bound">a</a> <a id="21184" class="Symbol">(</a><a id="21185" href="MLTT.List.html#3516" class="InductiveConstructor">in-tail</a> <a id="21193" href="Games.OptimalPlays.html#21193" class="Bound">m</a><a id="21194" class="Symbol">)</a> <a id="21196" class="Symbol">=</a> <a id="21198" href="Games.OptimalPlays.html#20183" class="Function">filter&#39;-memberâ†</a> <a id="21214" href="Games.OptimalPlays.html#20548" class="Bound">A</a> <a id="21216" href="Games.OptimalPlays.html#20550" class="Bound">Î´</a> <a id="21218" href="Games.OptimalPlays.html#20552" class="Bound">A-is-prop-valued</a> <a id="21235" href="Games.OptimalPlays.html#20569" class="Bound">y</a> <a id="21237" href="Games.OptimalPlays.html#21170" class="Bound">xs</a> <a id="21240" href="Games.OptimalPlays.html#21182" class="Bound">a</a> <a id="21242" href="Games.OptimalPlays.html#21193" class="Bound">m</a>

<a id="detachable-subtype-of-listed-type-is-listed"></a><a id="21245" href="Games.OptimalPlays.html#21245" class="Function">detachable-subtype-of-listed-type-is-listed</a>
 <a id="21290" class="Symbol">:</a> <a id="21292" class="Symbol">{</a><a id="21293" href="Games.OptimalPlays.html#21293" class="Bound">X</a> <a id="21295" class="Symbol">:</a> <a id="21297" href="Notation.General.html#372" class="Function">Type</a><a id="21301" class="Symbol">}</a>
 <a id="21304" class="Symbol">â†’</a> <a id="21306" class="Symbol">(</a><a id="21307" href="Games.OptimalPlays.html#21307" class="Bound">A</a> <a id="21309" class="Symbol">:</a> <a id="21311" href="Games.OptimalPlays.html#21293" class="Bound">X</a> <a id="21313" class="Symbol">â†’</a> <a id="21315" href="Notation.General.html#372" class="Function">Type</a><a id="21319" class="Symbol">)</a>
 <a id="21322" class="Symbol">â†’</a> <a id="21324" class="Symbol">((</a><a id="21326" href="Games.OptimalPlays.html#21326" class="Bound">x</a> <a id="21328" class="Symbol">:</a> <a id="21330" href="Games.OptimalPlays.html#21293" class="Bound">X</a><a id="21331" class="Symbol">)</a> <a id="21333" class="Symbol">â†’</a> <a id="21335" href="MLTT.Negation.html#584" class="Function">is-decidable</a> <a id="21348" class="Symbol">(</a><a id="21349" href="Games.OptimalPlays.html#21307" class="Bound">A</a> <a id="21351" href="Games.OptimalPlays.html#21326" class="Bound">x</a><a id="21352" class="Symbol">))</a>
 <a id="21356" class="Symbol">â†’</a> <a id="21358" class="Symbol">((</a><a id="21360" href="Games.OptimalPlays.html#21360" class="Bound">x</a> <a id="21362" class="Symbol">:</a> <a id="21364" href="Games.OptimalPlays.html#21293" class="Bound">X</a><a id="21365" class="Symbol">)</a> <a id="21367" class="Symbol">â†’</a> <a id="21369" href="UF.Subsingletons.html#469" class="Function">is-prop</a> <a id="21377" class="Symbol">(</a><a id="21378" href="Games.OptimalPlays.html#21307" class="Bound">A</a> <a id="21380" href="Games.OptimalPlays.html#21360" class="Bound">x</a><a id="21381" class="Symbol">))</a>
 <a id="21385" class="Symbol">â†’</a> <a id="21387" href="MLTT.List.html#6385" class="Function">listed</a> <a id="21394" href="Games.OptimalPlays.html#21293" class="Bound">X</a>
 <a id="21397" class="Symbol">â†’</a> <a id="21399" href="MLTT.List.html#6385" class="Function">listed</a> <a id="21406" class="Symbol">(</a><a id="21407" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="21409" href="Games.OptimalPlays.html#21409" class="Bound">x</a> <a id="21411" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="21413" href="Games.OptimalPlays.html#21293" class="Bound">X</a> <a id="21415" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="21417" href="Games.OptimalPlays.html#21307" class="Bound">A</a> <a id="21419" href="Games.OptimalPlays.html#21409" class="Bound">x</a><a id="21420" class="Symbol">)</a>
<a id="21422" href="Games.OptimalPlays.html#21245" class="Function">detachable-subtype-of-listed-type-is-listed</a> <a id="21466" class="Symbol">{</a><a id="21467" href="Games.OptimalPlays.html#21467" class="Bound">X</a><a id="21468" class="Symbol">}</a> <a id="21470" href="Games.OptimalPlays.html#21470" class="Bound">A</a> <a id="21472" href="Games.OptimalPlays.html#21472" class="Bound">Î´</a> <a id="21474" href="Games.OptimalPlays.html#21474" class="Bound">A-is-prop-valued</a> <a id="21491" class="Symbol">(</a><a id="21492" href="Games.OptimalPlays.html#21492" class="Bound">xs</a> <a id="21495" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="21497" href="Games.OptimalPlays.html#21497" class="Bound">m</a><a id="21498" class="Symbol">)</a>
 <a id="21501" class="Symbol">=</a> <a id="21503" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="21511" href="Games.OptimalPlays.html#21470" class="Bound">A</a> <a id="21513" href="Games.OptimalPlays.html#21472" class="Bound">Î´</a> <a id="21515" href="Games.OptimalPlays.html#21492" class="Bound">xs</a> <a id="21518" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="21520" href="Games.OptimalPlays.html#21531" class="Function">Î³</a>
 <a id="21523" class="Keyword">where</a>
  <a id="21531" href="Games.OptimalPlays.html#21531" class="Function">Î³</a> <a id="21533" class="Symbol">:</a> <a id="21535" class="Symbol">(</a><a id="21536" href="Games.OptimalPlays.html#21536" class="Bound">Ïƒ</a> <a id="21538" class="Symbol">:</a> <a id="21540" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="21542" href="Games.OptimalPlays.html#21542" class="Bound">x</a> <a id="21544" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="21546" href="Games.OptimalPlays.html#21467" class="Bound">X</a> <a id="21548" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="21550" href="Games.OptimalPlays.html#21470" class="Bound">A</a> <a id="21552" href="Games.OptimalPlays.html#21542" class="Bound">x</a><a id="21553" class="Symbol">)</a> <a id="21555" class="Symbol">â†’</a> <a id="21557" href="MLTT.List.html#3417" class="Datatype">member</a> <a id="21564" href="Games.OptimalPlays.html#21536" class="Bound">Ïƒ</a> <a id="21566" class="Symbol">(</a><a id="21567" href="Games.OptimalPlays.html#19956" class="Function">filter&#39;</a> <a id="21575" href="Games.OptimalPlays.html#21470" class="Bound">A</a> <a id="21577" href="Games.OptimalPlays.html#21472" class="Bound">Î´</a> <a id="21579" href="Games.OptimalPlays.html#21492" class="Bound">xs</a><a id="21581" class="Symbol">)</a>
  <a id="21585" href="Games.OptimalPlays.html#21531" class="Function">Î³</a> <a id="21587" class="Symbol">(</a><a id="21588" href="Games.OptimalPlays.html#21588" class="Bound">x</a> <a id="21590" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="21592" href="Games.OptimalPlays.html#21592" class="Bound">a</a><a id="21593" class="Symbol">)</a> <a id="21595" class="Symbol">=</a> <a id="21597" href="Games.OptimalPlays.html#20183" class="Function">filter&#39;-memberâ†</a> <a id="21613" href="Games.OptimalPlays.html#21470" class="Bound">A</a> <a id="21615" href="Games.OptimalPlays.html#21472" class="Bound">Î´</a> <a id="21617" href="Games.OptimalPlays.html#21474" class="Bound">A-is-prop-valued</a> <a id="21634" href="Games.OptimalPlays.html#21588" class="Bound">x</a> <a id="21636" href="Games.OptimalPlays.html#21492" class="Bound">xs</a> <a id="21639" href="Games.OptimalPlays.html#21592" class="Bound">a</a> <a id="21641" class="Symbol">(</a><a id="21642" href="Games.OptimalPlays.html#21497" class="Bound">m</a> <a id="21644" href="Games.OptimalPlays.html#21588" class="Bound">x</a><a id="21645" class="Symbol">)</a>

<a id="prune-is-listed"></a><a id="21648" href="Games.OptimalPlays.html#21648" class="Function">prune-is-listed</a> <a id="21664" class="Symbol">:</a> <a id="21666" class="Symbol">(</a><a id="21667" href="Games.OptimalPlays.html#21667" class="Bound">Xt</a> <a id="21670" class="Symbol">:</a> <a id="21672" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="21673" class="Symbol">)</a>
                  <a id="21693" class="Symbol">(</a><a id="21694" href="Games.OptimalPlays.html#21694" class="Bound">q</a> <a id="21696" class="Symbol">:</a> <a id="21698" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="21703" href="Games.OptimalPlays.html#21667" class="Bound">Xt</a> <a id="21706" class="Symbol">â†’</a> <a id="21708" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="21709" class="Symbol">)</a>
                  <a id="21729" class="Symbol">(</a><a id="21730" href="Games.OptimalPlays.html#21730" class="Bound">Ï•t</a> <a id="21733" class="Symbol">:</a> <a id="21735" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="21737" href="Games.OptimalPlays.html#21667" class="Bound">Xt</a><a id="21739" class="Symbol">)</a>
                <a id="21757" class="Symbol">â†’</a> <a id="21759" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="21769" href="MLTT.List.html#6385" class="Function">listed</a> <a id="21776" href="Games.OptimalPlays.html#21667" class="Bound">Xt</a>
                <a id="21795" class="Symbol">â†’</a> <a id="21797" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="21807" href="MLTT.List.html#6385" class="Function">listed</a> <a id="21814" class="Symbol">(</a><a id="21815" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="21821" href="Games.OptimalPlays.html#21667" class="Bound">Xt</a> <a id="21824" href="Games.OptimalPlays.html#21694" class="Bound">q</a> <a id="21826" href="Games.OptimalPlays.html#21730" class="Bound">Ï•t</a><a id="21828" class="Symbol">)</a>
<a id="21830" href="Games.OptimalPlays.html#21648" class="Function">prune-is-listed</a> <a id="21846" href="Games.TypeTrees.html#737" class="InductiveConstructor">[]</a> <a id="21849" href="Games.OptimalPlays.html#21849" class="Bound">q</a> <a id="21851" href="Games.OptimalPlays.html#21851" class="Bound">Ï•t</a> <a id="21854" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a> <a id="21857" class="Symbol">=</a> <a id="21859" href="Games.TypeTrees.html#1274" class="InductiveConstructor">âŸ¨âŸ©</a>
<a id="21862" href="Games.OptimalPlays.html#21648" class="Function">prune-is-listed</a> <a id="21878" class="Symbol">(</a><a id="21879" href="Games.OptimalPlays.html#21879" class="Bound">X</a> <a id="21881" href="Games.TypeTrees.html#747" class="InductiveConstructor Operator">âˆ·</a> <a id="21883" href="Games.OptimalPlays.html#21883" class="Bound">Xf</a><a id="21885" class="Symbol">)</a> <a id="21887" href="Games.OptimalPlays.html#21887" class="Bound">q</a> <a id="21889" class="Symbol">(</a><a id="21890" href="Games.OptimalPlays.html#21890" class="Bound">Ï•</a> <a id="21892" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="21895" href="Games.OptimalPlays.html#21895" class="Bound">Ï•f</a><a id="21897" class="Symbol">)</a> <a id="21899" class="Symbol">(</a><a id="21900" href="Games.OptimalPlays.html#21900" class="Bound">X-is-listed</a> <a id="21912" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="21914" href="Games.OptimalPlays.html#21914" class="Bound">Xf-is-listed</a><a id="21926" class="Symbol">)</a> <a id="21928" class="Symbol">=</a>
 <a id="21931" href="Games.OptimalPlays.html#22025" class="Function">X&#39;-is-listed</a> <a id="21944" href="Games.TypeTrees.html#1296" class="InductiveConstructor Operator">::</a> <a id="21947" href="Games.OptimalPlays.html#22366" class="Function">Xf&#39;-is-listed</a>
 <a id="21962" class="Keyword">where</a>
  <a id="21970" href="Games.OptimalPlays.html#21970" class="Function">X&#39;</a> <a id="21973" class="Symbol">:</a> <a id="21975" href="Notation.General.html#372" class="Function">Type</a>
  <a id="21982" href="Games.OptimalPlays.html#21970" class="Function">X&#39;</a> <a id="21985" class="Symbol">=</a> <a id="21987" href="MLTT.Sigma.html#423" class="Function">Î£</a> <a id="21989" href="Games.OptimalPlays.html#21989" class="Bound">x</a> <a id="21991" href="MLTT.Sigma.html#423" class="Function">ê‰</a> <a id="21993" href="Games.OptimalPlays.html#21879" class="Bound">X</a> <a id="21995" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="21997" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="22013" href="Games.OptimalPlays.html#21887" class="Bound">q</a> <a id="22015" href="Games.OptimalPlays.html#21890" class="Bound">Ï•</a> <a id="22017" href="Games.OptimalPlays.html#21895" class="Bound">Ï•f</a> <a id="22020" href="Games.OptimalPlays.html#21989" class="Bound">x</a>

  <a id="22025" href="Games.OptimalPlays.html#22025" class="Function">X&#39;-is-listed</a> <a id="22038" class="Symbol">:</a> <a id="22040" href="MLTT.List.html#6385" class="Function">listed</a> <a id="22047" href="Games.OptimalPlays.html#21970" class="Function">X&#39;</a>
  <a id="22052" href="Games.OptimalPlays.html#22025" class="Function">X&#39;-is-listed</a> <a id="22065" class="Symbol">=</a> <a id="22067" href="Games.OptimalPlays.html#21245" class="Function">detachable-subtype-of-listed-type-is-listed</a>
                  <a id="22129" class="Symbol">(</a><a id="22130" href="Games.OptimalPlays.html#1185" class="Function">is-optimal-move</a> <a id="22146" href="Games.OptimalPlays.html#21887" class="Bound">q</a> <a id="22148" href="Games.OptimalPlays.html#21890" class="Bound">Ï•</a> <a id="22150" href="Games.OptimalPlays.html#21895" class="Bound">Ï•f</a><a id="22152" class="Symbol">)</a>
                  <a id="22172" class="Symbol">(</a><a id="22173" href="Games.OptimalPlays.html#2297" class="Function">being-optimal-move-is-decidable</a> <a id="22205" href="Games.OptimalPlays.html#21887" class="Bound">q</a> <a id="22207" href="Games.OptimalPlays.html#21890" class="Bound">Ï•</a> <a id="22209" href="Games.OptimalPlays.html#21895" class="Bound">Ï•f</a><a id="22211" class="Symbol">)</a>
                  <a id="22231" class="Symbol">(</a><a id="22232" href="Games.OptimalPlays.html#1880" class="Function">being-optimal-move-is-prop</a> <a id="22259" href="Games.OptimalPlays.html#21887" class="Bound">q</a> <a id="22261" href="Games.OptimalPlays.html#21890" class="Bound">Ï•</a> <a id="22263" href="Games.OptimalPlays.html#21895" class="Bound">Ï•f</a><a id="22265" class="Symbol">)</a>
                  <a id="22285" href="Games.OptimalPlays.html#21900" class="Bound">X-is-listed</a>

  <a id="22300" href="Games.OptimalPlays.html#22300" class="Function">Xf&#39;</a> <a id="22304" class="Symbol">:</a> <a id="22306" href="Games.OptimalPlays.html#21970" class="Function">X&#39;</a> <a id="22309" class="Symbol">â†’</a> <a id="22311" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a>
  <a id="22315" href="Games.OptimalPlays.html#22300" class="Function">Xf&#39;</a> <a id="22319" class="Symbol">(</a><a id="22320" href="Games.OptimalPlays.html#22320" class="Bound">x</a> <a id="22322" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="22324" href="Games.OptimalPlays.html#22324" class="Bound">o</a><a id="22325" class="Symbol">)</a> <a id="22327" class="Symbol">=</a> <a id="22329" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="22335" class="Symbol">(</a><a id="22336" href="Games.OptimalPlays.html#21883" class="Bound">Xf</a> <a id="22339" href="Games.OptimalPlays.html#22320" class="Bound">x</a><a id="22340" class="Symbol">)</a> <a id="22342" class="Symbol">(</a><a id="22343" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="22351" href="Games.OptimalPlays.html#21887" class="Bound">q</a> <a id="22353" href="Games.OptimalPlays.html#22320" class="Bound">x</a><a id="22354" class="Symbol">)</a> <a id="22356" class="Symbol">(</a><a id="22357" href="Games.OptimalPlays.html#21895" class="Bound">Ï•f</a> <a id="22360" href="Games.OptimalPlays.html#22320" class="Bound">x</a><a id="22361" class="Symbol">)</a>

  <a id="22366" href="Games.OptimalPlays.html#22366" class="Function">Xf&#39;-is-listed</a> <a id="22380" class="Symbol">:</a> <a id="22382" class="Symbol">(</a><a id="22383" href="Games.OptimalPlays.html#22383" class="Bound">x&#39;</a> <a id="22386" class="Symbol">:</a> <a id="22388" href="Games.OptimalPlays.html#21970" class="Function">X&#39;</a><a id="22390" class="Symbol">)</a> <a id="22392" class="Symbol">â†’</a> <a id="22394" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="22404" href="MLTT.List.html#6385" class="Function">listed</a> <a id="22411" class="Symbol">(</a><a id="22412" href="Games.OptimalPlays.html#22300" class="Function">Xf&#39;</a> <a id="22416" href="Games.OptimalPlays.html#22383" class="Bound">x&#39;</a><a id="22418" class="Symbol">)</a>
  <a id="22422" href="Games.OptimalPlays.html#22366" class="Function">Xf&#39;-is-listed</a> <a id="22436" class="Symbol">(</a><a id="22437" href="Games.OptimalPlays.html#22437" class="Bound">x</a> <a id="22439" href="MLTT.Sigma.html#395" class="InductiveConstructor Operator">,</a> <a id="22441" href="Games.OptimalPlays.html#22441" class="Bound">o</a><a id="22442" class="Symbol">)</a> <a id="22444" class="Symbol">=</a> <a id="22446" href="Games.OptimalPlays.html#21648" class="Function">prune-is-listed</a>
                           <a id="22489" class="Symbol">(</a><a id="22490" href="Games.OptimalPlays.html#21883" class="Bound">Xf</a> <a id="22493" href="Games.OptimalPlays.html#22437" class="Bound">x</a><a id="22494" class="Symbol">)</a>
                           <a id="22523" class="Symbol">(</a><a id="22524" href="Games.TypeTrees.html#1622" class="Function">subpred</a> <a id="22532" href="Games.OptimalPlays.html#21887" class="Bound">q</a> <a id="22534" href="Games.OptimalPlays.html#22437" class="Bound">x</a><a id="22535" class="Symbol">)</a>
                           <a id="22564" class="Symbol">(</a><a id="22565" href="Games.OptimalPlays.html#21895" class="Bound">Ï•f</a> <a id="22568" href="Games.OptimalPlays.html#22437" class="Bound">x</a><a id="22569" class="Symbol">)</a>
                           <a id="22598" class="Symbol">(</a><a id="22599" href="Games.OptimalPlays.html#21914" class="Bound">Xf-is-listed</a> <a id="22612" href="Games.OptimalPlays.html#22437" class="Bound">x</a><a id="22613" class="Symbol">)</a>

<a id="optimal-plays&#39;"></a><a id="22616" href="Games.OptimalPlays.html#22616" class="Function">optimal-plays&#39;</a> <a id="22631" class="Symbol">:</a> <a id="22633" class="Symbol">{</a><a id="22634" href="Games.OptimalPlays.html#22634" class="Bound">Xt</a> <a id="22637" class="Symbol">:</a> <a id="22639" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a><a id="22640" class="Symbol">}</a>
                 <a id="22659" class="Symbol">(</a><a id="22660" href="Games.OptimalPlays.html#22660" class="Bound">q</a> <a id="22662" class="Symbol">:</a> <a id="22664" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="22669" href="Games.OptimalPlays.html#22634" class="Bound">Xt</a> <a id="22672" class="Symbol">â†’</a> <a id="22674" href="Games.OptimalPlays.html#596" class="Bound">R</a><a id="22675" class="Symbol">)</a>
                 <a id="22694" class="Symbol">(</a><a id="22695" href="Games.OptimalPlays.html#22695" class="Bound">Ï•t</a> <a id="22698" class="Symbol">:</a> <a id="22700" href="Games.FiniteHistoryDependent.html#2364" class="Function">ğ“š</a> <a id="22702" href="Games.OptimalPlays.html#22634" class="Bound">Xt</a><a id="22704" class="Symbol">)</a>
                 <a id="22723" class="Symbol">(</a><a id="22724" href="Games.OptimalPlays.html#22724" class="Bound">Xt-is-listed</a> <a id="22737" class="Symbol">:</a> <a id="22739" href="Games.TypeTrees.html#2120" class="Function">structure</a> <a id="22749" href="MLTT.List.html#6385" class="Function">listed</a> <a id="22756" href="Games.OptimalPlays.html#22634" class="Bound">Xt</a><a id="22758" class="Symbol">)</a>
               <a id="22775" class="Symbol">â†’</a> <a id="22777" href="MLTT.List.html#488" class="Datatype">List</a> <a id="22782" class="Symbol">(</a><a id="22783" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="22788" href="Games.OptimalPlays.html#22634" class="Bound">Xt</a><a id="22790" class="Symbol">)</a>
<a id="22792" href="Games.OptimalPlays.html#22616" class="Function">optimal-plays&#39;</a> <a id="22807" class="Symbol">{</a><a id="22808" href="Games.OptimalPlays.html#22808" class="Bound">Xt</a><a id="22810" class="Symbol">}</a> <a id="22812" href="Games.OptimalPlays.html#22812" class="Bound">q</a> <a id="22814" href="Games.OptimalPlays.html#22814" class="Bound">Ï•t</a> <a id="22817" href="Games.OptimalPlays.html#22817" class="Bound">Xt-is-listed</a> <a id="22830" class="Symbol">=</a> <a id="22832" href="Games.OptimalPlays.html#22982" class="Function">xss</a>
 <a id="22837" class="Keyword">where</a>
  <a id="22845" href="Games.OptimalPlays.html#22845" class="Function">Xt&#39;</a> <a id="22849" class="Symbol">:</a> <a id="22851" href="Games.TypeTrees.html#719" class="Datatype">ğ‘»</a>
  <a id="22855" href="Games.OptimalPlays.html#22845" class="Function">Xt&#39;</a> <a id="22859" class="Symbol">=</a> <a id="22861" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="22867" href="Games.OptimalPlays.html#22808" class="Bound">Xt</a> <a id="22870" href="Games.OptimalPlays.html#22812" class="Bound">q</a> <a id="22872" href="Games.OptimalPlays.html#22814" class="Bound">Ï•t</a>

  <a id="22878" href="Games.OptimalPlays.html#22878" class="Function">xss&#39;</a> <a id="22883" class="Symbol">:</a> <a id="22885" href="MLTT.List.html#488" class="Datatype">List</a> <a id="22890" class="Symbol">(</a><a id="22891" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="22896" class="Symbol">(</a><a id="22897" href="Games.OptimalPlays.html#16268" class="Function">prune</a> <a id="22903" href="Games.OptimalPlays.html#22808" class="Bound">Xt</a> <a id="22906" href="Games.OptimalPlays.html#22812" class="Bound">q</a> <a id="22908" href="Games.OptimalPlays.html#22814" class="Bound">Ï•t</a><a id="22910" class="Symbol">))</a>
  <a id="22915" href="Games.OptimalPlays.html#22878" class="Function">xss&#39;</a> <a id="22920" class="Symbol">=</a> <a id="22922" href="Games.OptimalPlays.html#19351" class="Function">list-of-paths</a> <a id="22936" href="Games.OptimalPlays.html#22845" class="Function">Xt&#39;</a> <a id="22940" class="Symbol">(</a><a id="22941" href="Games.OptimalPlays.html#21648" class="Function">prune-is-listed</a> <a id="22957" href="Games.OptimalPlays.html#22808" class="Bound">Xt</a> <a id="22960" href="Games.OptimalPlays.html#22812" class="Bound">q</a> <a id="22962" href="Games.OptimalPlays.html#22814" class="Bound">Ï•t</a> <a id="22965" href="Games.OptimalPlays.html#22817" class="Bound">Xt-is-listed</a><a id="22977" class="Symbol">)</a>

  <a id="22982" href="Games.OptimalPlays.html#22982" class="Function">xss</a> <a id="22986" class="Symbol">:</a> <a id="22988" href="MLTT.List.html#488" class="Datatype">List</a> <a id="22993" class="Symbol">(</a><a id="22994" href="Games.TypeTrees.html#906" class="Function">Path</a> <a id="22999" href="Games.OptimalPlays.html#22808" class="Bound">Xt</a><a id="23001" class="Symbol">)</a>
  <a id="23005" href="Games.OptimalPlays.html#22982" class="Function">xss</a> <a id="23009" class="Symbol">=</a> <a id="23011" href="Games.OptimalPlays.html#784" class="Function">lmap</a> <a id="23016" class="Symbol">(</a><a id="23017" href="Games.OptimalPlays.html#17043" class="Function">inclusion</a> <a id="23027" href="Games.OptimalPlays.html#22812" class="Bound">q</a> <a id="23029" href="Games.OptimalPlays.html#22814" class="Bound">Ï•t</a><a id="23031" class="Symbol">)</a> <a id="23033" href="Games.OptimalPlays.html#22878" class="Function">xss&#39;</a>

<a id="23039" class="Markup">\end{code}</a><a id="23049" class="Background">

Notice that this way of computing the optimal plays doesn&#39;t need the
assumption that the quantifiers are attainable.

TODO. Prove that optimal-plays&#39; lists precisely the optimal plays.
</a></pre></body></html>