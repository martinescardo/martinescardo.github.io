<!DOCTYPE HTML>
<html><head><meta charset="utf-8"><title>MonadOnTypesMGU.K</title><link rel="stylesheet" href="Agda.css"><script type="text/javascript" src="highlight-hover.js"></script></head><body><pre class="Agda"><a id="1" class="Background">Martin Escardo, Paulo Oliva, originally 2023, with universes
generalized in March 2024.

</a><a id="90" class="Markup">\begin{code}</a>

<a id="104" class="Symbol">{-#</a> <a id="108" class="Keyword">OPTIONS</a> <a id="116" class="Pragma">--safe</a> <a id="123" class="Pragma">--without-K</a> <a id="135" class="Pragma">--no-level-universe</a> <a id="155" class="Symbol">#-}</a>

<a id="160" class="Keyword">open</a> <a id="165" class="Keyword">import</a> <a id="172" href="MLTT.Spartan.html" class="Module">MLTT.Spartan</a> <a id="185" class="Keyword">hiding</a> <a id="192" class="Symbol">(</a><a id="193" href="MLTT.Id.html#438" class="Function">J</a><a id="194" class="Symbol">)</a>

<a id="197" class="Keyword">module</a> <a id="204" href="MonadOnTypesMGU.K.html" class="Module">MonadOnTypesMGU.K</a> <a id="222" class="Keyword">where</a>

<a id="229" class="Keyword">open</a> <a id="234" class="Keyword">import</a> <a id="241" href="MonadOnTypesMGU.Monad.html" class="Module">MonadOnTypesMGU.Monad</a>

<a id="264" class="Keyword">private</a>
 <a id="273" class="Keyword">variable</a>
  <a id="284" href="MonadOnTypesMGU.K.html#284" class="Generalizable">𝓦₀</a> <a id="287" class="Symbol">:</a> <a id="289" href="Agda.Primitive.html#742" class="Postulate">Universe</a>

<a id="𝕂"></a><a id="299" href="MonadOnTypesMGU.K.html#299" class="Function">𝕂</a> <a id="301" class="Symbol">:</a> <a id="303" href="MonadOnTypesMGU.K.html#284" class="Generalizable">𝓦₀</a> <a id="306" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="308" class="Symbol">→</a> <a id="310" href="MonadOnTypesMGU.Monad.html#689" class="Record">Monad</a>
<a id="316" href="MonadOnTypesMGU.K.html#299" class="Function">𝕂</a> <a id="318" class="Symbol">{</a><a id="319" href="MonadOnTypesMGU.K.html#319" class="Bound">𝓦₀</a><a id="321" class="Symbol">}</a> <a id="323" href="MonadOnTypesMGU.K.html#323" class="Bound">R</a> <a id="325" class="Symbol">=</a> <a id="327" class="Keyword">record</a> <a id="334" class="Symbol">{</a>
       <a id="343" href="MonadOnTypesMGU.Monad.html#736" class="Field">ℓ</a>       <a id="351" class="Symbol">=</a> <a id="353" class="Symbol">λ</a> <a id="355" href="MonadOnTypesMGU.K.html#355" class="Bound">𝓤</a> <a id="357" class="Symbol">→</a> <a id="359" href="MonadOnTypesMGU.K.html#355" class="Bound">𝓤</a> <a id="361" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="363" href="MonadOnTypesMGU.K.html#319" class="Bound">𝓦₀</a> <a id="366" class="Symbol">;</a>
       <a id="375" href="MonadOnTypesMGU.Monad.html#768" class="Field">functor</a> <a id="383" class="Symbol">=</a> <a id="385" class="Symbol">λ</a> <a id="387" href="MonadOnTypesMGU.K.html#387" class="Bound">X</a> <a id="389" class="Symbol">→</a> <a id="391" class="Symbol">(</a><a id="392" href="MonadOnTypesMGU.K.html#387" class="Bound">X</a> <a id="394" class="Symbol">→</a> <a id="396" href="MonadOnTypesMGU.K.html#323" class="Bound">R</a><a id="397" class="Symbol">)</a> <a id="399" class="Symbol">→</a> <a id="401" href="MonadOnTypesMGU.K.html#323" class="Bound">R</a> <a id="403" class="Symbol">;</a>
       <a id="412" href="MonadOnTypesMGU.Monad.html#809" class="Field">η</a>       <a id="420" class="Symbol">=</a> <a id="422" class="Symbol">λ</a> <a id="424" href="MonadOnTypesMGU.K.html#424" class="Bound">x</a> <a id="426" href="MonadOnTypesMGU.K.html#426" class="Bound">p</a> <a id="428" class="Symbol">→</a> <a id="430" href="MonadOnTypesMGU.K.html#426" class="Bound">p</a> <a id="432" href="MonadOnTypesMGU.K.html#424" class="Bound">x</a> <a id="434" class="Symbol">;</a>
       <a id="443" href="MonadOnTypesMGU.Monad.html#863" class="Field">ext</a>     <a id="451" class="Symbol">=</a> <a id="453" class="Symbol">λ</a> <a id="455" href="MonadOnTypesMGU.K.html#455" class="Bound">f</a> <a id="457" href="MonadOnTypesMGU.K.html#457" class="Bound">ϕ</a> <a id="459" href="MonadOnTypesMGU.K.html#459" class="Bound">p</a> <a id="461" class="Symbol">→</a> <a id="463" href="MonadOnTypesMGU.K.html#457" class="Bound">ϕ</a> <a id="465" class="Symbol">(λ</a> <a id="468" href="MonadOnTypesMGU.K.html#468" class="Bound">x</a> <a id="470" class="Symbol">→</a> <a id="472" href="MonadOnTypesMGU.K.html#455" class="Bound">f</a> <a id="474" href="MonadOnTypesMGU.K.html#468" class="Bound">x</a> <a id="476" href="MonadOnTypesMGU.K.html#459" class="Bound">p</a><a id="477" class="Symbol">)</a> <a id="479" class="Symbol">;</a>
       <a id="488" href="MonadOnTypesMGU.Monad.html#956" class="Field">ext-η</a>   <a id="496" class="Symbol">=</a> <a id="498" class="Symbol">λ</a> <a id="500" href="MonadOnTypesMGU.K.html#500" class="Bound">x</a> <a id="502" class="Symbol">→</a> <a id="504" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="509" class="Symbol">;</a>
       <a id="518" href="MonadOnTypesMGU.Monad.html#1029" class="Field">unit</a>    <a id="526" class="Symbol">=</a> <a id="528" class="Symbol">λ</a> <a id="530" href="MonadOnTypesMGU.K.html#530" class="Bound">f</a> <a id="532" href="MonadOnTypesMGU.K.html#532" class="Bound">x</a> <a id="534" class="Symbol">→</a> <a id="536" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a> <a id="541" class="Symbol">;</a>
       <a id="550" href="MonadOnTypesMGU.Monad.html#1128" class="Field">assoc</a>   <a id="558" class="Symbol">=</a> <a id="560" class="Symbol">λ</a> <a id="562" href="MonadOnTypesMGU.K.html#562" class="Bound">g</a> <a id="564" href="MonadOnTypesMGU.K.html#564" class="Bound">f</a> <a id="566" href="MonadOnTypesMGU.K.html#566" class="Bound">x</a> <a id="568" class="Symbol">→</a> <a id="570" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>
     <a id="580" class="Symbol">}</a>

<a id="583" class="Keyword">module</a> <a id="K-definitions"></a><a id="590" href="MonadOnTypesMGU.K.html#590" class="Module">K-definitions</a> <a id="604" class="Symbol">(</a><a id="605" href="MonadOnTypesMGU.K.html#605" class="Bound">R</a> <a id="607" class="Symbol">:</a> <a id="609" href="MonadOnTypesMGU.K.html#284" class="Generalizable">𝓦₀</a> <a id="612" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="614" class="Symbol">)</a> <a id="616" class="Keyword">where</a>

 <a id="K-definitions.K"></a><a id="624" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="626" class="Symbol">:</a> <a id="628" href="MLTT.Universes.html#3834" class="Generalizable">𝓤</a> <a id="630" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="632" class="Symbol">→</a> <a id="634" href="MonadOnTypesMGU.K.html#609" class="Bound">𝓦₀</a> <a id="637" href="Agda.Primitive.html#961" class="Primitive Operator">⊔</a> <a id="639" href="MLTT.Universes.html#3834" class="Generalizable">𝓤</a> <a id="641" href="MLTT.Universes.html#3977" class="Function Operator">̇</a>
 <a id="644" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="646" class="Symbol">=</a> <a id="648" href="MonadOnTypesMGU.Monad.html#768" class="Field">functor</a> <a id="656" class="Symbol">(</a><a id="657" href="MonadOnTypesMGU.K.html#299" class="Function">𝕂</a> <a id="659" href="MonadOnTypesMGU.K.html#605" class="Bound">R</a><a id="660" class="Symbol">)</a>

 <a id="K-definitions._⊗ᴷ_"></a><a id="664" href="MonadOnTypesMGU.K.html#664" class="Function Operator">_⊗ᴷ_</a> <a id="669" class="Symbol">:</a> <a id="671" class="Symbol">{</a><a id="672" href="MonadOnTypesMGU.K.html#672" class="Bound">X</a> <a id="674" class="Symbol">:</a> <a id="676" href="MLTT.Universes.html#3834" class="Generalizable">𝓤</a> <a id="678" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="680" class="Symbol">}</a> <a id="682" class="Symbol">{</a><a id="683" href="MonadOnTypesMGU.K.html#683" class="Bound">Y</a> <a id="685" class="Symbol">:</a> <a id="687" href="MonadOnTypesMGU.K.html#672" class="Bound">X</a> <a id="689" class="Symbol">→</a> <a id="691" href="MLTT.Universes.html#3836" class="Generalizable">𝓥</a> <a id="693" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="695" class="Symbol">}</a>
      <a id="703" class="Symbol">→</a> <a id="705" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="707" href="MonadOnTypesMGU.K.html#672" class="Bound">X</a>
      <a id="715" class="Symbol">→</a> <a id="717" class="Symbol">((</a><a id="719" href="MonadOnTypesMGU.K.html#719" class="Bound">x</a> <a id="721" class="Symbol">:</a> <a id="723" href="MonadOnTypesMGU.K.html#672" class="Bound">X</a><a id="724" class="Symbol">)</a> <a id="726" class="Symbol">→</a> <a id="728" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="730" class="Symbol">(</a><a id="731" href="MonadOnTypesMGU.K.html#683" class="Bound">Y</a> <a id="733" href="MonadOnTypesMGU.K.html#719" class="Bound">x</a><a id="734" class="Symbol">))</a>
      <a id="743" class="Symbol">→</a> <a id="745" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="747" class="Symbol">(</a><a id="748" href="MLTT.Sigma.html#423" class="Function">Σ</a> <a id="750" href="MonadOnTypesMGU.K.html#750" class="Bound">x</a> <a id="752" href="MLTT.Sigma.html#423" class="Function">꞉</a> <a id="754" href="MonadOnTypesMGU.K.html#672" class="Bound">X</a> <a id="756" href="MLTT.Sigma.html#423" class="Function">,</a> <a id="758" href="MonadOnTypesMGU.K.html#683" class="Bound">Y</a> <a id="760" href="MonadOnTypesMGU.K.html#750" class="Bound">x</a><a id="761" class="Symbol">)</a>
 <a id="764" href="MonadOnTypesMGU.K.html#664" class="Function Operator">_⊗ᴷ_</a> <a id="769" class="Symbol">=</a> <a id="771" href="MonadOnTypesMGU.Monad.html#1476" class="Function Operator">_⊗_</a> <a id="775" class="Symbol">(</a><a id="776" href="MonadOnTypesMGU.K.html#299" class="Function">𝕂</a> <a id="778" href="MonadOnTypesMGU.K.html#605" class="Bound">R</a><a id="779" class="Symbol">)</a>

 <a id="K-definitions.⊗ᴷ-direct-definition"></a><a id="783" href="MonadOnTypesMGU.K.html#783" class="Function">⊗ᴷ-direct-definition</a> <a id="804" class="Symbol">:</a> <a id="806" class="Symbol">{</a><a id="807" href="MonadOnTypesMGU.K.html#807" class="Bound">X</a> <a id="809" class="Symbol">:</a> <a id="811" href="MLTT.Universes.html#3834" class="Generalizable">𝓤</a> <a id="813" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="815" class="Symbol">}</a> <a id="817" class="Symbol">{</a><a id="818" href="MonadOnTypesMGU.K.html#818" class="Bound">Y</a> <a id="820" class="Symbol">:</a> <a id="822" href="MonadOnTypesMGU.K.html#807" class="Bound">X</a> <a id="824" class="Symbol">→</a> <a id="826" href="MLTT.Universes.html#3836" class="Generalizable">𝓥</a> <a id="828" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="830" class="Symbol">}</a>
                        <a id="856" class="Symbol">(</a><a id="857" href="MonadOnTypesMGU.K.html#857" class="Bound">ϕ</a> <a id="859" class="Symbol">:</a> <a id="861" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="863" href="MonadOnTypesMGU.K.html#807" class="Bound">X</a><a id="864" class="Symbol">)</a>
                        <a id="890" class="Symbol">(</a><a id="891" href="MonadOnTypesMGU.K.html#891" class="Bound">γ</a> <a id="893" class="Symbol">:</a> <a id="895" class="Symbol">(</a><a id="896" href="MonadOnTypesMGU.K.html#896" class="Bound">x</a> <a id="898" class="Symbol">:</a> <a id="900" href="MonadOnTypesMGU.K.html#807" class="Bound">X</a><a id="901" class="Symbol">)</a> <a id="903" class="Symbol">→</a> <a id="905" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="907" class="Symbol">(</a><a id="908" href="MonadOnTypesMGU.K.html#818" class="Bound">Y</a> <a id="910" href="MonadOnTypesMGU.K.html#896" class="Bound">x</a><a id="911" class="Symbol">))</a>
                      <a id="936" class="Symbol">→</a> <a id="938" href="MonadOnTypesMGU.K.html#857" class="Bound">ϕ</a> <a id="940" href="MonadOnTypesMGU.K.html#664" class="Function Operator">⊗ᴷ</a> <a id="943" href="MonadOnTypesMGU.K.html#891" class="Bound">γ</a> <a id="945" href="MLTT.Id.html#1889" class="Function Operator">∼</a> <a id="947" class="Symbol">(λ</a> <a id="950" href="MonadOnTypesMGU.K.html#950" class="Bound">q</a> <a id="952" class="Symbol">→</a> <a id="954" href="MonadOnTypesMGU.K.html#857" class="Bound">ϕ</a> <a id="956" class="Symbol">(λ</a> <a id="959" href="MonadOnTypesMGU.K.html#959" class="Bound">x</a> <a id="961" class="Symbol">→</a> <a id="963" href="MonadOnTypesMGU.K.html#891" class="Bound">γ</a> <a id="965" href="MonadOnTypesMGU.K.html#959" class="Bound">x</a> <a id="967" class="Symbol">(</a><a id="968" href="MLTT.Sigma.html#719" class="Function">curry</a> <a id="974" href="MonadOnTypesMGU.K.html#950" class="Bound">q</a> <a id="976" href="MonadOnTypesMGU.K.html#959" class="Bound">x</a><a id="977" class="Symbol">)))</a>
 <a id="982" href="MonadOnTypesMGU.K.html#783" class="Function">⊗ᴷ-direct-definition</a> <a id="1003" href="MonadOnTypesMGU.K.html#1003" class="Bound">ϕ</a> <a id="1005" href="MonadOnTypesMGU.K.html#1005" class="Bound">γ</a> <a id="1007" href="MonadOnTypesMGU.K.html#1007" class="Bound">q</a> <a id="1009" class="Symbol">=</a> <a id="1011" href="MLTT.Identity-Type.html#157" class="InductiveConstructor">refl</a>

 <a id="K-definitions.ηᴷ"></a><a id="1018" href="MonadOnTypesMGU.K.html#1018" class="Function">ηᴷ</a> <a id="1021" class="Symbol">:</a> <a id="1023" class="Symbol">{</a><a id="1024" href="MonadOnTypesMGU.K.html#1024" class="Bound">X</a> <a id="1026" class="Symbol">:</a> <a id="1028" href="MLTT.Universes.html#3834" class="Generalizable">𝓤</a> <a id="1030" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="1032" class="Symbol">}</a> <a id="1034" class="Symbol">→</a> <a id="1036" href="MonadOnTypesMGU.K.html#1024" class="Bound">X</a> <a id="1038" class="Symbol">→</a> <a id="1040" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="1042" href="MonadOnTypesMGU.K.html#1024" class="Bound">X</a>
 <a id="1045" href="MonadOnTypesMGU.K.html#1018" class="Function">ηᴷ</a> <a id="1048" class="Symbol">=</a> <a id="1050" href="MonadOnTypesMGU.Monad.html#809" class="Field">η</a> <a id="1052" class="Symbol">(</a><a id="1053" href="MonadOnTypesMGU.K.html#299" class="Function">𝕂</a> <a id="1055" href="MonadOnTypesMGU.K.html#605" class="Bound">R</a><a id="1056" class="Symbol">)</a>

 <a id="K-definitions.extᴷ"></a><a id="1060" href="MonadOnTypesMGU.K.html#1060" class="Function">extᴷ</a> <a id="1065" class="Symbol">:</a> <a id="1067" class="Symbol">{</a><a id="1068" href="MonadOnTypesMGU.K.html#1068" class="Bound">X</a> <a id="1070" class="Symbol">:</a> <a id="1072" href="MLTT.Universes.html#3834" class="Generalizable">𝓤</a> <a id="1074" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="1076" class="Symbol">}</a> <a id="1078" class="Symbol">{</a><a id="1079" href="MonadOnTypesMGU.K.html#1079" class="Bound">Y</a> <a id="1081" class="Symbol">:</a> <a id="1083" href="MLTT.Universes.html#3836" class="Generalizable">𝓥</a> <a id="1085" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="1087" class="Symbol">}</a> <a id="1089" class="Symbol">→</a> <a id="1091" class="Symbol">(</a><a id="1092" href="MonadOnTypesMGU.K.html#1068" class="Bound">X</a> <a id="1094" class="Symbol">→</a> <a id="1096" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="1098" href="MonadOnTypesMGU.K.html#1079" class="Bound">Y</a><a id="1099" class="Symbol">)</a> <a id="1101" class="Symbol">→</a> <a id="1103" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="1105" href="MonadOnTypesMGU.K.html#1068" class="Bound">X</a> <a id="1107" class="Symbol">→</a> <a id="1109" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="1111" href="MonadOnTypesMGU.K.html#1079" class="Bound">Y</a>
 <a id="1114" href="MonadOnTypesMGU.K.html#1060" class="Function">extᴷ</a> <a id="1119" class="Symbol">=</a> <a id="1121" href="MonadOnTypesMGU.Monad.html#863" class="Field">ext</a> <a id="1125" class="Symbol">(</a><a id="1126" href="MonadOnTypesMGU.K.html#299" class="Function">𝕂</a> <a id="1128" href="MonadOnTypesMGU.K.html#605" class="Bound">R</a><a id="1129" class="Symbol">)</a>

 <a id="K-definitions.mapᴷ"></a><a id="1133" href="MonadOnTypesMGU.K.html#1133" class="Function">mapᴷ</a> <a id="1138" class="Symbol">:</a> <a id="1140" class="Symbol">{</a><a id="1141" href="MonadOnTypesMGU.K.html#1141" class="Bound">X</a> <a id="1143" class="Symbol">:</a> <a id="1145" href="MLTT.Universes.html#3834" class="Generalizable">𝓤</a> <a id="1147" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="1149" class="Symbol">}</a> <a id="1151" class="Symbol">{</a><a id="1152" href="MonadOnTypesMGU.K.html#1152" class="Bound">Y</a> <a id="1154" class="Symbol">:</a> <a id="1156" href="MLTT.Universes.html#3836" class="Generalizable">𝓥</a> <a id="1158" href="MLTT.Universes.html#3977" class="Function Operator">̇</a> <a id="1160" class="Symbol">}</a> <a id="1162" class="Symbol">→</a> <a id="1164" class="Symbol">(</a><a id="1165" href="MonadOnTypesMGU.K.html#1141" class="Bound">X</a> <a id="1167" class="Symbol">→</a> <a id="1169" href="MonadOnTypesMGU.K.html#1152" class="Bound">Y</a><a id="1170" class="Symbol">)</a> <a id="1172" class="Symbol">→</a> <a id="1174" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="1176" href="MonadOnTypesMGU.K.html#1141" class="Bound">X</a> <a id="1178" class="Symbol">→</a> <a id="1180" href="MonadOnTypesMGU.K.html#624" class="Function">K</a> <a id="1182" href="MonadOnTypesMGU.K.html#1152" class="Bound">Y</a>
 <a id="1185" href="MonadOnTypesMGU.K.html#1133" class="Function">mapᴷ</a> <a id="1190" class="Symbol">=</a> <a id="1192" href="MonadOnTypesMGU.Monad.html#1328" class="Function">map</a> <a id="1196" class="Symbol">(</a><a id="1197" href="MonadOnTypesMGU.K.html#299" class="Function">𝕂</a> <a id="1199" href="MonadOnTypesMGU.K.html#605" class="Bound">R</a><a id="1200" class="Symbol">)</a>

<a id="1203" class="Markup">\end{code}</a><a id="1213" class="Background">
</a></pre></body></html>